<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.34: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Darwin dhcp-8e78.meeting.ietf.org 13.4.0 Darwin Kernel Version 13.4.0: Sun Aug 17 19:50:11 PDT 2014; root:xnu-2422.115.4~1/RELEASE_X86_64 x86_64 --> 
<!-- Using awk: /opt/local/bin/gawk: GNU Awk 4.1.1, API: 1.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 2.8.1 --> 
<!-- Using wdiff: /opt/local/bin/wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: draft-ietf-tls-tls13-issue63_session_hash.txt - draft-ietf-tls-tls13-issue91_add_update_mechanism.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;draft-ietf-tls-tls13-issue63_session_hash.txt&nbsp;</th><th> </th><th>&nbsp;draft-ietf-tls-tls13-issue91_add_update_mechanism.txt&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> page 3, line 16</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> page 3, line 16</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.4.  Encrypted Extensions  . . . . . . . . . . . . . . . .  52</td><td> </td><td class="right">       7.3.4.  Encrypted Extensions  . . . . . . . . . . . . . . . .  52</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.5.  Server Certificate  . . . . . . . . . . . . . . . . .  53</td><td> </td><td class="right">       7.3.5.  Server Certificate  . . . . . . . . . . . . . . . . .  53</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.6.  Certificate Request . . . . . . . . . . . . . . . . .  55</td><td> </td><td class="right">       7.3.6.  Certificate Request . . . . . . . . . . . . . . . . .  55</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.7.  Server Certificate Verify . . . . . . . . . . . . . .  57</td><td> </td><td class="right">       7.3.7.  Server Certificate Verify . . . . . . . . . . . . . .  57</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.8.  Server Finished . . . . . . . . . . . . . . . . . . .  58</td><td> </td><td class="right">       7.3.8.  Server Finished . . . . . . . . . . . . . . . . . . .  58</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.9.  Client Certificate  . . . . . . . . . . . . . . . . .  60</td><td> </td><td class="right">       7.3.9.  Client Certificate  . . . . . . . . . . . . . . . . .  60</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.10. Client Certificate Verify . . . . . . . . . . . . . .  61</td><td> </td><td class="right">       7.3.10. Client Certificate Verify . . . . . . . . . . . . . .  61</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   8.  Cryptographic Computations  . . . . . . . . . . . . . . . . .  62</td><td> </td><td class="right">   8.  Cryptographic Computations  . . . . . . . . . . . . . . . . .  62</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     8.1.  Computing the Master Secret . . . . . . . . . . . . . . .  62</td><td> </td><td class="right">     8.1.  Computing the Master Secret . . . . . . . . . . . . . . .  62</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       8.1.1.  The Session Hash  . . . . . . . . . . . . . . . . . .  64</td><td> </td><td class="right">       8.1.1.  The Session Hash  . . . . . . . . . . . . . . . . . .  64</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       8.1.2.  Diffie-Hellman  . . . . . . . . . . . . . . . . . . .  6<span class="delete">4</span></td><td> </td><td class="rblock">       8.1.2.  Diffie-Hellman  . . . . . . . . . . . . . . . . . . .  6<span class="insert">5</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       8.1.3.  Elliptic Curve Diffie-Hellman . . . . . . . . . . . .  65</td><td> </td><td class="right">       8.1.3.  Elliptic Curve Diffie-Hellman . . . . . . . . . . . .  65</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   9.  Mandatory Cipher Suites . . . . . . . . . . . . . . . . . . .  <span class="delete">65</span></td><td> </td><td class="rblock">     <span class="insert">8.2.  Update Protocol . . . . . . . . . . . . . . . . . . . . .  65</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   10. Application Data Protocol . . . . . . . . . . . . . . . . . .  <span class="delete">65</span></td><td> </td><td class="rblock"><span class="insert">       8.2.1.  General Update Protocol Behavior  . . . . . . . . . .  66</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   11. Security Considerations . . . . . . . . . . . . . . . . . . .  <span class="delete">65</span></td><td> </td><td class="rblock"><span class="insert">       8.2.2.  ACK . . . . . . . . . . . . . . . . . . . . . . . . .  66</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   12. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <span class="delete">65</span></td><td> </td><td class="rblock"><span class="insert">       8.2.3.  Rekey . . . . . . . . . . . . . . . . . . . . . . . .  67</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   13. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">67</span></td><td> </td><td class="rblock">   9.  Mandatory Cipher Suites . . . . . . . . . . . . . . . . . . .  <span class="insert">68</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     13.1.  Normative References . . . . . . . . . . . . . . . . . .  <span class="delete">67</span></td><td> </td><td class="rblock">   10. Application Data Protocol . . . . . . . . . . . . . . . . . .  <span class="insert">68</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     13.2.  Informative References . . . . . . . . . . . . . . . . .  <span class="delete">68</span></td><td> </td><td class="rblock">   11. Security Considerations . . . . . . . . . . . . . . . . . . .  <span class="insert">68</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     13.3.  URIs . . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">71</span></td><td> </td><td class="rblock">   12. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <span class="insert">68</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix A.  Protocol Data Structures and Constant Values . . . .  <span class="delete">72</span></td><td> </td><td class="rblock">   13. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">69</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.1.  Record Layer  . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">72</span></td><td> </td><td class="rblock">     13.1.  Normative References . . . . . . . . . . . . . . . . . .  <span class="insert">70</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.2.  Change Cipher Specs Message . . . . . . . . . . . . . . .  <span class="delete">72</span></td><td> </td><td class="rblock">     13.2.  Informative References . . . . . . . . . . . . . . . . .  <span class="insert">71</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.3.  Alert Messages  . . . . . . . . . . . . . . . . . . . . .  <span class="delete">72</span></td><td> </td><td class="rblock">     13.3.  URIs . . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">74</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.4.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="delete">73</span></td><td> </td><td class="rblock">   Appendix A.  Protocol Data Structures and Constant Values . . . .  <span class="insert">75</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  <span class="delete">74</span></td><td> </td><td class="rblock">     A.1.  Record Layer  . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">75</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.2.  Server Authentication and Key Exchange Messages . . .  <span class="delete">76</span></td><td> </td><td class="rblock">     A.2.  Change Cipher Specs Message . . . . . . . . . . . . . . .  <span class="insert">75</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.3.  Client Authentication and Key Exchange Messages . . .  <span class="delete">76</span></td><td> </td><td class="rblock">     A.3.  Alert Messages  . . . . . . . . . . . . . . . . . . . . .  <span class="insert">75</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.4.  Handshake Finalization Message  . . . . . . . . . . .  <span class="delete">77</span></td><td> </td><td class="rblock">     A.4.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="insert">76</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.5.  The Cipher Suite  . . . . . . . . . . . . . . . . . . . .  <span class="delete">77</span></td><td> </td><td class="rblock">       A.4.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  <span class="insert">77</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.6.  The Security Parameters . . . . . . . . . . . . . . . . .  <span class="delete">79</span></td><td> </td><td class="rblock">       A.4.2.  Server Authentication and Key Exchange Messages . . .  <span class="insert">79</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.7.  Changes to RFC 4492 . . . . . . . . . . . . . . . . . . .  <span class="delete">79</span></td><td> </td><td class="rblock">       A.4.3.  Client Authentication and Key Exchange Messages . . .  <span class="insert">79</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix B.  Glossary . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">80</span></td><td> </td><td class="rblock">       A.4.4.  Handshake Finalization Message  . . . . . . . . . . .  <span class="insert">80</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix C.  Cipher Suite Definitions . . . . . . . . . . . . . .  <span class="delete">83</span></td><td> </td><td class="rblock">     A.5.  The Cipher Suite  . . . . . . . . . . . . . . . . . . . .  <span class="insert">80</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix D.  Implementation Notes . . . . . . . . . . . . . . . .  <span class="delete">83</span></td><td> </td><td class="rblock">     A.6.  The Security Parameters . . . . . . . . . . . . . . . . .  <span class="insert">82</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.1.  Random Number Generation and Seeding  . . . . . . . . . .  <span class="delete">83</span></td><td> </td><td class="rblock">     A.7.  Changes to RFC 4492 . . . . . . . . . . . . . . . . . . .  <span class="insert">82</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.2.  Certificates and Authentication . . . . . . . . . . . . .  <span class="delete">84</span></td><td> </td><td class="rblock">   Appendix B.  Glossary . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">83</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.3.  Cipher Suites . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">84</span></td><td> </td><td class="rblock">   Appendix C.  Cipher Suite Definitions . . . . . . . . . . . . . .  <span class="insert">86</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.4.  Implementation Pitfalls . . . . . . . . . . . . . . . . .  <span class="delete">84</span></td><td> </td><td class="rblock">   Appendix D.  Implementation Notes . . . . . . . . . . . . . . . .  <span class="insert">86</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix E.  Backward Compatibility . . . . . . . . . . . . . . .  <span class="delete">85</span></td><td> </td><td class="rblock">     D.1.  Random Number Generation and Seeding  . . . . . . . . . .  <span class="insert">86</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.1.  Compatibility with TLS 1.0/1.1 and SSL 3.0  . . . . . . .  <span class="delete">85</span></td><td> </td><td class="rblock">     D.2.  Certificates and Authentication . . . . . . . . . . . . .  <span class="insert">87</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.2.  Compatibility with SSL 2.0  . . . . . . . . . . . . . . .  <span class="delete">87</span></td><td> </td><td class="rblock">     D.3.  Cipher Suites . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">87</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.3.  Avoiding Man-in-the-Middle Version Rollback . . . . . . .  <span class="delete">89</span></td><td> </td><td class="rblock">     D.4.  Implementation Pitfalls . . . . . . . . . . . . . . . . .  <span class="insert">87</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix F.  Security Analysis  . . . . . . . . . . . . . . . . .  <span class="delete">89</span></td><td> </td><td class="rblock">   Appendix E.  Backward Compatibility . . . . . . . . . . . . . . .  <span class="insert">88</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.1.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="delete">89</span></td><td> </td><td class="rblock">     E.1.  Compatibility with TLS 1.0/1.1 and SSL 3.0  . . . . . . .  <span class="insert">88</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.1.  Authentication and Key Exchange . . . . . . . . . . .  <span class="delete">89</span></td><td> </td><td class="rblock">     E.2.  Compatibility with SSL 2.0  . . . . . . . . . . . . . . .  <span class="insert">90</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.2.  Version Rollback Attacks  . . . . . . . . . . . . . .  <span class="delete">91</span></td><td> </td><td class="rblock">     E.3.  Avoiding Man-in-the-Middle Version Rollback . . . . . . .  <span class="insert">92</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.3.  Detecting Attacks Against the Handshake Protocol  . .  <span class="delete">91</span></td><td> </td><td class="rblock">   Appendix F.  Security Analysis  . . . . . . . . . . . . . . . . .  <span class="insert">92</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.4.  Resuming Sessions . . . . . . . . . . . . . . . . . .  <span class="delete">91</span></td><td> </td><td class="rblock">     F.1.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="insert">92</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.2.  Protecting Application Data . . . . . . . . . . . . . . .  <span class="delete">92</span></td><td> </td><td class="rblock">       F.1.1.  Authentication and Key Exchange . . . . . . . . . . .  <span class="insert">92</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.3.  Denial of Service . . . . . . . . . . . . . . . . . . . .  <span class="delete">92</span></td><td> </td><td class="rblock">       F.1.2.  Version Rollback Attacks  . . . . . . . . . . . . . .  <span class="insert">94</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.4.  Final Notes . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">92</span></td><td> </td><td class="rblock">       F.1.3.  Detecting Attacks Against the Handshake Protocol  . .  <span class="insert">94</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix G.  Working Group Information  . . . . . . . . . . . . .  <span class="delete">93</span></td><td> </td><td class="rblock">       F.1.4.  Resuming Sessions . . . . . . . . . . . . . . . . . .  <span class="insert">94</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix H.  Contributors . . . . . . . . . . . . . . . . . . . .  <span class="delete">93</span></td><td> </td><td class="rblock">     F.2.  Protecting Application Data . . . . . . . . . . . . . . .  <span class="insert">95</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">     F.3.  Denial of Service . . . . . . . . . . . . . . . . . . . .  <span class="insert">95</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">     F.4.  Final Notes . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">95</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   Appendix G.  Working Group Information  . . . . . . . . . . . . .  <span class="insert">96</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   Appendix H.  Contributors . . . . . . . . . . . . . . . . . . . .  <span class="insert">96</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   DISCLAIMER: This is a WIP draft of TLS 1.3 and has not yet seen</td><td> </td><td class="right">   DISCLAIMER: This is a WIP draft of TLS 1.3 and has not yet seen</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   significant security analysis.</td><td> </td><td class="right">   significant security analysis.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</td><td> </td><td class="right">   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   draft is maintained in GitHub.  Suggested changes should be submitted</td><td> </td><td class="right">   draft is maintained in GitHub.  Suggested changes should be submitted</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   as pull requests at https://github.com/tlswg/tls13-spec.</td><td> </td><td class="right">   as pull requests at https://github.com/tlswg/tls13-spec.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Instructions are on that page as well.  Editorial changes can be</td><td> </td><td class="right">   Instructions are on that page as well.  Editorial changes can be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> page 5, line 42</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> page 5, line 47</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td> </td><td class="right">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this</td><td> </td><td class="right">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   document are to be interpreted as described in RFC 2119 [RFC2119].</td><td> </td><td class="right">   document are to be interpreted as described in RFC 2119 [RFC2119].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.2.  Major Differences from TLS 1.2</td><td> </td><td class="right">1.2.  Major Differences from TLS 1.2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   draft-04</td><td> </td><td class="right">   draft-04</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Modify key computations to include session hash.</td><td> </td><td class="right">   -  Modify key computations to include session hash.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">-  Add support for Update protocol</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   draft-03</td><td> </td><td class="right">   draft-03</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Remove GMT time.</td><td> </td><td class="right">   -  Remove GMT time.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Merge in support for ECC from RFC 4492 but without explicit</td><td> </td><td class="right">   -  Merge in support for ECC from RFC 4492 but without explicit</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      curves.</td><td> </td><td class="right">      curves.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Remove the unnecessary length field from the AD input to AEAD</td><td> </td><td class="right">   -  Remove the unnecessary length field from the AD input to AEAD</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ciphers.</td><td> </td><td class="right">      ciphers.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> page 20, line 12</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> page 20, line 12</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   into a single TLSPlaintext record, or a single message MAY be</td><td> </td><td class="right">   into a single TLSPlaintext record, or a single message MAY be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   fragmented across several records).</td><td> </td><td class="right">   fragmented across several records).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint8 major;</td><td> </td><td class="right">          uint8 major;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint8 minor;</td><td> </td><td class="right">          uint8 minor;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } ProtocolVersion;</td><td> </td><td class="right">      } ProtocolVersion;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          reserved(20), alert(21), handshake(22),</td><td> </td><td class="right">          reserved(20), alert(21), handshake(22),</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          application_data(23), (255)</td><td> </td><td class="rblock">          application_data(23), <span class="insert">update(24), </span>(255)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } ContentType;</td><td> </td><td class="right">      } ContentType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ContentType type;</td><td> </td><td class="right">          ContentType type;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ProtocolVersion version;</td><td> </td><td class="right">          ProtocolVersion version;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint16 length;</td><td> </td><td class="right">          uint16 length;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque fragment[TLSPlaintext.length];</td><td> </td><td class="right">          opaque fragment[TLSPlaintext.length];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } TLSPlaintext;</td><td> </td><td class="right">      } TLSPlaintext;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   type</td><td> </td><td class="right">   type</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> page 23, line 23</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> page 23, line 23</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provided by the handshake protocol.</td><td> </td><td class="right">   provided by the handshake protocol.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The master secret is expanded into a sequence of secure bytes, which</td><td> </td><td class="right">   The master secret is expanded into a sequence of secure bytes, which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is then split to a client write encryption key and a server write</td><td> </td><td class="right">   is then split to a client write encryption key and a server write</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   encryption key.  Each of these is generated from the byte sequence in</td><td> </td><td class="right">   encryption key.  Each of these is generated from the byte sequence in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that order.  Unused values are empty.  Some ciphers may additionally</td><td> </td><td class="right">   that order.  Unused values are empty.  Some ciphers may additionally</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   require a client write IV and a server write IV.</td><td> </td><td class="right">   require a client write IV and a server write IV.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When keys are generated, the then current master secret (MS) is used</td><td> </td><td class="right">   When keys are generated, the then current master secret (MS) is used</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   as an entropy source.  For handshake records, this means the</td><td> </td><td class="right">   as an entropy source.  For handshake records, this means the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   hs_master_secret.  For application data, records, this means the</td><td> </td><td class="rblock">   hs_master_secret.  For application data, records, this means <span class="insert">either</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">regular master_secret.</span></td><td> </td><td class="rblock">   the <span class="insert">client_master_secret (for traffic sent by the client) or the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server_master_secret (for traffic sent by the server).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   To generate the key material, compute</td><td> </td><td class="right">   To generate the key material, compute</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      key_block = PRF(MS,</td><td> </td><td class="right">      key_block = PRF(MS,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                      "key expansion",</td><td> </td><td class="right">                      "key expansion",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                      SecurityParameters.server_random +</td><td> </td><td class="right">                      SecurityParameters.server_random +</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                      SecurityParameters.client_random);</td><td> </td><td class="right">                      SecurityParameters.client_random);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   where MS is the relevant master secret.  The PRF is computed enough</td><td> </td><td class="right">   where MS is the relevant master secret.  The PRF is computed enough</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   times to generate the necessary amount of data for the key_block,</td><td> </td><td class="right">   times to generate the necessary amount of data for the key_block,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> page 63, line 19</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> page 63, line 19</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       v                   |</td><td> </td><td class="right">                                       v                   |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     Handshake   &lt;-PRF-           Handshake                |</td><td> </td><td class="right">     Handshake   &lt;-PRF-           Handshake                |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    Traffic Keys                 Master Secret             |</td><td> </td><td class="right">    Traffic Keys                 Master Secret             |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       |                   | Via</td><td> </td><td class="right">                                       |                   | Via</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                       |                   | Session</td><td> </td><td class="right">                                       |                   | Session</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                            +----------+----------+        | Cache</td><td> </td><td class="right">                            +----------+----------+        | Cache</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                            |                     |        |</td><td> </td><td class="right">                            |                     |        |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                           PRF                   PRF       |</td><td> </td><td class="right">                           PRF                   PRF       |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                            |                     |        |</td><td> </td><td class="right">                            |                     |        |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                            v                     v        |</td><td> </td><td class="right">                            v                     v        |</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">    Application  &lt;-PRF-  <span class="delete">Master</span>               Resumption   |</td><td> </td><td class="rblock">    Application  &lt;-PRF-  <span class="insert">Client/</span>              Resumption   |</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Traffic Keys          <span class="delete">Secret</span>               Premaster  --+</td><td> </td><td class="rblock">   Traffic Keys          <span class="insert">Server</span>               Premaster  --+</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                         <span class="insert">Master                 Secret</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                Secret</td><td> </td><td class="right">                                                Secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   First, as soon as the ClientKeyShare and ServerKeyShare messages have</td><td> </td><td class="right">   First, as soon as the ClientKeyShare and ServerKeyShare messages have</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   been exchanged, the client and server each use the unauthenticated</td><td> </td><td class="right">   been exchanged, the client and server each use the unauthenticated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   key shares to generate a master secret which is used for the</td><td> </td><td class="right">   key shares to generate a master secret which is used for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   protection of the remaining handshake records.  Specifically, they</td><td> </td><td class="right">   protection of the remaining handshake records.  Specifically, they</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   generate:</td><td> </td><td class="right">   generate:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    hs_master_secret = PRF(pre_master_secret, "handshake master secret",</td><td> </td><td class="right">    hs_master_secret = PRF(pre_master_secret, "handshake master secret",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                           session_hash)</td><td> </td><td class="right">                           session_hash)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> page 63, line 44</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> page 63, line 45</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "resumption premaster secret", rather than using the values from the</td><td> </td><td class="right">   "resumption premaster secret", rather than using the values from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientKeyShare/ServerKeyShare exchange.</td><td> </td><td class="right">   ClientKeyShare/ServerKeyShare exchange.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This master secret value is used to generate the record protection</td><td> </td><td class="right">   This master secret value is used to generate the record protection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   keys used for the handshake, as described in Section 6.3.</td><td> </td><td class="right">   keys used for the handshake, as described in Section 6.3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Once the hs_master_secret has been computed, the premaster secret</td><td> </td><td class="right">   Once the hs_master_secret has been computed, the premaster secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   should be deleted from memory.</td><td> </td><td class="right">   should be deleted from memory.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Once the last non-Finished message has been sent, the client and</td><td> </td><td class="right">   Once the last non-Finished message has been sent, the client and</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   server then compute <span class="delete">the</span> master <span class="delete">secret which will be used for the</span></td><td> </td><td class="rblock">   server then compute <span class="insert">their respective</span> master <span class="insert">secrets:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   remainder of the session:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">master_secret</span> = PRF(hs_master_secret, <span class="delete">"extended</span> master secret",</td><td> </td><td class="rblock">    <span class="insert">client_master_secret</span> = PRF(hs_master_secret, <span class="insert">"client master secret",</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               session_hash)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                               [0..47];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    server_master_secret = PRF(hs_master_secret, "server</span> master secret",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                          session_hash)</td><td> </td><td class="right">                          session_hash)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                          [0..47];</td><td> </td><td class="right">                          [0..47];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the server does not request client authentication, the master</td><td> </td><td class="right">   If the server does not request client authentication, the master</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   secret can be computed at the time that the server sends its</td><td> </td><td class="rblock">   secret<span class="insert">s</span> can be computed at the time that the server sends its</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Finished, thus allowing the server to send traffic on its first</td><td> </td><td class="right">   Finished, thus allowing the server to send traffic on its first</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   flight (see [TODO] for security considerations on this practice.)  If</td><td> </td><td class="right">   flight (see [TODO] for security considerations on this practice.)  If</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the server requests client authentication, this secret can be</td><td> </td><td class="right">   the server requests client authentication, this secret can be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   computed after the client's Certificate and CertificateVerify have</td><td> </td><td class="right">   computed after the client's Certificate and CertificateVerify have</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   been sent, or, if the client refuses client authentication, after the</td><td> </td><td class="right">   been sent, or, if the client refuses client authentication, after the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client's empty Certificate message has been sent.</td><td> </td><td class="right">   client's empty Certificate message has been sent.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   For full handshakes, each side also derives a new secret which will</td><td> </td><td class="right">   For full handshakes, each side also derives a new secret which will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   be used as the premaster_secret for future resumptions of the newly</td><td> </td><td class="right">   be used as the premaster_secret for future resumptions of the newly</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   established session.  This is computed as:</td><td> </td><td class="right">   established session.  This is computed as:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> page 65, line 22</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> page 65, line 33</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   string.  Note that this octet string (Z in IEEE 1363 terminology) as</td><td> </td><td class="right">   string.  Note that this octet string (Z in IEEE 1363 terminology) as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   output by FE2OSP, the Field Element to Octet String Conversion</td><td> </td><td class="right">   output by FE2OSP, the Field Element to Octet String Conversion</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Primitive, has constant length for any given field; leading zeros</td><td> </td><td class="right">   Primitive, has constant length for any given field; leading zeros</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   found in this octet string MUST NOT be truncated.</td><td> </td><td class="right">   found in this octet string MUST NOT be truncated.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (Note that this use of the identity KDF is a technicality.  The</td><td> </td><td class="right">   (Note that this use of the identity KDF is a technicality.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   complete picture is that ECDH is employed with a non-trivial KDF</td><td> </td><td class="right">   complete picture is that ECDH is employed with a non-trivial KDF</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   because TLS does not directly use the premaster secret for anything</td><td> </td><td class="right">   because TLS does not directly use the premaster secret for anything</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   other than for computing the master secret.)</td><td> </td><td class="right">   other than for computing the master secret.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">8.2.  Update Protocol</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   TLS supports an Update protocol which allows endpoints to update the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   cryptographic state of the connection after the handshake has been</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   completed.  The Update protocol can currently be used for the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   following tasks:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   -  Refreshing cryptographic keying material.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   -  Establishing a shared key which can be used to resume future</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      sessions.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In versions of TLS prior to TLS 1.3, these functions were part of the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   handshake and/or required renegotiation.  In TLS 1.3 they have been</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   moved into a separate subprotocol.  Future versions of this</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   specification may add new functions to the Update protocol.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">8.2.1.  General Update Protocol Behavior</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In general, Update messages have the following structure:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      enum { rekey(1), ack(2),  authentication(3), (255) } UpdateType;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      struct {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          UpdateType msg_type;       /* update type */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          uint24 length;             /* bytes in message */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          switch (msg_type) {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">            case ack:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              UpdateAck ack;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">            case rekey:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              UpdateRekey rekey;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">            /* This structure may be extended */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          }</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       } Update;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Whenever a site sends an Update message, it updates its own master</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   secret as follows:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">  X_master_secret_{i+1} = PRF(X_master_secret_i, "master_secret_update",</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                              Update_message)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This new master secret is used to generate traffic keys for</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   subsequent records that it sends.  Similarly, when a site receives an</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Update message, it updates its view of the peer's master secret and</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   uses that for new traffic that it receives from the peer.  The</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   previous master secret MUST be discarded.  [[TODO: DTLS?]]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">8.2.2.  ACK</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   When an implementation receives an Update of type other than "ack",</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   it MUST immediately generate an Update message of type ack to respond</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to it in response.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Structure of this message:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      enum { ignored(0), understood(1) (255)} UpdateComprehension;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      struct {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          UpdateComprehension comprehension;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          opaque digest&lt;0..255&gt;;  /* Based on the PRF */</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      } UpdateAck;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   comprehension</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      If the implementation recognized and processed the Update being</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      responded to, it SHALL set this value to "understood".  Otherwise,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      it SHALL set it to "ignored".</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   digest</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      Hash() of the Update message being responded to, including the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      type and length bytes.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The "comprehension" field indicates whether the responder processed</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the Update or not.  However, in either case, the ACK MUST be</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   generated rather than ignored.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">8.2.3.  Rekey</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An Update message of type "rekey" is used to refresh the keying</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   material for a connection.  Because Update messages MUST be</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   acknowledged, sending an UpdateRekey causes the keying material to be</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   refreshed in both directions.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Structure of this message:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      struct {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          Random random;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      } UpdateRekey;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   random</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      A random value as defined in Section 7.3.1.2.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Two common reasons for sending rekey updates are:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   -  Too much traffic has been encrypted with the same key, for</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      instance because the AEAD explicit nonce space is potentially</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      exhausted.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   -  Providing protection for already sent traffic against system</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      compromise.  Because master_secret_X_{i+1} is generated from</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      master_secret_X_i by a one-way function, once an Update has</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      occurred and the old master secret has been destroyed, compromise</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      of the endpoint does not threaten old traffic.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An implementation MAY send an UpdateRekey at any time after the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   handshake completes.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">9.  Mandatory Cipher Suites</td><td> </td><td class="right">9.  Mandatory Cipher Suites</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In the absence of an application profile standard specifying</td><td> </td><td class="right">   In the absence of an application profile standard specifying</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   otherwise, a TLS-compliant application MUST implement the cipher</td><td> </td><td class="right">   otherwise, a TLS-compliant application MUST implement the cipher</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   suite TODO:Needs to be selected [1].  (See Appendix A.5 for the</td><td> </td><td class="right">   suite TODO:Needs to be selected [1].  (See Appendix A.5 for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   definition).</td><td> </td><td class="right">   definition).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">10.  Application Data Protocol</td><td> </td><td class="right">10.  Application Data Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Application data messages are carried by the record layer and are</td><td> </td><td class="right">   Application data messages are carried by the record layer and are</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 10 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>52 lines changed or deleted</i></th><th><i> </i></th><th><i>171 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.34. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
