<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.34: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Darwin dhcp-8e78.meeting.ietf.org 13.4.0 Darwin Kernel Version 13.4.0: Sun Aug 17 19:50:11 PDT 2014; root:xnu-2422.115.4~1/RELEASE_X86_64 x86_64 --> 
<!-- Using awk: /opt/local/bin/gawk: GNU Awk 4.1.1, API: 1.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 2.8.1 --> 
<!-- Using wdiff: /opt/local/bin/wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: draft-ietf-tls-tls13-issue91_add_update_mechanism.txt - draft-ietf-tls-tls13-issue93_WIP_session_resumption_via_update.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;draft-ietf-tls-tls13-issue91_add_update_mechanism.txt&nbsp;</th><th> </th><th>&nbsp;draft-ietf-tls-tls13-issue93_WIP_session_resumption_via_update.txt&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> page 3, line 6</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> page 3, line 6</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     6.3.  Key Calculation . . . . . . . . . . . . . . . . . . . . .  23</td><td> </td><td class="right">     6.3.  Key Calculation . . . . . . . . . . . . . . . . . . . . .  23</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   7.  The TLS Handshaking Protocols . . . . . . . . . . . . . . . .  23</td><td> </td><td class="right">   7.  The TLS Handshaking Protocols . . . . . . . . . . . . . . . .  23</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     7.1.  Alert Protocol  . . . . . . . . . . . . . . . . . . . . .  24</td><td> </td><td class="right">     7.1.  Alert Protocol  . . . . . . . . . . . . . . . . . . . . .  24</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.1.1.  Closure Alerts  . . . . . . . . . . . . . . . . . . .  25</td><td> </td><td class="right">       7.1.1.  Closure Alerts  . . . . . . . . . . . . . . . . . . .  25</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.1.2.  Error Alerts  . . . . . . . . . . . . . . . . . . . .  26</td><td> </td><td class="right">       7.1.2.  Error Alerts  . . . . . . . . . . . . . . . . . . . .  26</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     7.2.  Handshake Protocol Overview . . . . . . . . . . . . . . .  30</td><td> </td><td class="right">     7.2.  Handshake Protocol Overview . . . . . . . . . . . . . . .  30</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     7.3.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  34</td><td> </td><td class="right">     7.3.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  34</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  35</td><td> </td><td class="right">       7.3.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  35</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.2.  Client Key Share Message  . . . . . . . . . . . . . .  39</td><td> </td><td class="right">       7.3.2.  Client Key Share Message  . . . . . . . . . . . . . .  39</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.3.  Server Key Share Message  . . . . . . . . . . . . . .  52</td><td> </td><td class="right">       7.3.3.  Server Key Share Message  . . . . . . . . . . . . . .  52</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       7.3.4.  Encrypted Extensions  . . . . . . . . . . . . . . . .  5<span class="delete">2</span></td><td> </td><td class="rblock">       7.3.4.  Encrypted Extensions  . . . . . . . . . . . . . . . .  5<span class="insert">3</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.5.  Server Certificate  . . . . . . . . . . . . . . . . .  53</td><td> </td><td class="right">       7.3.5.  Server Certificate  . . . . . . . . . . . . . . . . .  53</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       7.3.6.  Certificate Request . . . . . . . . . . . . . . . . .  5<span class="delete">5</span></td><td> </td><td class="rblock">       7.3.6.  Certificate Request . . . . . . . . . . . . . . . . .  5<span class="insert">6</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.7.  Server Certificate Verify . . . . . . . . . . . . . .  57</td><td> </td><td class="right">       7.3.7.  Server Certificate Verify . . . . . . . . . . . . . .  57</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       7.3.8.  Server Finished . . . . . . . . . . . . . . . . . . .  5<span class="delete">8</span></td><td> </td><td class="rblock">       7.3.8.  Server Finished . . . . . . . . . . . . . . . . . . .  5<span class="insert">9</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.9.  Client Certificate  . . . . . . . . . . . . . . . . .  60</td><td> </td><td class="right">       7.3.9.  Client Certificate  . . . . . . . . . . . . . . . . .  60</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       7.3.10. Client Certificate Verify . . . . . . . . . . . . . .  6<span class="delete">1</span></td><td> </td><td class="rblock">       7.3.10. Client Certificate Verify . . . . . . . . . . . . . .  6<span class="insert">2</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   8.  Cryptographic Computations  . . . . . . . . . . . . . . . . .  62</td><td> </td><td class="right">   8.  Cryptographic Computations  . . . . . . . . . . . . . . . . .  62</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     8.1.  Computing the Master Secret . . . . . . . . . . . . . . .  6<span class="delete">2</span></td><td> </td><td class="rblock">     8.1.  Computing the Master Secret . . . . . . . . . . . . . . .  6<span class="insert">3</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       8.1.1.  The Session Hash  . . . . . . . . . . . . . . . . . .  64</td><td> </td><td class="right">       8.1.1.  The Session Hash  . . . . . . . . . . . . . . . . . .  64</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       8.1.2.  Diffie-Hellman  . . . . . . . . . . . . . . . . . . .  65</td><td> </td><td class="right">       8.1.2.  Diffie-Hellman  . . . . . . . . . . . . . . . . . . .  65</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       8.1.3.  Elliptic Curve Diffie-Hellman . . . . . . . . . . . .  65</td><td> </td><td class="right">       8.1.3.  Elliptic Curve Diffie-Hellman . . . . . . . . . . . .  65</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     8.2.  Update Protocol . . . . . . . . . . . . . . . . . . . . .  65</td><td> </td><td class="right">     8.2.  Update Protocol . . . . . . . . . . . . . . . . . . . . .  65</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       8.2.1.  General Update Protocol Behavior  . . . . . . . . . .  66</td><td> </td><td class="right">       8.2.1.  General Update Protocol Behavior  . . . . . . . . . .  66</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       8.2.2.  ACK . . . . . . . . . . . . . . . . . . . . . . . . .  66</td><td> </td><td class="right">       8.2.2.  ACK . . . . . . . . . . . . . . . . . . . . . . . . .  66</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       8.2.3.  Rekey . . . . . . . . . . . . . . . . . . . . . . . .  67</td><td> </td><td class="right">       8.2.3.  Rekey . . . . . . . . . . . . . . . . . . . . . . . .  67</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       8.2.4.  Ticket  . . . . . . . . . . . . . . . . . . . . . . .  68</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   9.  Mandatory Cipher Suites . . . . . . . . . . . . . . . . . . .  68</td><td> </td><td class="right">   9.  Mandatory Cipher Suites . . . . . . . . . . . . . . . . . . .  68</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   10. Application Data Protocol . . . . . . . . . . . . . . . . . .  <span class="delete">68</span></td><td> </td><td class="rblock">   10. Application Data Protocol . . . . . . . . . . . . . . . . . .  <span class="insert">69</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   11. Security Considerations . . . . . . . . . . . . . . . . . . .  <span class="delete">68</span></td><td> </td><td class="rblock">   11. Security Considerations . . . . . . . . . . . . . . . . . . .  <span class="insert">69</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   12. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <span class="delete">68</span></td><td> </td><td class="rblock">   12. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <span class="insert">69</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   13. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">69</span></td><td> </td><td class="rblock">   13. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">70</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     13.1.  Normative References . . . . . . . . . . . . . . . . . .  70</td><td> </td><td class="right">     13.1.  Normative References . . . . . . . . . . . . . . . . . .  70</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     13.2.  Informative References . . . . . . . . . . . . . . . . .  <span class="delete">71</span></td><td> </td><td class="rblock">     13.2.  Informative References . . . . . . . . . . . . . . . . .  <span class="insert">72</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     13.3.  URIs . . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">74</span></td><td> </td><td class="rblock">     13.3.  URIs . . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">75</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix A.  Protocol Data Structures and Constant Values . . . .  <span class="delete">75</span></td><td> </td><td class="rblock">   Appendix A.  Protocol Data Structures and Constant Values . . . .  <span class="insert">76</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.1.  Record Layer  . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">75</span></td><td> </td><td class="rblock">     A.1.  Record Layer  . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">76</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.2.  Change Cipher Specs Message . . . . . . . . . . . . . . .  <span class="delete">75</span></td><td> </td><td class="rblock">     A.2.  Change Cipher Specs Message . . . . . . . . . . . . . . .  <span class="insert">76</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.3.  Alert Messages  . . . . . . . . . . . . . . . . . . . . .  <span class="delete">75</span></td><td> </td><td class="rblock">     A.3.  Alert Messages  . . . . . . . . . . . . . . . . . . . . .  <span class="insert">76</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.4.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="delete">76</span></td><td> </td><td class="rblock">     A.4.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="insert">77</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  <span class="delete">77</span></td><td> </td><td class="rblock">       A.4.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  <span class="insert">78</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.2.  Server Authentication and Key Exchange Messages . . .  <span class="delete">79</span></td><td> </td><td class="rblock">       A.4.2.  Server Authentication and Key Exchange Messages . . .  <span class="insert">80</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.3.  Client Authentication and Key Exchange Messages . . .  <span class="delete">79</span></td><td> </td><td class="rblock">       A.4.3.  Client Authentication and Key Exchange Messages . . .  <span class="insert">80</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.4.  Handshake Finalization Message  . . . . . . . . . . .  <span class="delete">80</span></td><td> </td><td class="rblock">       A.4.4.  Handshake Finalization Message  . . . . . . . . . . .  <span class="insert">81</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.5.  The Cipher Suite  . . . . . . . . . . . . . . . . . . . .  <span class="delete">80</span></td><td> </td><td class="rblock">     A.5.  The Cipher Suite  . . . . . . . . . . . . . . . . . . . .  <span class="insert">81</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.6.  The Security Parameters . . . . . . . . . . . . . . . . .  <span class="delete">82</span></td><td> </td><td class="rblock">     A.6.  The Security Parameters . . . . . . . . . . . . . . . . .  <span class="insert">83</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.7.  Changes to RFC 4492 . . . . . . . . . . . . . . . . . . .  <span class="delete">82</span></td><td> </td><td class="rblock">     A.7.  Changes to RFC 4492 . . . . . . . . . . . . . . . . . . .  <span class="insert">83</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix B.  Glossary . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">83</span></td><td> </td><td class="rblock">   Appendix B.  Glossary . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">84</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix C.  Cipher Suite Definitions . . . . . . . . . . . . . .  <span class="delete">86</span></td><td> </td><td class="rblock">   Appendix C.  Cipher Suite Definitions . . . . . . . . . . . . . .  <span class="insert">87</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix D.  Implementation Notes . . . . . . . . . . . . . . . .  <span class="delete">86</span></td><td> </td><td class="rblock">   Appendix D.  Implementation Notes . . . . . . . . . . . . . . . .  <span class="insert">87</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.1.  Random Number Generation and Seeding  . . . . . . . . . .  <span class="delete">86</span></td><td> </td><td class="rblock">     D.1.  Random Number Generation and Seeding  . . . . . . . . . .  <span class="insert">87</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.2.  Certificates and Authentication . . . . . . . . . . . . .  <span class="delete">87</span></td><td> </td><td class="rblock">     D.2.  Certificates and Authentication . . . . . . . . . . . . .  <span class="insert">88</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.3.  Cipher Suites . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">87</span></td><td> </td><td class="rblock">     D.3.  Cipher Suites . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">88</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.4.  Implementation Pitfalls . . . . . . . . . . . . . . . . .  <span class="delete">87</span></td><td> </td><td class="rblock">     D.4.  Implementation Pitfalls . . . . . . . . . . . . . . . . .  <span class="insert">88</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix E.  Backward Compatibility . . . . . . . . . . . . . . .  <span class="delete">88</span></td><td> </td><td class="rblock">   Appendix E.  Backward Compatibility . . . . . . . . . . . . . . .  <span class="insert">89</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.1.  Compatibility with TLS 1.0/1.1 and SSL 3.0  . . . . . . .  <span class="delete">88</span></td><td> </td><td class="rblock">     E.1.  Compatibility with TLS 1.0/1.1 and SSL 3.0  . . . . . . .  <span class="insert">89</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.2.  Compatibility with SSL 2.0  . . . . . . . . . . . . . . .  <span class="delete">90</span></td><td> </td><td class="rblock">     E.2.  Compatibility with SSL 2.0  . . . . . . . . . . . . . . .  <span class="insert">91</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.3.  Avoiding Man-in-the-Middle Version Rollback . . . . . . .  <span class="delete">92</span></td><td> </td><td class="rblock">     E.3.  Avoiding Man-in-the-Middle Version Rollback . . . . . . .  <span class="insert">93</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix F.  Security Analysis  . . . . . . . . . . . . . . . . .  <span class="delete">92</span></td><td> </td><td class="rblock">   Appendix F.  Security Analysis  . . . . . . . . . . . . . . . . .  <span class="insert">93</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.1.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="delete">92</span></td><td> </td><td class="rblock">     F.1.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="insert">93</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.1.  Authentication and Key Exchange . . . . . . . . . . .  <span class="delete">92</span></td><td> </td><td class="rblock">       F.1.1.  Authentication and Key Exchange . . . . . . . . . . .  <span class="insert">93</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.2.  Version Rollback Attacks  . . . . . . . . . . . . . .  <span class="delete">94</span></td><td> </td><td class="rblock">       F.1.2.  Version Rollback Attacks  . . . . . . . . . . . . . .  <span class="insert">95</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.3.  Detecting Attacks Against the Handshake Protocol  . .  <span class="delete">94</span></td><td> </td><td class="rblock">       F.1.3.  Detecting Attacks Against the Handshake Protocol  . .  <span class="insert">95</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.4.  Resuming Sessions . . . . . . . . . . . . . . . . . .  <span class="delete">94</span></td><td> </td><td class="rblock">       F.1.4.  Resuming Sessions . . . . . . . . . . . . . . . . . .  <span class="insert">95</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.2.  Protecting Application Data . . . . . . . . . . . . . . .  <span class="delete">95</span></td><td> </td><td class="rblock">     F.2.  Protecting Application Data . . . . . . . . . . . . . . .  <span class="insert">96</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.3.  Denial of Service . . . . . . . . . . . . . . . . . . . .  <span class="delete">95</span></td><td> </td><td class="rblock">     F.3.  Denial of Service . . . . . . . . . . . . . . . . . . . .  <span class="insert">96</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.4.  Final Notes . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">95</span></td><td> </td><td class="rblock">     F.4.  Final Notes . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">96</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix G.  Working Group Information  . . . . . . . . . . . . .  <span class="delete">96</span></td><td> </td><td class="rblock">   Appendix G.  Working Group Information  . . . . . . . . . . . . .  <span class="insert">97</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix H.  Contributors . . . . . . . . . . . . . . . . . . . .  <span class="delete">96</span></td><td> </td><td class="rblock">   Appendix H.  Contributors . . . . . . . . . . . . . . . . . . . .  <span class="insert">97</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   DISCLAIMER: This is a WIP draft of TLS 1.3 and has not yet seen</td><td> </td><td class="right">   DISCLAIMER: This is a WIP draft of TLS 1.3 and has not yet seen</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   significant security analysis.</td><td> </td><td class="right">   significant security analysis.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</td><td> </td><td class="right">   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   draft is maintained in GitHub.  Suggested changes should be submitted</td><td> </td><td class="right">   draft is maintained in GitHub.  Suggested changes should be submitted</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   as pull requests at https://github.com/tlswg/tls13-spec.</td><td> </td><td class="right">   as pull requests at https://github.com/tlswg/tls13-spec.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Instructions are on that page as well.  Editorial changes can be</td><td> </td><td class="right">   Instructions are on that page as well.  Editorial changes can be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> page 38, line 44</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> page 38, line 44</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The version of the TLS protocol by which the client wishes to</td><td> </td><td class="right">      The version of the TLS protocol by which the client wishes to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      communicate during this session.  This SHOULD be the latest</td><td> </td><td class="right">      communicate during this session.  This SHOULD be the latest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (highest valued) version supported by the client.  For this</td><td> </td><td class="right">      (highest valued) version supported by the client.  For this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      version of the specification, the version will be 3.4 (see</td><td> </td><td class="right">      version of the specification, the version will be 3.4 (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Appendix E for details about backward compatibility).</td><td> </td><td class="right">      Appendix E for details about backward compatibility).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   random</td><td> </td><td class="right">   random</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      A client-generated random structure.</td><td> </td><td class="right">      A client-generated random structure.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   session_id</td><td> </td><td class="right">   session_id</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">The ID</span> of <span class="delete">a</span> session <span class="delete">the client wishes to use for this connection.</span></td><td> </td><td class="rblock">      <span class="insert">Versions</span> of <span class="insert">TLS before 1.3 supported</span> session <span class="insert">resumption via a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      This field is empty if no</span> session_id <span class="delete">is available, or if</span> the</td><td> </td><td class="rblock">      session_id <span class="insert">in</span> the <span class="insert">ClientHello.  For TLS 1.3 resumptions, this</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">client wishes to generate new security parameters.</span></td><td> </td><td class="rblock"><span class="insert">      value MUST always be empty.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cipher_suites</td><td> </td><td class="right">   cipher_suites</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This is a list of the cryptographic options supported by the</td><td> </td><td class="right">      This is a list of the cryptographic options supported by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client, with the client's first preference first.  If the</td><td> </td><td class="right">      client, with the client's first preference first.  If the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      session_id field is not empty (implying a session resumption</td><td> </td><td class="right">      session_id field is not empty (implying a session resumption</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      request), this vector MUST include at least the cipher_suite from</td><td> </td><td class="right">      request), this vector MUST include at least the cipher_suite from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      that session.  Values are defined in Appendix A.5.</td><td> </td><td class="right">      that session.  Values are defined in Appendix A.5.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compression_methods</td><td> </td><td class="right">   compression_methods</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Versions of TLS before 1.3 supported compression and the list of</td><td> </td><td class="right">      Versions of TLS before 1.3 supported compression and the list of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> page 39, line 42</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> page 39, line 42</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerHello message.  Any handshake message returned by the server,</td><td> </td><td class="right">   ServerHello message.  Any handshake message returned by the server,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   except for a HelloRequest, is treated as a fatal error.</td><td> </td><td class="right">   except for a HelloRequest, is treated as a fatal error.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.3.2.  Client Key Share Message</td><td> </td><td class="right">7.3.2.  Client Key Share Message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message is always sent by the client.  It MUST immediately</td><td> </td><td class="right">      This message is always sent by the client.  It MUST immediately</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      follow the ClientHello message.  In backward compatibility mode</td><td> </td><td class="right">      follow the ClientHello message.  In backward compatibility mode</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (see Section XXX) it will be included in the EarlyData extension</td><td> </td><td class="right">      (see Section XXX) it will be included in the EarlyData extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      (Section 7.3.2.5.<span class="delete">4</span>) in the ClientHello.</td><td> </td><td class="rblock">      (Section 7.3.2.5.<span class="insert">5</span>) in the ClientHello.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Meaning of this message:</td><td> </td><td class="right">   Meaning of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message contains the client's cryptographic parameters for</td><td> </td><td class="right">      This message contains the client's cryptographic parameters for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      zero or more key establishment methods.</td><td> </td><td class="right">      zero or more key establishment methods.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          NamedGroup group;</td><td> </td><td class="right">          NamedGroup group;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> page 42, line 19</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> page 42, line 19</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This field will contain the lower of that suggested by the client</td><td> </td><td class="right">      This field will contain the lower of that suggested by the client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      in the client hello and the highest supported by the server.  For</td><td> </td><td class="right">      in the client hello and the highest supported by the server.  For</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      this version of the specification, the version is 3.4.  (See</td><td> </td><td class="right">      this version of the specification, the version is 3.4.  (See</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Appendix E for details about backward compatibility.)</td><td> </td><td class="right">      Appendix E for details about backward compatibility.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   random</td><td> </td><td class="right">   random</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This structure is generated by the server and MUST be</td><td> </td><td class="right">      This structure is generated by the server and MUST be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      independently generated from the ClientHello.random.</td><td> </td><td class="right">      independently generated from the ClientHello.random.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   session_id</td><td> </td><td class="right">   session_id</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">This is the identity</span> of <span class="delete">the session corresponding to this</span></td><td> </td><td class="rblock">      <span class="insert">Versions</span> of <span class="insert">TLS before 1.3 supported</span> session <span class="insert">resumption via</span> a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      connection.  If the ClientHello.session_id was non-empty, the</span></td><td> </td><td class="rblock">      <span class="insert">session_id in</span> the <span class="insert">ClientHello.  For TLS 1.3 ServerHellos</span> this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      server will look in its session cache for a match.  If a match is</span></td><td> </td><td class="rblock">      value MUST <span class="insert">always</span> be <span class="insert">empty.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      found and the server is willing to establish the new connection</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      using the specified</span> session <span class="delete">state, the server will respond with</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      the same value as was supplied by the client.  This indicates</span> a</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">resumed session and dictates that the parties must proceed</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      directly to</span> the <span class="delete">Finished messages.  Otherwise,</span> this <span class="delete">field will</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      contain a different</span> value <span class="delete">identifying the new session.  The server</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      may return an empty session_id to indicate that the session will</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      not be cached and therefore cannot be resumed.  If a session is</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      resumed, it must be resumed using the same cipher suite it was</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      originally negotiated with.  Note that there is no requirement</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      that the server resume any session even if it had formerly</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      provided a session_id.  Clients</span> MUST be <span class="delete">prepared to do a full</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      negotiation -- including negotiating new cipher suites -- during</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      any handshake.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cipher_suite</td><td> </td><td class="right">   cipher_suite</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The single cipher suite selected by the server from the list in</td><td> </td><td class="right">      The single cipher suite selected by the server from the list in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientHello.cipher_suites.  For resumed sessions, this field is</td><td> </td><td class="right">      ClientHello.cipher_suites.  For resumed sessions, this field is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the value from the state of the session being resumed.</td><td> </td><td class="right">      the value from the state of the session being resumed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extensions</td><td> </td><td class="right">   extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      A list of extensions.  Note that only extensions offered by the</td><td> </td><td class="right">      A list of extensions.  Note that only extensions offered by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client can appear in the server's list.  In TLS 1.3 as opposed to</td><td> </td><td class="right">      client can appear in the server's list.  In TLS 1.3 as opposed to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      previous versions of TLS, the server's extensions are split</td><td> </td><td class="right">      previous versions of TLS, the server's extensions are split</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> page 51, line 5</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> page 51, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compressed format even when a client cannot parse this format: the</td><td> </td><td class="right">   compressed format even when a client cannot parse this format: the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   same client may nevertheless be capable of outputting points in</td><td> </td><td class="right">   same client may nevertheless be capable of outputting points in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compressed format).</td><td> </td><td class="right">   compressed format).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   An endpoint that receives a hello message containing a Supported</td><td> </td><td class="right">   An endpoint that receives a hello message containing a Supported</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Point Formats Extension MUST respect the sender's choice of point</td><td> </td><td class="right">   Point Formats Extension MUST respect the sender's choice of point</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   formats during the handshake.  If no Supported Point Formats</td><td> </td><td class="right">   formats during the handshake.  If no Supported Point Formats</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Extension is received this is equivalent to an extension allowing</td><td> </td><td class="right">   Extension is received this is equivalent to an extension allowing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   only the uncompressed point format.</td><td> </td><td class="right">   only the uncompressed point format.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.3.2.5.4.  Early Data Extension</td><td> </td><td class="rblock">7.3.2.5.4.  <span class="insert">Session Ticket Extension</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The format of this extension is an opaque structure used to carry</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   session-specific state information.  This extension may be sent in</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the ClientHello and ServerHello. {{RFC5077} contains background on</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   session tickets.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   If the client possesses a ticket that it wants to use to resume a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   session, then it includes the ticket in the SessionTicket extension</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   in the ClientHello.  If the server fails to verify the ticket, then</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   it falls back to performing a full handshake.  If the ticket is</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   accepted by the server but the handshake fails, the client SHOULD</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   delete the ticket.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The SessionTicket extension has been assigned the number 35.  The</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   extension_data field of SessionTicket extension contains the ticket.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">7.3.2.5.5.</span>  Early Data Extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS versions before 1.3 have a strict message ordering and do not</td><td> </td><td class="right">   TLS versions before 1.3 have a strict message ordering and do not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   permit additional messages to follow the ClientHello.  The EarlyData</td><td> </td><td class="right">   permit additional messages to follow the ClientHello.  The EarlyData</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension allows TLS messages which would otherwise be sent as</td><td> </td><td class="right">   extension allows TLS messages which would otherwise be sent as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   separate records to be instead inserted in the ClientHello.  The</td><td> </td><td class="right">   separate records to be instead inserted in the ClientHello.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension simply contains the TLS records which would otherwise have</td><td> </td><td class="right">   extension simply contains the TLS records which would otherwise have</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   been included in the client's first flight.</td><td> </td><td class="right">   been included in the client's first flight.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         struct {</td><td> </td><td class="right">         struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           TLSCipherText messages&lt;5 .. 2^24-1&gt;;</td><td> </td><td class="right">           TLSCipherText messages&lt;5 .. 2^24-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> page 66, line 9</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> page 66, line 9</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In versions of TLS prior to TLS 1.3, these functions were part of the</td><td> </td><td class="right">   In versions of TLS prior to TLS 1.3, these functions were part of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake and/or required renegotiation.  In TLS 1.3 they have been</td><td> </td><td class="right">   handshake and/or required renegotiation.  In TLS 1.3 they have been</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   moved into a separate subprotocol.  Future versions of this</td><td> </td><td class="right">   moved into a separate subprotocol.  Future versions of this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   specification may add new functions to the Update protocol.</td><td> </td><td class="right">   specification may add new functions to the Update protocol.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">8.2.1.  General Update Protocol Behavior</td><td> </td><td class="right">8.2.1.  General Update Protocol Behavior</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In general, Update messages have the following structure:</td><td> </td><td class="right">   In general, Update messages have the following structure:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      enum { rekey(1), ack(2),  authentication(3), (255) } UpdateType;</td><td> </td><td class="rblock">      enum { rekey(1), ack(2),  authentication(3),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">             <span class="insert">ticket(4),</span> (255) } UpdateType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          UpdateType msg_type;       /* update type */</td><td> </td><td class="right">          UpdateType msg_type;       /* update type */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint24 length;             /* bytes in message */</td><td> </td><td class="right">          uint24 length;             /* bytes in message */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          switch (msg_type) {</td><td> </td><td class="right">          switch (msg_type) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            case ack:</td><td> </td><td class="right">            case ack:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              UpdateAck ack;</td><td> </td><td class="right">              UpdateAck ack;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            case rekey:</td><td> </td><td class="right">            case rekey:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              UpdateRekey rekey;</td><td> </td><td class="right">              UpdateRekey rekey;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">            <span class="insert">case session_id:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              UpdateSessionId session_id;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            /* This structure may be extended */</td><td> </td><td class="right">            /* This structure may be extended */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          }</td><td> </td><td class="right">          }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       } Update;</td><td> </td><td class="right">       } Update;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Whenever a site sends an Update message, it updates its own master</td><td> </td><td class="right">   Whenever a site sends an Update message, it updates its own master</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   secret as follows:</td><td> </td><td class="right">   secret as follows:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  X_master_secret_{i+1} = PRF(X_master_secret_i, "master_secret_update",</td><td> </td><td class="right">  X_master_secret_{i+1} = PRF(X_master_secret_i, "master_secret_update",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                              Update_message)</td><td> </td><td class="right">                              Update_message)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This new master secret is used to generate traffic keys for</td><td> </td><td class="right">   This new master secret is used to generate traffic keys for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   subsequent records that it sends.  Similarly, when a site receives an</td><td> </td><td class="right">   subsequent records that it sends.  Similarly, when a site receives an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Update message, it updates its view of the peer's master secret and</td><td> </td><td class="right">   Update message, it updates its view of the peer's master secret and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   uses that for new traffic that it receives from the peer.  The</td><td> </td><td class="right">   uses that for new traffic that it receives from the peer.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   previous master secret MUST be discarded.  [[TODO: DTLS?]]</td><td> </td><td class="rblock">   previous master secret MUST be discarded.  [[TODO: DTLS?]] <span class="insert">For</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Updates sent by the server, the resumption_master_secret is also</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   updated as described above.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">8.2.2.  ACK</td><td> </td><td class="right">8.2.2.  ACK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When an implementation receives an Update of type other than "ack",</td><td> </td><td class="right">   When an implementation receives an Update of type other than "ack",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   it MUST immediately generate an Update message of type ack to respond</td><td> </td><td class="right">   it MUST immediately generate an Update message of type ack to respond</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to it in response.</td><td> </td><td class="right">   to it in response.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum { ignored(0), understood(1) (255)} UpdateComprehension;</td><td> </td><td class="right">      enum { ignored(0), understood(1) (255)} UpdateComprehension;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> page 68, line 5</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> page 68, line 8</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Providing protection for already sent traffic against system</td><td> </td><td class="right">   -  Providing protection for already sent traffic against system</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      compromise.  Because master_secret_X_{i+1} is generated from</td><td> </td><td class="right">      compromise.  Because master_secret_X_{i+1} is generated from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      master_secret_X_i by a one-way function, once an Update has</td><td> </td><td class="right">      master_secret_X_i by a one-way function, once an Update has</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      occurred and the old master secret has been destroyed, compromise</td><td> </td><td class="right">      occurred and the old master secret has been destroyed, compromise</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      of the endpoint does not threaten old traffic.</td><td> </td><td class="right">      of the endpoint does not threaten old traffic.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   An implementation MAY send an UpdateRekey at any time after the</td><td> </td><td class="right">   An implementation MAY send an UpdateRekey at any time after the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake completes.</td><td> </td><td class="right">   handshake completes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">8.2.4.  Ticket</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The UpdateTicket message is used by the server to establish a new</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   session_id with the client.  This message binds the current</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   resumption_master_secret to the provided ticket.  The server MAY</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   allow resumption on previous session ids established on this</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   connection but the client SHOULD discard the existing session ID for</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the connection.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Structure of this message:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      struct {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">         uint32 ticket_lifetime_hint;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">         opaque ticket_id&lt;0..2^16-1&gt;;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      } UpdateTicket;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   lifetime_hint</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      The ticket_lifetime_hint field contains a hint from the server</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      about how long the ticket should be stored.  The value indicates</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      the lifetime in seconds as a 32-bit unsigned integer in network</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      byte order relative to when the ticket is received.  A value of</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      zero is reserved to indicate that the lifetime of the ticket is</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      unspecified.  A client SHOULD delete the ticket and associated</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      state when the time expires.  It MAY delete the ticket earlier</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      based on local policy.  A server MAY treat a ticket as valid for a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      shorter or longer period of time than what is stated in the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      ticket_lifetime_hint.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ticket_id</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      The ticket_id value, which is opaque from the client's</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      perspective.  This may either be a simple opaque ID or a session</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      ticket as defined in [RFC5077].</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Previous versions of TLS used the session_id field in the ClientHello</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   and ServerHello messages for session resumption.  As of TLS 1.3, this</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   value is subsumed by the UpdateTicket mechanism.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">9.  Mandatory Cipher Suites</td><td> </td><td class="right">9.  Mandatory Cipher Suites</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In the absence of an application profile standard specifying</td><td> </td><td class="right">   In the absence of an application profile standard specifying</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   otherwise, a TLS-compliant application MUST implement the cipher</td><td> </td><td class="right">   otherwise, a TLS-compliant application MUST implement the cipher</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   suite TODO:Needs to be selected [1].  (See Appendix A.5 for the</td><td> </td><td class="right">   suite TODO:Needs to be selected [1].  (See Appendix A.5 for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   definition).</td><td> </td><td class="right">   definition).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">10.  Application Data Protocol</td><td> </td><td class="right">10.  Application Data Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Application data messages are carried by the record layer and are</td><td> </td><td class="right">   Application data messages are carried by the record layer and are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> page 70, line 38</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> page 71, line 28</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC3280]  Housley, R., Polk, W., Ford, W., and D. Solo, "Internet</td><td> </td><td class="right">   [RFC3280]  Housley, R., Polk, W., Ford, W., and D. Solo, "Internet</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              X.509 Public Key Infrastructure Certificate and</td><td> </td><td class="right">              X.509 Public Key Infrastructure Certificate and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Certificate Revocation List (CRL) Profile", RFC 3280,</td><td> </td><td class="right">              Certificate Revocation List (CRL) Profile", RFC 3280,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              April 2002.</td><td> </td><td class="right">              April 2002.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC3447]  Jonsson, J. and B. Kaliski, "Public-Key Cryptography</td><td> </td><td class="right">   [RFC3447]  Jonsson, J. and B. Kaliski, "Public-Key Cryptography</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Standards (PKCS) #1: RSA Cryptography Specifications</td><td> </td><td class="right">              Standards (PKCS) #1: RSA Cryptography Specifications</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Version 2.1", RFC 3447, February 2003.</td><td> </td><td class="right">              Version 2.1", RFC 3447, February 2003.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC5077]  Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              "Transport Layer Security (TLS) Session Resumption without</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Server-Side State", RFC 5077, January 2008.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC5288]  Salowey, J., Choudhury, A., and D. McGrew, "AES Galois</td><td> </td><td class="right">   [RFC5288]  Salowey, J., Choudhury, A., and D. McGrew, "AES Galois</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Counter Mode (GCM) Cipher Suites for TLS", RFC 5288,</td><td> </td><td class="right">              Counter Mode (GCM) Cipher Suites for TLS", RFC 5288,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              August 2008.</td><td> </td><td class="right">              August 2008.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [SCH]      Schneier, B., "Applied Cryptography: Protocols,</td><td> </td><td class="right">   [SCH]      Schneier, B., "Applied Cryptography: Protocols,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Algorithms, and Source Code in C, 2nd ed.", 1996.</td><td> </td><td class="right">              Algorithms, and Source Code in C, 2nd ed.", 1996.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [SHS]      National Institute of Standards and Technology, U.S.</td><td> </td><td class="right">   [SHS]      National Institute of Standards and Technology, U.S.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Department of Commerce, "Secure Hash Standard", NIST FIPS</td><td> </td><td class="right">              Department of Commerce, "Secure Hash Standard", NIST FIPS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              PUB 180-2, August 2002.</td><td> </td><td class="right">              PUB 180-2, August 2002.</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 17 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>69 lines changed or deleted</i></th><th><i> </i></th><th><i>120 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.34. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
