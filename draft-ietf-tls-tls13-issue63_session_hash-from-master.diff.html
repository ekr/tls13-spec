<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.34: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Darwin dhcp-8e78.meeting.ietf.org 13.4.0 Darwin Kernel Version 13.4.0: Sun Aug 17 19:50:11 PDT 2014; root:xnu-2422.115.4~1/RELEASE_X86_64 x86_64 --> 
<!-- Using awk: /opt/local/bin/gawk: GNU Awk 4.1.1, API: 1.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 2.8.1 --> 
<!-- Using wdiff: /opt/local/bin/wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: draft-ietf-tls-tls13-master.txt - draft-ietf-tls-tls13-issue63_session_hash.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;draft-ietf-tls-tls13-master.txt&nbsp;</th><th> </th><th>&nbsp;draft-ietf-tls-tls13-issue63_session_hash.txt&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> page 2, line 35</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> page 2, line 35</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     1.3.  Major Differences from TLS 1.1  . . . . . . . . . . . . .   6</td><td> </td><td class="right">     1.3.  Major Differences from TLS 1.1  . . . . . . . . . . . . .   6</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   2.  Goals . . . . . . . . . . . . . . . . . . . . . . . . . . . .   7</td><td> </td><td class="right">   2.  Goals . . . . . . . . . . . . . . . . . . . . . . . . . . . .   7</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   3.  Goals of This Document  . . . . . . . . . . . . . . . . . . .   8</td><td> </td><td class="right">   3.  Goals of This Document  . . . . . . . . . . . . . . . . . . .   8</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   4.  Presentation Language . . . . . . . . . . . . . . . . . . . .   8</td><td> </td><td class="right">   4.  Presentation Language . . . . . . . . . . . . . . . . . . . .   8</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.1.  Basic Block Size  . . . . . . . . . . . . . . . . . . . .   8</td><td> </td><td class="right">     4.1.  Basic Block Size  . . . . . . . . . . . . . . . . . . . .   8</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.2.  Miscellaneous . . . . . . . . . . . . . . . . . . . . . .   9</td><td> </td><td class="right">     4.2.  Miscellaneous . . . . . . . . . . . . . . . . . . . . . .   9</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.3.  Vectors . . . . . . . . . . . . . . . . . . . . . . . . .   9</td><td> </td><td class="right">     4.3.  Vectors . . . . . . . . . . . . . . . . . . . . . . . . .   9</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.4.  Numbers . . . . . . . . . . . . . . . . . . . . . . . . .  10</td><td> </td><td class="right">     4.4.  Numbers . . . . . . . . . . . . . . . . . . . . . . . . .  10</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.5.  Enumerateds . . . . . . . . . . . . . . . . . . . . . . .  10</td><td> </td><td class="right">     4.5.  Enumerateds . . . . . . . . . . . . . . . . . . . . . . .  10</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.6.  Constructed Types . . . . . . . . . . . . . . . . . . . .  11</td><td> </td><td class="right">     4.6.  Constructed Types . . . . . . . . . . . . . . . . . . . .  11</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.6.1.  Variants  . . . . . . . . . . . . . . . . . . . . . .  1<span class="delete">1</span></td><td> </td><td class="rblock">       4.6.1.  Variants  . . . . . . . . . . . . . . . . . . . . . .  1<span class="insert">2</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.7.  Cryptographic Attributes  . . . . . . . . . . . . . . . .  13</td><td> </td><td class="right">     4.7.  Cryptographic Attributes  . . . . . . . . . . . . . . . .  13</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     4.8.  Constants . . . . . . . . . . . . . . . . . . . . . . . .  1<span class="delete">4</span></td><td> </td><td class="rblock">     4.8.  Constants . . . . . . . . . . . . . . . . . . . . . . . .  1<span class="insert">5</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   5.  The Pseudorandom Function . . . . . . . . . . . . . . . . . .  15</td><td> </td><td class="right">   5.  The Pseudorandom Function . . . . . . . . . . . . . . . . . .  15</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   6.  The TLS Record Protocol . . . . . . . . . . . . . . . . . . .  16</td><td> </td><td class="right">   6.  The TLS Record Protocol . . . . . . . . . . . . . . . . . . .  16</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     6.1.  Connection States . . . . . . . . . . . . . . . . . . . .  17</td><td> </td><td class="right">     6.1.  Connection States . . . . . . . . . . . . . . . . . . . .  17</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     6.2.  Record Layer  . . . . . . . . . . . . . . . . . . . . . .  19</td><td> </td><td class="right">     6.2.  Record Layer  . . . . . . . . . . . . . . . . . . . . . .  19</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       6.2.1.  Fragmentation . . . . . . . . . . . . . . . . . . . .  19</td><td> </td><td class="right">       6.2.1.  Fragmentation . . . . . . . . . . . . . . . . . . . .  19</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       6.2.2.  Record Payload Protection . . . . . . . . . . . . . .  <span class="delete">20</span></td><td> </td><td class="rblock">       6.2.2.  Record Payload Protection . . . . . . . . . . . . . .  <span class="insert">21</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     6.3.  Key Calculation . . . . . . . . . . . . . . . . . . . . .  <span class="delete">22</span></td><td> </td><td class="rblock">     6.3.  Key Calculation . . . . . . . . . . . . . . . . . . . . .  <span class="insert">23</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   7.  The TLS Handshaking Protocols . . . . . . . . . . . . . . . .  23</td><td> </td><td class="right">   7.  The TLS Handshaking Protocols . . . . . . . . . . . . . . . .  23</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     7.1.  <span class="delete">Change Cipher Spec Protocol . . . . . . . . . . . . . . .  24</span></td><td> </td><td class="rblock">     7.1.  Alert Protocol  . . . . . . . . . . . . . . . . . . . . .  24</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     7.2.</span>  Alert Protocol  . . . . . . . . . . . . . . . . . . . . .  24</td><td> </td><td class="rblock">       <span class="insert">7.1.1.</span>  Closure Alerts  . . . . . . . . . . . . . . . . . . .  25</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.2.1.</span>  Closure Alerts  . . . . . . . . . . . . . . . . . . .  25</td><td> </td><td class="rblock">       <span class="insert">7.1.2.</span>  Error Alerts  . . . . . . . . . . . . . . . . . . . .  26</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.2.2.</span>  Error Alerts  . . . . . . . . . . . . . . . . . . . .  26</td><td> </td><td class="rblock">     <span class="insert">7.2.</span>  Handshake Protocol Overview . . . . . . . . . . . . . . .  30</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     <span class="delete">7.3.</span>  Handshake Protocol Overview . . . . . . . . . . . . . . .  30</td><td> </td><td class="rblock">     <span class="insert">7.3.</span>  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  34</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     <span class="delete">7.4.</span>  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  34</td><td> </td><td class="rblock">       <span class="insert">7.3.1.</span>  Hello Messages  . . . . . . . . . . . . . . . . . . .  35</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.4.1.</span>  Hello Messages  . . . . . . . . . . . . . . . . . . .  35</td><td> </td><td class="rblock">       <span class="insert">7.3.2.</span>  Client Key Share Message  . . . . . . . . . . . . . .  39</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.4.2.</span>  Client Key Share Message  . . . . . . . . . . . . . .  39</td><td> </td><td class="rblock">       <span class="insert">7.3.3.</span>  Server Key Share Message  . . . . . . . . . . . . . .  52</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.4.3.</span>  Server Key Share Message  . . . . . . . . . . . . . .  52</td><td> </td><td class="rblock">       <span class="insert">7.3.4.</span>  Encrypted Extensions  . . . . . . . . . . . . . . . .  52</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.4.4.</span>  Encrypted Extensions  . . . . . . . . . . . . . . . .  52</td><td> </td><td class="rblock">       <span class="insert">7.3.5.</span>  Server Certificate  . . . . . . . . . . . . . . . . .  53</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.4.5.</span>  Server Certificate  . . . . . . . . . . . . . . . . .  53</td><td> </td><td class="rblock">       <span class="insert">7.3.6.</span>  Certificate Request . . . . . . . . . . . . . . . . .  55</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.4.6.</span>  Certificate Request . . . . . . . . . . . . . . . . .  55</td><td> </td><td class="rblock">       <span class="insert">7.3.7.</span>  Server Certificate Verify . . . . . . . . . . . . . .  57</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.4.7.</span>  Server Certificate Verify . . . . . . . . . . . . . .  57</td><td> </td><td class="rblock">       <span class="insert">7.3.8.</span>  Server Finished . . . . . . . . . . . . . . . . . . .  58</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.4.8.</span>  Server Finished . . . . . . . . . . . . . . . . . . .  58</td><td> </td><td class="rblock">       <span class="insert">7.3.9.</span>  Client Certificate  . . . . . . . . . . . . . . . . .  60</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.4.9.</span>  Client Certificate  . . . . . . . . . . . . . . . . .  60</td><td> </td><td class="rblock">       <span class="insert">7.3.10.</span> Client Certificate Verify . . . . . . . . . . . . . .  61</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.4.10.</span> Client Certificate Verify . . . . . . . . . . . . . .  61</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   8.  Cryptographic Computations  . . . . . . . . . . . . . . . . .  62</td><td> </td><td class="right">   8.  Cryptographic Computations  . . . . . . . . . . . . . . . . .  62</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     8.1.  Computing the Master Secret . . . . . . . . . . . . . . .  62</td><td> </td><td class="right">     8.1.  Computing the Master Secret . . . . . . . . . . . . . . .  62</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       8.1.1.  Diffie-Hellman  . . . . . . . . . . . . . . . . . . .  <span class="delete">63</span></td><td> </td><td class="rblock">       8.1.1.  <span class="insert">The Session Hash  . . . . . . . . . . . . . . . . . .  64</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       8.1.2.</span>  Elliptic Curve Diffie-Hellman . . . . . . . . . . . .  <span class="delete">63</span></td><td> </td><td class="rblock"><span class="insert">       8.1.2.</span>  Diffie-Hellman  . . . . . . . . . . . . . . . . . . .  <span class="insert">64</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   9.  Mandatory Cipher Suites . . . . . . . . . . . . . . . . . . .  <span class="delete">63</span></td><td> </td><td class="rblock"><span class="insert">       8.1.3.</span>  Elliptic Curve Diffie-Hellman . . . . . . . . . . . .  <span class="insert">65</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   10. Application Data Protocol . . . . . . . . . . . . . . . . . .  <span class="delete">63</span></td><td> </td><td class="rblock">   9.  Mandatory Cipher Suites . . . . . . . . . . . . . . . . . . .  <span class="insert">65</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   11. Security Considerations . . . . . . . . . . . . . . . . . . .  <span class="delete">63</span></td><td> </td><td class="rblock">   10. Application Data Protocol . . . . . . . . . . . . . . . . . .  <span class="insert">65</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   12. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <span class="delete">64</span></td><td> </td><td class="rblock">   11. Security Considerations . . . . . . . . . . . . . . . . . . .  <span class="insert">65</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   13. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">65</span></td><td> </td><td class="rblock">   12. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <span class="insert">65</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     13.1.  Normative References . . . . . . . . . . . . . . . . . .  <span class="delete">65</span></td><td> </td><td class="rblock">   13. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">67</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     13.2.  Informative References . . . . . . . . . . . . . . . . .  <span class="delete">66</span></td><td> </td><td class="rblock">     13.1.  Normative References . . . . . . . . . . . . . . . . . .  <span class="insert">67</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     13.3.  URIs . . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">69</span></td><td> </td><td class="rblock">     13.2.  Informative References . . . . . . . . . . . . . . . . .  <span class="insert">68</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix A.  Protocol Data Structures and Constant Values . . . .  <span class="delete">70</span></td><td> </td><td class="rblock">     13.3.  URIs . . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">71</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.1.  Record Layer  . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">70</span></td><td> </td><td class="rblock">   Appendix A.  Protocol Data Structures and Constant Values . . . .  <span class="insert">72</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.2.  Change Cipher Specs Message . . . . . . . . . . . . . . .  <span class="delete">70</span></td><td> </td><td class="rblock">     A.1.  Record Layer  . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">72</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.3.  Alert Messages  . . . . . . . . . . . . . . . . . . . . .  <span class="delete">70</span></td><td> </td><td class="rblock">     A.2.  Change Cipher Specs Message . . . . . . . . . . . . . . .  <span class="insert">72</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.4.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="delete">71</span></td><td> </td><td class="rblock">     A.3.  Alert Messages  . . . . . . . . . . . . . . . . . . . . .  <span class="insert">72</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  <span class="delete">72</span></td><td> </td><td class="rblock">     A.4.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="insert">73</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.2.  Server Authentication and Key Exchange Messages . . .  <span class="delete">74</span></td><td> </td><td class="rblock">       A.4.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  <span class="insert">74</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.3.  Client Authentication and Key Exchange Messages . . .  <span class="delete">74</span></td><td> </td><td class="rblock">       A.4.2.  Server Authentication and Key Exchange Messages . . .  <span class="insert">76</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.4.  Handshake Finalization Message  . . . . . . . . . . .  <span class="delete">75</span></td><td> </td><td class="rblock">       A.4.3.  Client Authentication and Key Exchange Messages . . .  <span class="insert">76</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.5.  The Cipher Suite  . . . . . . . . . . . . . . . . . . . .  <span class="delete">75</span></td><td> </td><td class="rblock">       A.4.4.  Handshake Finalization Message  . . . . . . . . . . .  <span class="insert">77</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.6.  The Security Parameters . . . . . . . . . . . . . . . . .  <span class="delete">77</span></td><td> </td><td class="rblock">     A.5.  The Cipher Suite  . . . . . . . . . . . . . . . . . . . .  <span class="insert">77</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.7.  Changes to RFC 4492 . . . . . . . . . . . . . . . . . . .  <span class="delete">77</span></td><td> </td><td class="rblock">     A.6.  The Security Parameters . . . . . . . . . . . . . . . . .  <span class="insert">79</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix B.  Glossary . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">78</span></td><td> </td><td class="rblock">     A.7.  Changes to RFC 4492 . . . . . . . . . . . . . . . . . . .  <span class="insert">79</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix C.  Cipher Suite Definitions . . . . . . . . . . . . . .  <span class="delete">81</span></td><td> </td><td class="rblock">   Appendix B.  Glossary . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">80</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix D.  Implementation Notes . . . . . . . . . . . . . . . .  <span class="delete">81</span></td><td> </td><td class="rblock">   Appendix C.  Cipher Suite Definitions . . . . . . . . . . . . . .  <span class="insert">83</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.1.  Random Number Generation and Seeding  . . . . . . . . . .  <span class="delete">81</span></td><td> </td><td class="rblock">   Appendix D.  Implementation Notes . . . . . . . . . . . . . . . .  <span class="insert">83</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.2.  Certificates and Authentication . . . . . . . . . . . . .  <span class="delete">82</span></td><td> </td><td class="rblock">     D.1.  Random Number Generation and Seeding  . . . . . . . . . .  <span class="insert">83</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.3.  Cipher Suites . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">82</span></td><td> </td><td class="rblock">     D.2.  Certificates and Authentication . . . . . . . . . . . . .  <span class="insert">84</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.4.  Implementation Pitfalls . . . . . . . . . . . . . . . . .  <span class="delete">82</span></td><td> </td><td class="rblock">     D.3.  Cipher Suites . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">84</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix E.  Backward Compatibility . . . . . . . . . . . . . . .  <span class="delete">83</span></td><td> </td><td class="rblock">     D.4.  Implementation Pitfalls . . . . . . . . . . . . . . . . .  <span class="insert">84</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.1.  Compatibility with TLS 1.0/1.1 and SSL 3.0  . . . . . . .  <span class="delete">83</span></td><td> </td><td class="rblock">   Appendix E.  Backward Compatibility . . . . . . . . . . . . . . .  <span class="insert">85</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.2.  Compatibility with SSL 2.0  . . . . . . . . . . . . . . .  <span class="delete">85</span></td><td> </td><td class="rblock">     E.1.  Compatibility with TLS 1.0/1.1 and SSL 3.0  . . . . . . .  <span class="insert">85</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.3.  Avoiding Man-in-the-Middle Version Rollback . . . . . . .  <span class="delete">87</span></td><td> </td><td class="rblock">     E.2.  Compatibility with SSL 2.0  . . . . . . . . . . . . . . .  <span class="insert">87</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix F.  Security Analysis  . . . . . . . . . . . . . . . . .  <span class="delete">87</span></td><td> </td><td class="rblock">     E.3.  Avoiding Man-in-the-Middle Version Rollback . . . . . . .  <span class="insert">89</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.1.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="delete">87</span></td><td> </td><td class="rblock">   Appendix F.  Security Analysis  . . . . . . . . . . . . . . . . .  <span class="insert">89</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.1.  Authentication and Key Exchange . . . . . . . . . . .  <span class="delete">87</span></td><td> </td><td class="rblock">     F.1.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="insert">89</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.2.  Version Rollback Attacks  . . . . . . . . . . . . . .  <span class="delete">89</span></td><td> </td><td class="rblock">       F.1.1.  Authentication and Key Exchange . . . . . . . . . . .  <span class="insert">89</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.3.  Detecting Attacks Against the Handshake Protocol  . .  <span class="delete">89</span></td><td> </td><td class="rblock">       F.1.2.  Version Rollback Attacks  . . . . . . . . . . . . . .  <span class="insert">91</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.4.  Resuming Sessions . . . . . . . . . . . . . . . . . .  <span class="delete">89</span></td><td> </td><td class="rblock">       F.1.3.  Detecting Attacks Against the Handshake Protocol  . .  <span class="insert">91</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.2.  Protecting Application Data . . . . . . . . . . . . . . .  <span class="delete">90</span></td><td> </td><td class="rblock">       F.1.4.  Resuming Sessions . . . . . . . . . . . . . . . . . .  <span class="insert">91</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.3.  Denial of Service . . . . . . . . . . . . . . . . . . . .  <span class="delete">90</span></td><td> </td><td class="rblock">     F.2.  Protecting Application Data . . . . . . . . . . . . . . .  <span class="insert">92</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.4.  Final Notes . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">90</span></td><td> </td><td class="rblock">     F.3.  Denial of Service . . . . . . . . . . . . . . . . . . . .  <span class="insert">92</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix G.  Working Group Information  . . . . . . . . . . . . .  <span class="delete">91</span></td><td> </td><td class="rblock">     F.4.  Final Notes . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">92</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix H.  Contributors . . . . . . . . . . . . . . . . . . . .  <span class="delete">91</span></td><td> </td><td class="rblock">   Appendix G.  Working Group Information  . . . . . . . . . . . . .  <span class="insert">93</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   Appendix H.  Contributors . . . . . . . . . . . . . . . . . . . .  <span class="insert">93</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   DISCLAIMER: This is a WIP draft of TLS 1.3 and has not yet seen</td><td> </td><td class="right">   DISCLAIMER: This is a WIP draft of TLS 1.3 and has not yet seen</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   significant security analysis.</td><td> </td><td class="right">   significant security analysis.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</td><td> </td><td class="right">   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   draft is maintained in GitHub.  Suggested changes should be submitted</td><td> </td><td class="right">   draft is maintained in GitHub.  Suggested changes should be submitted</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   as pull requests at https://github.com/tlswg/tls13-spec.</td><td> </td><td class="right">   as pull requests at https://github.com/tlswg/tls13-spec.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Instructions are on that page as well.  Editorial changes can be</td><td> </td><td class="right">   Instructions are on that page as well.  Editorial changes can be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> page 5, line 38</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> page 5, line 38</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of protocols that run on top of TLS.</td><td> </td><td class="right">   of protocols that run on top of TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.1.  Requirements Terminology</td><td> </td><td class="right">1.1.  Requirements Terminology</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td> </td><td class="right">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this</td><td> </td><td class="right">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   document are to be interpreted as described in RFC 2119 [RFC2119].</td><td> </td><td class="right">   document are to be interpreted as described in RFC 2119 [RFC2119].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.2.  Major Differences from TLS 1.2</td><td> </td><td class="right">1.2.  Major Differences from TLS 1.2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">draft-04</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   -  Modify key computations to include session hash.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   draft-03</td><td> </td><td class="right">   draft-03</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Remove GMT time.</td><td> </td><td class="right">   -  Remove GMT time.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Merge in support for ECC from RFC 4492 but without explicit</td><td> </td><td class="right">   -  Merge in support for ECC from RFC 4492 but without explicit</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      curves.</td><td> </td><td class="right">      curves.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Remove the unnecessary length field from the AD input to AEAD</td><td> </td><td class="right">   -  Remove the unnecessary length field from the AD input to AEAD</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ciphers.</td><td> </td><td class="right">      ciphers.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Rename {Client,Server}KeyExchange to {Client,Server}KeyShare</td><td> </td><td class="right">   -  Rename {Client,Server}KeyExchange to {Client,Server}KeyShare</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Add an explicit HelloRetryRequest to reject the client's</td><td> </td><td class="right">   -  Add an explicit HelloRetryRequest to reject the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">draft-02</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Increment version number.</td><td> </td><td class="right">   -  Increment version number.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Reworked handshake to provide 1-RTT mode.</td><td> </td><td class="right">   -  Reworked handshake to provide 1-RTT mode.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Remove custom DHE groups.</td><td> </td><td class="right">   -  Remove custom DHE groups.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Removed support for compression.</td><td> </td><td class="right">   -  Removed support for compression.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Removed support for static RSA and DH key exchange.</td><td> </td><td class="right">   -  Removed support for static RSA and DH key exchange.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> page 13, line 23</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> page 13, line 45</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   state (see Section 6.1).</td><td> </td><td class="right">   state (see Section 6.1).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A digitally-signed element is encoded as a struct DigitallySigned:</td><td> </td><td class="right">   A digitally-signed element is encoded as a struct DigitallySigned:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         SignatureAndHashAlgorithm algorithm;</td><td> </td><td class="right">         SignatureAndHashAlgorithm algorithm;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         opaque signature&lt;0..2^16-1&gt;;</td><td> </td><td class="right">         opaque signature&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } DigitallySigned;</td><td> </td><td class="right">      } DigitallySigned;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The algorithm field specifies the algorithm used (see</td><td> </td><td class="right">   The algorithm field specifies the algorithm used (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Section 7.<span class="delete">4</span>.2.5.1 for the definition of this field).  Note that the</td><td> </td><td class="rblock">   Section 7.<span class="insert">3</span>.2.5.1 for the definition of this field).  Note that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   algorithm field was introduced in TLS 1.2, and is not in earlier</td><td> </td><td class="right">   algorithm field was introduced in TLS 1.2, and is not in earlier</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   versions.  The signature is a digital signature using those</td><td> </td><td class="right">   versions.  The signature is a digital signature using those</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   algorithms over the contents of the element.  The contents themselves</td><td> </td><td class="right">   algorithms over the contents of the element.  The contents themselves</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   do not appear on the wire but are simply calculated.  The length of</td><td> </td><td class="right">   do not appear on the wire but are simply calculated.  The length of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the signature is specified by the signing algorithm and key.</td><td> </td><td class="right">   the signature is specified by the signing algorithm and key.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In RSA signing, the opaque vector contains the signature generated</td><td> </td><td class="right">   In RSA signing, the opaque vector contains the signature generated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   using the RSASSA-PKCS1-v1_5 signature scheme defined in [RFC3447].</td><td> </td><td class="right">   using the RSASSA-PKCS1-v1_5 signature scheme defined in [RFC3447].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   As discussed in [RFC3447], the DigestInfo MUST be DER-encoded [X680]</td><td> </td><td class="right">   As discussed in [RFC3447], the DigestInfo MUST be DER-encoded [X680]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [X690].  For hash algorithms without parameters (which includes SHA-</td><td> </td><td class="right">   [X690].  For hash algorithms without parameters (which includes SHA-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> page 17, line 10</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> page 17, line 30</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note in particular that type and length of a record are not protected</td><td> </td><td class="right">   Note in particular that type and length of a record are not protected</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   by encryption.  If this information is itself sensitive, application</td><td> </td><td class="right">   by encryption.  If this information is itself sensitive, application</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   designers may wish to take steps (padding, cover traffic) to minimize</td><td> </td><td class="right">   designers may wish to take steps (padding, cover traffic) to minimize</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   information leakage.</td><td> </td><td class="right">   information leakage.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">6.1.  Connection States</td><td> </td><td class="right">6.1.  Connection States</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A TLS connection state is the operating environment of the TLS Record</td><td> </td><td class="right">   A TLS connection state is the operating environment of the TLS Record</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Protocol.  It specifies a record protection algorithm and its</td><td> </td><td class="right">   Protocol.  It specifies a record protection algorithm and its</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   parameters as well as the record protection keys and IVs for the</td><td> </td><td class="right">   parameters as well as the record protection keys and IVs for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   connection in both the read and the write directions.  <span class="delete">Logically,</span></td><td> </td><td class="rblock">   connection in both the read and the write directions.  The security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   there are always four connection states outstanding: the current read</span></td><td> </td><td class="rblock">   parameters <span class="insert">are</span> be set by the TLS Handshake Protocol, which <span class="insert">also</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   and write states, and the pending read and write states.  All records</span></td><td> </td><td class="rblock"><span class="insert">   determines when new cryptographic keys are installed</span> and <span class="insert">used for</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   are processed under the current read and write states.</span>  The security</td><td> </td><td class="rblock"><span class="insert">   record protection.</span>  The initial current state always specifies that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   parameters <span class="delete">for the pending states can</span> be set by the TLS Handshake</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Protocol, <span class="delete">and the ChangeCipherSpec can selectively make either of the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   pending states current, in</span> which <span class="delete">case the appropriate current state</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   is disposed of</span> and <span class="delete">replaced with the pending state; the pending state</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   is then reinitialized to an empty state.  It is illegal to make a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   state that has not been initialized with security parameters a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   current state.</span>  The initial current state always specifies that</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   records are not protected.</td><td> </td><td class="right">   records are not protected.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The security parameters for a TLS Connection read and write state are</td><td> </td><td class="right">   The security parameters for a TLS Connection read and write state are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   set by providing the following values:</td><td> </td><td class="right">   set by providing the following values:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection end</td><td> </td><td class="right">   connection end</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Whether this entity is considered the "client" or the "server" in</td><td> </td><td class="right">      Whether this entity is considered the "client" or the "server" in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      this connection.</td><td> </td><td class="right">      this connection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   PRF algorithm</td><td> </td><td class="right">   PRF algorithm</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> page 17, line 44</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> page 18, line 9</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   record protection algorithm</td><td> </td><td class="right">   record protection algorithm</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The algorithm to be used for record protection.  This algorithm</td><td> </td><td class="right">      The algorithm to be used for record protection.  This algorithm</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      must be of the AEAD type and thus provides integrity and</td><td> </td><td class="right">      must be of the AEAD type and thus provides integrity and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      confidentiality as a single primitive.  It is possible to have</td><td> </td><td class="right">      confidentiality as a single primitive.  It is possible to have</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      AEAD algorithms which do not provide any confidentiality and</td><td> </td><td class="right">      AEAD algorithms which do not provide any confidentiality and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Section 6.2.2 defines a special NULL_NULL AEAD algorithm for use</td><td> </td><td class="right">      Section 6.2.2 defines a special NULL_NULL AEAD algorithm for use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      in the initial handshake).  This specification includes the key</td><td> </td><td class="right">      in the initial handshake).  This specification includes the key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      size of this algorithm and the lengths of explicit and implicit</td><td> </td><td class="right">      size of this algorithm and the lengths of explicit and implicit</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      initialization vectors (or nonces).</td><td> </td><td class="right">      initialization vectors (or nonces).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">handshake master secret</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      A 48-byte secret shared between the two peers in the connection</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      and used to generate keys for protecting the handshake.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   master secret</td><td> </td><td class="right">   master secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      A 48-byte secret shared between the two peers in the <span class="delete">connection.</span></td><td> </td><td class="rblock">      A 48-byte secret shared between the two peers in the <span class="insert">connection</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      and used to generate keys for protecting application data.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client random</td><td> </td><td class="right">   client random</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      A 32-byte value provided by the client.</td><td> </td><td class="right">      A 32-byte value provided by the client.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server random</td><td> </td><td class="right">   server random</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      A 32-byte value provided by the server.</td><td> </td><td class="right">      A 32-byte value provided by the server.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   These parameters are defined in the presentation language as:</td><td> </td><td class="right">   These parameters are defined in the presentation language as:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum { server, client } ConnectionEnd;</td><td> </td><td class="right">      enum { server, client } ConnectionEnd;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> page 18, line 24</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> page 18, line 42</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         RecordProtAlgorithm may be added to. */</td><td> </td><td class="right">         RecordProtAlgorithm may be added to. */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ConnectionEnd          entity;</td><td> </td><td class="right">          ConnectionEnd          entity;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          PRFAlgorithm           prf_algorithm;</td><td> </td><td class="right">          PRFAlgorithm           prf_algorithm;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          RecordProtAlgorithm    record_prot_algorithm;</td><td> </td><td class="right">          RecordProtAlgorithm    record_prot_algorithm;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint8                  enc_key_length;</td><td> </td><td class="right">          uint8                  enc_key_length;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint8                  block_length;</td><td> </td><td class="right">          uint8                  block_length;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint8                  fixed_iv_length;</td><td> </td><td class="right">          uint8                  fixed_iv_length;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint8                  record_iv_length;</td><td> </td><td class="right">          uint8                  record_iv_length;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          opaque                 hs_master_secret[48];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque                 master_secret[48];</td><td> </td><td class="right">          opaque                 master_secret[48];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque                 client_random[32];</td><td> </td><td class="right">          opaque                 client_random[32];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque                 server_random[32];</td><td> </td><td class="right">          opaque                 server_random[32];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } SecurityParameters;</td><td> </td><td class="right">      } SecurityParameters;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The record layer will use the security parameters to generate the</td><td> </td><td class="right">   The record layer will use the security parameters to generate the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   following four items (some of which are not required by all ciphers,</td><td> </td><td class="right">   following four items (some of which are not required by all ciphers,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and are thus empty):</td><td> </td><td class="right">   and are thus empty):</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client write key</td><td> </td><td class="right">      client write key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> page 19, line 34</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> page 20, line 11</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   multiple client messages of the same ContentType MAY be coalesced</td><td> </td><td class="right">   multiple client messages of the same ContentType MAY be coalesced</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   into a single TLSPlaintext record, or a single message MAY be</td><td> </td><td class="right">   into a single TLSPlaintext record, or a single message MAY be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   fragmented across several records).</td><td> </td><td class="right">   fragmented across several records).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint8 major;</td><td> </td><td class="right">          uint8 major;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint8 minor;</td><td> </td><td class="right">          uint8 minor;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } ProtocolVersion;</td><td> </td><td class="right">      } ProtocolVersion;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          <span class="delete">change_cipher_spec</span>(20), alert(21), handshake(22),</td><td> </td><td class="rblock">          <span class="insert">reserved</span>(20), alert(21), handshake(22),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          application_data(23), (255)</td><td> </td><td class="right">          application_data(23), (255)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } ContentType;</td><td> </td><td class="right">      } ContentType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ContentType type;</td><td> </td><td class="right">          ContentType type;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ProtocolVersion version;</td><td> </td><td class="right">          ProtocolVersion version;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint16 length;</td><td> </td><td class="right">          uint16 length;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque fragment[TLSPlaintext.length];</td><td> </td><td class="right">          opaque fragment[TLSPlaintext.length];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } TLSPlaintext;</td><td> </td><td class="right">      } TLSPlaintext;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> page 20, line 19</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> page 20, line 44</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   length</td><td> </td><td class="right">   length</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The length (in bytes) of the following TLSPlaintext.fragment.  The</td><td> </td><td class="right">      The length (in bytes) of the following TLSPlaintext.fragment.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      length MUST NOT exceed 2^14.</td><td> </td><td class="right">      length MUST NOT exceed 2^14.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   fragment</td><td> </td><td class="right">   fragment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The application data.  This data is transparent and treated as an</td><td> </td><td class="right">      The application data.  This data is transparent and treated as an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      independent block to be dealt with by the higher-level protocol</td><td> </td><td class="right">      independent block to be dealt with by the higher-level protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      specified by the type field.</td><td> </td><td class="right">      specified by the type field.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Implementations MUST NOT send zero-length fragments of <span class="delete">Handshake,</span></td><td> </td><td class="rblock">   Implementations MUST NOT send zero-length fragments of <span class="insert">Handshake</span> or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Alert,</span> or <span class="delete">ChangeCipherSpec content</span> types.  Zero-length fragments of</td><td> </td><td class="rblock">   <span class="insert">Alert</span> types.  Zero-length fragments of Application data MAY be sent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Application data MAY be sent as they are potentially useful as a</td><td> </td><td class="rblock">   as they are potentially useful as a traffic analysis countermeasure.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   traffic analysis countermeasure.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: Data of different TLS record layer content types MAY be</td><td> </td><td class="right">   Note: Data of different TLS record layer content types MAY be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   interleaved.  Application data is generally of lower precedence for</td><td> </td><td class="right">   interleaved.  Application data is generally of lower precedence for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   transmission than other content types.  However, records MUST be</td><td> </td><td class="right">   transmission than other content types.  However, records MUST be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   delivered to the network in the same order as they are protected by</td><td> </td><td class="right">   delivered to the network in the same order as they are protected by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the record layer.  Recipients MUST receive and process interleaved</td><td> </td><td class="right">   the record layer.  Recipients MUST receive and process interleaved</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   application layer traffic during handshakes subsequent to the first</td><td> </td><td class="right">   application layer traffic during handshakes subsequent to the first</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   one on a connection.</td><td> </td><td class="right">   one on a connection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">6.2.2.  Record Payload Protection</td><td> </td><td class="right">6.2.2.  Record Payload Protection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> page 22, line 50</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> page 23, line 21</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   requires an algorithm to generate keys required by the current</td><td> </td><td class="right">   requires an algorithm to generate keys required by the current</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection state (see Appendix A.6) from the security parameters</td><td> </td><td class="right">   connection state (see Appendix A.6) from the security parameters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provided by the handshake protocol.</td><td> </td><td class="right">   provided by the handshake protocol.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The master secret is expanded into a sequence of secure bytes, which</td><td> </td><td class="right">   The master secret is expanded into a sequence of secure bytes, which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is then split to a client write encryption key and a server write</td><td> </td><td class="right">   is then split to a client write encryption key and a server write</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   encryption key.  Each of these is generated from the byte sequence in</td><td> </td><td class="right">   encryption key.  Each of these is generated from the byte sequence in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that order.  Unused values are empty.  Some ciphers may additionally</td><td> </td><td class="right">   that order.  Unused values are empty.  Some ciphers may additionally</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   require a client write IV and a server write IV.</td><td> </td><td class="right">   require a client write IV and a server write IV.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   When keys are generated, the master secret is used as an entropy</td><td> </td><td class="rblock">   When keys are generated, the <span class="insert">then current</span> master secret <span class="insert">(MS)</span> is used</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   source.</td><td> </td><td class="rblock">   as an entropy source.  <span class="insert">For handshake records, this means the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   hs_master_secret.  For application data, records, this means the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   regular master_secret.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   To generate the key material, compute</td><td> </td><td class="right">   To generate the key material, compute</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      key_block = PRF(<span class="delete">SecurityParameters.master_secret</span>,</td><td> </td><td class="rblock">      key_block = PRF(<span class="insert">MS</span>,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                      "key expansion",</td><td> </td><td class="right">                      "key expansion",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                      SecurityParameters.server_random +</td><td> </td><td class="right">                      SecurityParameters.server_random +</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                      SecurityParameters.client_random);</td><td> </td><td class="right">                      SecurityParameters.client_random);</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">until</span> enough <span class="delete">output has been generated.  Then,</span> the <span class="delete">key_block</span> is</td><td> </td><td class="rblock">   <span class="insert">where MS is the relevant master secret.  The PRF is computed</span> enough</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   partitioned as follows:</td><td> </td><td class="rblock">   <span class="insert">times to generate the necessary amount of data for</span> the <span class="insert">key_block,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   which</span> is <span class="insert">then</span> partitioned as follows:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client_write_key[SecurityParameters.enc_key_length]</td><td> </td><td class="right">      client_write_key[SecurityParameters.enc_key_length]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      server_write_key[SecurityParameters.enc_key_length]</td><td> </td><td class="right">      server_write_key[SecurityParameters.enc_key_length]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client_write_IV[SecurityParameters.fixed_iv_length]</td><td> </td><td class="right">      client_write_IV[SecurityParameters.fixed_iv_length]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      server_write_IV[SecurityParameters.fixed_iv_length]</td><td> </td><td class="right">      server_write_IV[SecurityParameters.fixed_iv_length]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Currently, the client_write_IV and server_write_IV are only generated</td><td> </td><td class="right">   Currently, the client_write_IV and server_write_IV are only generated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for implicit nonce techniques as described in Section 3.2.1 of</td><td> </td><td class="right">   for implicit nonce techniques as described in Section 3.2.1 of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC5116].</td><td> </td><td class="right">   [RFC5116].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l10" /><small>skipping to change at</small><em> page 23, line 48</em></th><th> </th><th><a name="part-r10" /><small>skipping to change at</small><em> page 24, line 22</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   peer certificate</td><td> </td><td class="right">   peer certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      X509v3 [RFC3280] certificate of the peer.  This element of the</td><td> </td><td class="right">      X509v3 [RFC3280] certificate of the peer.  This element of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      state may be null.</td><td> </td><td class="right">      state may be null.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cipher spec</td><td> </td><td class="right">   cipher spec</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Specifies the authentication and key establishment algorithms, the</td><td> </td><td class="right">      Specifies the authentication and key establishment algorithms, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      pseudorandom function (PRF) used to generate keying material, and</td><td> </td><td class="right">      pseudorandom function (PRF) used to generate keying material, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the record protection algorithm (See Appendix A.6 for formal</td><td> </td><td class="right">      the record protection algorithm (See Appendix A.6 for formal</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      definition.)</td><td> </td><td class="right">      definition.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   master secret</td><td> </td><td class="rblock">   <span class="insert">resumption </span>master secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      48-byte secret shared between the client and server.</td><td> </td><td class="right">      48-byte secret shared between the client and server.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is resumable</td><td> </td><td class="right">   is resumable</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      A flag indicating whether the session can be used to initiate new</td><td> </td><td class="right">      A flag indicating whether the session can be used to initiate new</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      connections.</td><td> </td><td class="right">      connections.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   These items are then used to create security parameters for use by</td><td> </td><td class="right">   These items are then used to create security parameters for use by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the record layer when protecting application data.  Many connections</td><td> </td><td class="right">   the record layer when protecting application data.  Many connections</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   can be instantiated using the same session through the resumption</td><td> </td><td class="right">   can be instantiated using the same session through the resumption</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   feature of the TLS Handshake Protocol.</td><td> </td><td class="right">   feature of the TLS Handshake Protocol.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.1.  <span class="delete">Change Cipher Spec Protocol</span></td><td> </td><td class="rblock">7.1.  Alert Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   The change cipher spec protocol exists to signal transitions in</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   ciphering strategies.  The protocol consists of a single message,</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   which is encrypted under the current (not the pending) connection</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   state.  The message consists of a single byte of value 1.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      struct {</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">          enum { change_cipher_spec(1), (255) } type;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      } ChangeCipherSpec;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   The ChangeCipherSpec message is sent by both the client and the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   server to notify the receiving party that subsequent records will be</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   protected under the newly negotiated CipherSpec and keys.  Reception</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   of this message causes the receiver to instruct the record layer to</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   immediately copy the read pending state into the read current state.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Immediately after sending this message, the sender MUST instruct the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   record layer to make the write pending state the write current state.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   (See Section 6.1.)  The ChangeCipherSpec message is sent during the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   handshake after the security parameters have been agreed upon, but</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   before the first message protected with a new CipherSpec is sent.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Note: If a rehandshake occurs while data is flowing on a connection,</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   the communicating parties may continue to send data using the old</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   CipherSpec.  However, once the ChangeCipherSpec has been sent, the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   new CipherSpec MUST be used.  The first side to send the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   ChangeCipherSpec does not know that the other side has finished</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   computing the new keying material (e.g., if it has to perform a time-</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   consuming public key operation).  Thus, a small window of time,</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   during which the recipient must buffer the data, MAY exist.  In</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   practice, with modern machines this interval is likely to be fairly</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   short.  [[TODO: This text seems confusing.]]</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">7.2.</span>  Alert Protocol</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   One of the content types supported by the TLS record layer is the</td><td> </td><td class="right">   One of the content types supported by the TLS record layer is the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   alert type.  Alert messages convey the severity of the message</td><td> </td><td class="right">   alert type.  Alert messages convey the severity of the message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (warning or fatal) and a description of the alert.  Alert messages</td><td> </td><td class="right">   (warning or fatal) and a description of the alert.  Alert messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with a level of fatal result in the immediate termination of the</td><td> </td><td class="right">   with a level of fatal result in the immediate termination of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection.  In this case, other connections corresponding to the</td><td> </td><td class="right">   connection.  In this case, other connections corresponding to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   session may continue, but the session identifier MUST be invalidated,</td><td> </td><td class="right">   session may continue, but the session identifier MUST be invalidated,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   preventing the failed session from being used to establish new</td><td> </td><td class="right">   preventing the failed session from being used to establish new</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connections.  Like other messages, alert messages are encrypted as</td><td> </td><td class="right">   connections.  Like other messages, alert messages are encrypted as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   specified by the current connection state.</td><td> </td><td class="right">   specified by the current connection state.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l11" /><small>skipping to change at</small><em> page 25, line 45</em></th><th> </th><th><a name="part-r11" /><small>skipping to change at</small><em> page 25, line 41</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          no_renegotiation(100),</td><td> </td><td class="right">          no_renegotiation(100),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          unsupported_extension(110),</td><td> </td><td class="right">          unsupported_extension(110),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          (255)</td><td> </td><td class="right">          (255)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } AlertDescription;</td><td> </td><td class="right">      } AlertDescription;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          AlertLevel level;</td><td> </td><td class="right">          AlertLevel level;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          AlertDescription description;</td><td> </td><td class="right">          AlertDescription description;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } Alert;</td><td> </td><td class="right">      } Alert;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">2</span>.1.  Closure Alerts</td><td> </td><td class="rblock">7.<span class="insert">1</span>.1.  Closure Alerts</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The client and the server must share knowledge that the connection is</td><td> </td><td class="right">   The client and the server must share knowledge that the connection is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ending in order to avoid a truncation attack.  Either party may</td><td> </td><td class="right">   ending in order to avoid a truncation attack.  Either party may</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   initiate the exchange of closing messages.</td><td> </td><td class="right">   initiate the exchange of closing messages.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   close_notify</td><td> </td><td class="right">   close_notify</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message notifies the recipient that the sender will not send</td><td> </td><td class="right">      This message notifies the recipient that the sender will not send</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      any more messages on this connection.  Note that as of TLS 1.1,</td><td> </td><td class="right">      any more messages on this connection.  Note that as of TLS 1.1,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      failure to properly close a connection no longer requires that a</td><td> </td><td class="right">      failure to properly close a connection no longer requires that a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      session not be resumed.  This is a change from TLS 1.0 to conform</td><td> </td><td class="right">      session not be resumed.  This is a change from TLS 1.0 to conform</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l12" /><small>skipping to change at</small><em> page 26, line 36</em></th><th> </th><th><a name="part-r12" /><small>skipping to change at</small><em> page 26, line 31</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   transfer any additional data, but will only close the underlying</td><td> </td><td class="right">   transfer any additional data, but will only close the underlying</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   transport connection, then the implementation MAY choose to close the</td><td> </td><td class="right">   transport connection, then the implementation MAY choose to close the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   transport without waiting for the responding close_notify.  No part</td><td> </td><td class="right">   transport without waiting for the responding close_notify.  No part</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of this standard should be taken to dictate the manner in which a</td><td> </td><td class="right">   of this standard should be taken to dictate the manner in which a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   usage profile for TLS manages its data transport, including when</td><td> </td><td class="right">   usage profile for TLS manages its data transport, including when</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connections are opened or closed.</td><td> </td><td class="right">   connections are opened or closed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: It is assumed that closing a connection reliably delivers</td><td> </td><td class="right">   Note: It is assumed that closing a connection reliably delivers</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   pending data before destroying the transport.</td><td> </td><td class="right">   pending data before destroying the transport.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">2</span>.2.  Error Alerts</td><td> </td><td class="rblock">7.<span class="insert">1</span>.2.  Error Alerts</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Error handling in the TLS Handshake protocol is very simple.  When an</td><td> </td><td class="right">   Error handling in the TLS Handshake protocol is very simple.  When an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   error is detected, the detecting party sends a message to the other</td><td> </td><td class="right">   error is detected, the detecting party sends a message to the other</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   party.  Upon transmission or receipt of a fatal alert message, both</td><td> </td><td class="right">   party.  Upon transmission or receipt of a fatal alert message, both</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   parties immediately close the connection.  Servers and clients MUST</td><td> </td><td class="right">   parties immediately close the connection.  Servers and clients MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   forget any session-identifiers, keys, and secrets associated with a</td><td> </td><td class="right">   forget any session-identifiers, keys, and secrets associated with a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   failed connection.  Thus, any connection terminated with a fatal</td><td> </td><td class="right">   failed connection.  Thus, any connection terminated with a fatal</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   alert MUST NOT be resumed.</td><td> </td><td class="right">   alert MUST NOT be resumed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Whenever an implementation encounters a condition which is defined as</td><td> </td><td class="right">   Whenever an implementation encounters a condition which is defined as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l13" /><small>skipping to change at</small><em> page 30, line 10</em></th><th> </th><th><a name="part-r13" /><small>skipping to change at</small><em> page 30, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      communicate changes to these parameters after that point.  This</td><td> </td><td class="right">      communicate changes to these parameters after that point.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message is always a warning.</td><td> </td><td class="right">      message is always a warning.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   unsupported_extension</td><td> </td><td class="right">   unsupported_extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      sent by clients that receive an extended server hello containing</td><td> </td><td class="right">      sent by clients that receive an extended server hello containing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      an extension that they did not put in the corresponding client</td><td> </td><td class="right">      an extension that they did not put in the corresponding client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      hello.  This message is always fatal.</td><td> </td><td class="right">      hello.  This message is always fatal.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   New Alert values are assigned by IANA as described in Section 12.</td><td> </td><td class="right">   New Alert values are assigned by IANA as described in Section 12.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">3</span>.  Handshake Protocol Overview</td><td> </td><td class="rblock">7.<span class="insert">2</span>.  Handshake Protocol Overview</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The cryptographic parameters of the session state are produced by the</td><td> </td><td class="right">   The cryptographic parameters of the session state are produced by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS Handshake Protocol, which operates on top of the TLS record</td><td> </td><td class="right">   TLS Handshake Protocol, which operates on top of the TLS record</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   layer.  When a TLS client and server first start communicating, they</td><td> </td><td class="right">   layer.  When a TLS client and server first start communicating, they</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   agree on a protocol version, select cryptographic algorithms,</td><td> </td><td class="right">   agree on a protocol version, select cryptographic algorithms,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   optionally authenticate each other, and use public-key encryption</td><td> </td><td class="right">   optionally authenticate each other, and use public-key encryption</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   techniques to generate shared secrets.</td><td> </td><td class="right">   techniques to generate shared secrets.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TLS Handshake Protocol involves the following steps:</td><td> </td><td class="right">   The TLS Handshake Protocol involves the following steps:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l14" /><small>skipping to change at</small><em> page 31, line 25</em></th><th> </th><th><a name="part-r14" /><small>skipping to change at</small><em> page 31, line 19</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the client has provided a ClientKeyShare with an appropriate set</td><td> </td><td class="right">   If the client has provided a ClientKeyShare with an appropriate set</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of keying material, the server responds to the ClientHello with a</td><td> </td><td class="right">   of keying material, the server responds to the ClientHello with a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerHello message.  The ServerHello contains the server's nonce</td><td> </td><td class="right">   ServerHello message.  The ServerHello contains the server's nonce</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (ServerHello.random), the server's choice of the Protocol Version,</td><td> </td><td class="right">   (ServerHello.random), the server's choice of the Protocol Version,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Session ID and Cipher Suite, and the server's response to the</td><td> </td><td class="right">   Session ID and Cipher Suite, and the server's response to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extensions the client offered.</td><td> </td><td class="right">   extensions the client offered.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The server can then generate its own keying material share and send a</td><td> </td><td class="right">   The server can then generate its own keying material share and send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerKeyShare message which contains its share of the parameters for</td><td> </td><td class="right">   ServerKeyShare message which contains its share of the parameters for</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the key agreement.  The server can now compute the shared <span class="delete">secret.</span>  At</td><td> </td><td class="rblock">   the key agreement.  The server can now compute the shared <span class="insert">secret (the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   this point, <span class="delete">a ChangeCipherSpec message is sent by the server, and</span> the</td><td> </td><td class="rblock"><span class="insert">   premaster secret).</span>  At this point, the server <span class="insert">starts encrypting all</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   server <span class="delete">copies</span> the <span class="delete">pending Cipher Spec into</span> the <span class="delete">current Cipher Spec.</span></td><td> </td><td class="rblock"><span class="insert">   remaining handshake traffic with the negotiated cipher suite using a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The remainder of the server's handshake messages will be encrypted</td><td> </td><td class="rblock"><span class="insert">   key derived from</span> the <span class="insert">premaster secret (via</span> the <span class="insert">"handshake master</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">under</span> that <span class="delete">Cipher Spec.</span></td><td> </td><td class="rblock"><span class="insert">   secret").</span>  The remainder of the server's handshake messages will be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   encrypted <span class="insert">using</span> that <span class="insert">key.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Following these messages, the server will send an EncryptedExtensions</td><td> </td><td class="right">   Following these messages, the server will send an EncryptedExtensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message which contains a response to any client's extensions which</td><td> </td><td class="right">   message which contains a response to any client's extensions which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   are not necessary to establish the Cipher Suite.  The server will</td><td> </td><td class="right">   are not necessary to establish the Cipher Suite.  The server will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   then send its certificate in a Certificate message if it is to be</td><td> </td><td class="right">   then send its certificate in a Certificate message if it is to be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   authenticated.  The server may optionally request a certificate from</td><td> </td><td class="right">   authenticated.  The server may optionally request a certificate from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the client by sending a CertificateRequest message at this point.</td><td> </td><td class="right">   the client by sending a CertificateRequest message at this point.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Finally, if the server is authenticated, it will send a</td><td> </td><td class="right">   Finally, if the server is authenticated, it will send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateVerify message which provides a signature over the entire</td><td> </td><td class="right">   CertificateVerify message which provides a signature over the entire</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake up to this point.  This serves both to authenticate the</td><td> </td><td class="right">   handshake up to this point.  This serves both to authenticate the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server and to establish the integrity of the negotiation.  Finally,</td><td> </td><td class="right">   server and to establish the integrity of the negotiation.  Finally,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the server sends a Finished message which includes an integrity check</td><td> </td><td class="right">   the server sends a Finished message which includes an integrity check</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   over the handshake keyed by the shared secret and demonstrates that</td><td> </td><td class="right">   over the handshake keyed by the shared secret and demonstrates that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the server and client have agreed upon the same keys.  [[TODO: If the</td><td> </td><td class="right">   the server and client have agreed upon the same keys.  [[TODO: If the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server is not requesting client authentication, it MAY start sending</td><td> </td><td class="right">   server is not requesting client authentication, it MAY start sending</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   application data following the Finished, though the server has no way</td><td> </td><td class="right">   application data following the Finished, though the server has no way</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of knowing who will be receiving the data.  Add this.]]</td><td> </td><td class="right">   of knowing who will be receiving the data.  Add this.]]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Once the client receives the ServerKeyShare, it can also compute the</td><td> </td><td class="right">   Once the client receives the ServerKeyShare, it can also compute the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">shared key.  At this point ChangeCipherSpec message is sent by the</span></td><td> </td><td class="rblock">   <span class="insert">premaster secret</span> and <span class="insert">decrypt</span> the <span class="insert">server's remaining handshake</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   client,</span> and the client <span class="delete">copies</span> the <span class="delete">pending Cipher Spec into the</span></td><td> </td><td class="rblock"><span class="insert">   messages.  The</span> client <span class="insert">generates its own sending keys based on the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   current Cipher Spec.  The</span> remainder of <span class="delete">the client's</span> messages <span class="delete">will be</span></td><td> </td><td class="rblock"><span class="insert">   premaster secret and will encrypt</span> the remainder of <span class="insert">its handshake</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   encrypted under this Cipher Spec.</span>  If the server has sent a</td><td> </td><td class="rblock">   messages <span class="insert">using those keys and the newly established cipher suite.</span>  If</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   CertificateRequest message, the client MUST send the Certificate</td><td> </td><td class="rblock">   the server has sent a CertificateRequest message, the client MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   message, though it may contain zero certificates.  If the client has</td><td> </td><td class="rblock">   send the Certificate message, though it may contain zero</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   sent a certificate, a <span class="delete">digitally-signed</span> CertificateVerify message is</td><td> </td><td class="rblock">   certificates.  If the client has sent a certificate, a <span class="insert">digitally-</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   sent to explicitly verify possession of the private key in the</td><td> </td><td class="rblock"><span class="insert">   signed</span> CertificateVerify message is sent to explicitly verify</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   certificate.  Finally, the client sends the Finished message.  At</td><td> </td><td class="rblock">   possession of the private key in the certificate.  Finally, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   this point, the handshake is complete, and the client and server may</td><td> </td><td class="rblock">   client sends the Finished message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   exchange application layer <span class="delete">data.  (See flow chart below.)</span></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   At this point, the handshake is complete, and the client and server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   may exchange application layer <span class="insert">data, which is protected using a new</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   set of keys derived from both the premaster secret and the handshake</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   transcript (see [I-D.ietf-tls-session-hash] for the security</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   rationale for this.)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Application data MUST NOT be sent prior to the Finished message.</td><td> </td><td class="right">   Application data MUST NOT be sent prior to the Finished message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [[TODO: can we make this clearer and more clearly match the text</td><td> </td><td class="right">   [[TODO: can we make this clearer and more clearly match the text</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   above about server-side False Start.]] Client Server</td><td> </td><td class="right">   above about server-side False Start.]] Client Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientHello</td><td> </td><td class="right">      ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientKeyShare            --------&gt;</td><td> </td><td class="right">      ClientKeyShare            --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                      ServerHello</td><td> </td><td class="right">                                                      ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   ServerKeyShare</td><td> </td><td class="right">                                                   ServerKeyShare</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               <span class="delete">[ChangeCipherSpec]</span></td><td> </td><td class="rblock">                                           <span class="insert">{EncryptedExtensions*}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                             EncryptedExtensions*</span></td><td> </td><td class="rblock"><span class="insert">                                                   {Certificate*}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                                     Certificate*</span></td><td> </td><td class="rblock"><span class="insert">                                            {CertificateRequest*}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                              CertificateRequest*</span></td><td> </td><td class="rblock"><span class="insert">                                             {CertificateVerify*}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                               CertificateVerify*</span></td><td> </td><td class="rblock">                                &lt;--------              <span class="insert">{Finished}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                &lt;--------                <span class="delete">Finished</span></td><td> </td><td class="rblock"><span class="insert">      {Certificate*}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      [ChangeCipherSpec]</span></td><td> </td><td class="rblock"><span class="insert">      {CertificateVerify*}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Certificate*</span></td><td> </td><td class="rblock"><span class="insert">      {Finished}</span>                --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      CertificateVerify*</span></td><td> </td><td class="rblock">      <span class="insert">[Application Data]</span>        &lt;-------&gt;      <span class="insert">[Application Data]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Finished</span>                  --------&gt;</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">Application Data</span>          &lt;-------&gt;        <span class="delete">Application Data</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Figure 1.  Message flow for a full handshake</td><td> </td><td class="right">               Figure 1.  Message flow for a full handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   * Indicates optional or situation-dependent messages that are not</td><td> </td><td class="right">   * Indicates optional or situation-dependent messages that are not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   always sent.</td><td> </td><td class="right">   always sent.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">Note: To help avoid pipeline stalls, ChangeCipherSpec is an</span></td><td> </td><td class="rblock">   <span class="insert">{} Indicates messages protected using keys derived from the</span> handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   independent TLS protocol content type, and is not actually a TLS</span></td><td> </td><td class="rblock">   <span class="insert">master secret.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   handshake <span class="delete">message.</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [] Indicates messages protected using keys derived from the master</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   secret.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the client has not provided an appropriate ClientKeyShare (e.g. it</td><td> </td><td class="right">   If the client has not provided an appropriate ClientKeyShare (e.g. it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   includes only DHE or ECDHE groups unacceptable or unsupported by the</td><td> </td><td class="right">   includes only DHE or ECDHE groups unacceptable or unsupported by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server), the server corrects the mismatch with a HelloRetryRequest</td><td> </td><td class="right">   server), the server corrects the mismatch with a HelloRetryRequest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and the client will need to restart the handshake with an appropriate</td><td> </td><td class="right">   and the client will need to restart the handshake with an appropriate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientKeyShare, as shown in Figure 2:</td><td> </td><td class="right">   ClientKeyShare, as shown in Figure 2:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Client                                               Server</td><td> </td><td class="right">      Client                                               Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientHello</td><td> </td><td class="right">      ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientKeyShare            --------&gt;</td><td> </td><td class="right">      ClientKeyShare            --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                &lt;--------       HelloRetryRequest</td><td> </td><td class="right">                                &lt;--------       HelloRetryRequest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientHello</td><td> </td><td class="right">      ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientKeyShare            --------&gt;</td><td> </td><td class="right">      ClientKeyShare            --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                      ServerHello</td><td> </td><td class="right">                                                      ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   ServerKeyShare</td><td> </td><td class="right">                                                   ServerKeyShare</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                               <span class="delete">[ChangeCipherSpec]</span></td><td> </td><td class="rblock">                                           <span class="insert">{EncryptedExtensions*}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                             EncryptedExtensions*</span></td><td> </td><td class="rblock"><span class="insert">                                                   {Certificate*}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                                     Certificate*</span></td><td> </td><td class="rblock"><span class="insert">                                            {CertificateRequest*}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                              CertificateRequest*</span></td><td> </td><td class="rblock"><span class="insert">                                             {CertificateVerify*}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                                               CertificateVerify*</span></td><td> </td><td class="rblock">                                &lt;--------              <span class="insert">{Finished}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                &lt;--------                <span class="delete">Finished</span></td><td> </td><td class="rblock"><span class="insert">      {Certificate*}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      [ChangeCipherSpec]</span></td><td> </td><td class="rblock"><span class="insert">      {CertificateVerify*}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Certificate*</span></td><td> </td><td class="rblock"><span class="insert">      {Finished}</span>                --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      CertificateVerify*</span></td><td> </td><td class="rblock">      <span class="insert">[Application Data]</span>        &lt;-------&gt;     <span class="insert">[Application Data]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Finished</span>                  --------&gt;</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">Application Data</span>          &lt;-------&gt;        <span class="delete">Application Data</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Figure 2.  Message flow for a full handshake with mismatched</td><td> </td><td class="right">   Figure 2.  Message flow for a full handshake with mismatched</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   parameters</td><td> </td><td class="right">   parameters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [[OPEN ISSUE: Do we restart the handshake hash?]] [[OPEN ISSUE: We</td><td> </td><td class="right">   [[OPEN ISSUE: Do we restart the handshake hash?]] [[OPEN ISSUE: We</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   need to make sure that this flow doesn't introduce downgrade issues.</td><td> </td><td class="right">   need to make sure that this flow doesn't introduce downgrade issues.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Potential options include continuing the handshake hashes (as long as</td><td> </td><td class="right">   Potential options include continuing the handshake hashes (as long as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   clients don't change their opinion of the server's capabilities with</td><td> </td><td class="right">   clients don't change their opinion of the server's capabilities with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   aborted handshakes) and requiring the client to send the same</td><td> </td><td class="right">   aborted handshakes) and requiring the client to send the same</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello (as is currently done) and then checking you get the same</td><td> </td><td class="right">   ClientHello (as is currently done) and then checking you get the same</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l15" /><small>skipping to change at</small><em> page 33, line 50</em></th><th> </th><th><a name="part-r15" /><small>skipping to change at</small><em> page 33, line 48</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When the client and server decide to resume a previous session or</td><td> </td><td class="right">   When the client and server decide to resume a previous session or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   duplicate an existing session (instead of negotiating new security</td><td> </td><td class="right">   duplicate an existing session (instead of negotiating new security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   parameters), the message flow is as follows:</td><td> </td><td class="right">   parameters), the message flow is as follows:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The client sends a ClientHello using the Session ID of the session to</td><td> </td><td class="right">   The client sends a ClientHello using the Session ID of the session to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   be resumed.  The server then checks its session cache for a match.</td><td> </td><td class="right">   be resumed.  The server then checks its session cache for a match.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If a match is found, and the server is willing to re-establish the</td><td> </td><td class="right">   If a match is found, and the server is willing to re-establish the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection under the specified session state, it will send a</td><td> </td><td class="right">   connection under the specified session state, it will send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerHello with the same Session ID value.  At this point, both</td><td> </td><td class="right">   ServerHello with the same Session ID value.  At this point, both</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   client and server MUST <span class="delete">send ChangeCipherSpec messages and</span> proceed</td><td> </td><td class="rblock">   client and server MUST proceed directly to <span class="insert">sending</span> Finished <span class="insert">messages,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   directly to Finished <span class="delete">messages.</span>  Once the re-establishment is</td><td> </td><td class="rblock"><span class="insert">   which are protected using handshake keys as described above, computed</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   complete, the client and server MAY begin to exchange application</td><td> </td><td class="rblock"><span class="insert">   from the resumption premaster secret created in the first handshake.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   layer <span class="delete">data.</span>  (See flow chart below.)  If a Session ID match is not</td><td> </td><td class="rblock">   Once the re-establishment is complete, the client and server MAY</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   found, the server generates a new session ID, and the TLS client and</td><td> </td><td class="rblock">   begin to exchange application layer <span class="insert">data, which is protected using</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   server perform a full handshake.</td><td> </td><td class="rblock"><span class="insert">   the application secrets</span> (See flow chart below.)  If a Session ID</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   match is not found, the server generates a new session ID, and the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   TLS client and server perform a full handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Client                                                Server</td><td> </td><td class="right">      Client                                                Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientHello</td><td> </td><td class="right">      ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientKeyExhange              --------&gt;</td><td> </td><td class="right">      ClientKeyExhange              --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       ServerHello</td><td> </td><td class="right">                                                       ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                <span class="delete">[ChangeCipherSpec]</span></td><td> </td><td class="rblock">                                    &lt;--------           <span class="insert">{Finished}</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                    &lt;--------             <span class="delete">Finished</span></td><td> </td><td class="rblock"><span class="insert">      {Finished}</span>                    --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      [ChangeCipherSpec]</span></td><td> </td><td class="rblock">      <span class="insert">[Application Data]</span>            &lt;-------&gt;   <span class="insert">[Application Data]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Finished</span>                      --------&gt;</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">Application Data</span>              &lt;-------&gt;     <span class="delete">Application Data</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Figure 3.  Message flow for an abbreviated handshake</td><td> </td><td class="right">          Figure 3.  Message flow for an abbreviated handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The contents and significance of each message will be presented in</td><td> </td><td class="right">   The contents and significance of each message will be presented in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   detail in the following sections.</td><td> </td><td class="right">   detail in the following sections.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.  Handshake Protocol</td><td> </td><td class="rblock">7.<span class="insert">3</span>.  Handshake Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TLS Handshake Protocol is one of the defined higher-level clients</td><td> </td><td class="right">   The TLS Handshake Protocol is one of the defined higher-level clients</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of the TLS Record Protocol.  This protocol is used to negotiate the</td><td> </td><td class="right">   of the TLS Record Protocol.  This protocol is used to negotiate the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   secure attributes of a session.  Handshake messages are supplied to</td><td> </td><td class="right">   secure attributes of a session.  Handshake messages are supplied to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the TLS record layer, where they are encapsulated within one or more</td><td> </td><td class="right">   the TLS record layer, where they are encapsulated within one or more</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLSPlaintext structures, which are processed and transmitted as</td><td> </td><td class="right">   TLSPlaintext structures, which are processed and transmitted as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   specified by the current active session state.</td><td> </td><td class="right">   specified by the current active session state.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          hello_request(0), client_hello(1), server_hello(2),</td><td> </td><td class="right">          hello_request(0), client_hello(1), server_hello(2),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l16" /><small>skipping to change at</small><em> page 35, line 40</em></th><th> </th><th><a name="part-r16" /><small>skipping to change at</small><em> page 35, line 40</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST be sent; sending handshake messages in an unexpected order</td><td> </td><td class="right">   MUST be sent; sending handshake messages in an unexpected order</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   results in a fatal error.  Unneeded handshake messages can be</td><td> </td><td class="right">   results in a fatal error.  Unneeded handshake messages can be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   omitted, however.  The one message that is not bound by these</td><td> </td><td class="right">   omitted, however.  The one message that is not bound by these</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ordering rules is the HelloRequest message, which can be sent at any</td><td> </td><td class="right">   ordering rules is the HelloRequest message, which can be sent at any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   time, but which SHOULD be ignored by the client if it arrives in the</td><td> </td><td class="right">   time, but which SHOULD be ignored by the client if it arrives in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   middle of a handshake.</td><td> </td><td class="right">   middle of a handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   New handshake message types are assigned by IANA as described in</td><td> </td><td class="right">   New handshake message types are assigned by IANA as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 12.</td><td> </td><td class="right">   Section 12.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.1.  Hello Messages</td><td> </td><td class="rblock">7.<span class="insert">3</span>.1.  Hello Messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The hello phase messages are used to exchange security enhancement</td><td> </td><td class="right">   The hello phase messages are used to exchange security enhancement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   capabilities between the client and server.  When a new session</td><td> </td><td class="right">   capabilities between the client and server.  When a new session</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   begins, the record layer's connection state AEAD algorithm is</td><td> </td><td class="right">   begins, the record layer's connection state AEAD algorithm is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   initialized to NULL_NULL.  The current connection state is used for</td><td> </td><td class="right">   initialized to NULL_NULL.  The current connection state is used for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   renegotiation messages.</td><td> </td><td class="right">   renegotiation messages.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.1.1.  Hello Request</td><td> </td><td class="rblock">7.<span class="insert">3</span>.1.1.  Hello Request</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The HelloRequest message MAY be sent by the server at any time.</td><td> </td><td class="right">      The HelloRequest message MAY be sent by the server at any time.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Meaning of this message:</td><td> </td><td class="right">   Meaning of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      HelloRequest is a simple notification that the client should begin</td><td> </td><td class="right">      HelloRequest is a simple notification that the client should begin</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the negotiation process anew.  In response, the client should send</td><td> </td><td class="right">      the negotiation process anew.  In response, the client should send</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      a ClientHello message when convenient.  This message is not</td><td> </td><td class="right">      a ClientHello message when convenient.  This message is not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l17" /><small>skipping to change at</small><em> page 36, line 37</em></th><th> </th><th><a name="part-r17" /><small>skipping to change at</small><em> page 36, line 37</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      request until the subsequent handshake negotiation is complete.</td><td> </td><td class="right">      request until the subsequent handshake negotiation is complete.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct { } HelloRequest;</td><td> </td><td class="right">      struct { } HelloRequest;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This message MUST NOT be included in the message hashes that are</td><td> </td><td class="right">   This message MUST NOT be included in the message hashes that are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   maintained throughout the handshake and used in the Finished messages</td><td> </td><td class="right">   maintained throughout the handshake and used in the Finished messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and the certificate verify message.</td><td> </td><td class="right">   and the certificate verify message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.1.2.  Client Hello</td><td> </td><td class="rblock">7.<span class="insert">3</span>.1.2.  Client Hello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      When a client first connects to a server, it is required to send</td><td> </td><td class="right">      When a client first connects to a server, it is required to send</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the ClientHello as its first message.  The client can also send a</td><td> </td><td class="right">      the ClientHello as its first message.  The client can also send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientHello in response to a HelloRequest or on its own initiative</td><td> </td><td class="right">      ClientHello in response to a HelloRequest or on its own initiative</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      in order to renegotiate the security parameters in an existing</td><td> </td><td class="right">      in order to renegotiate the security parameters in an existing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      connection.  Finally, the client will send a ClientHello when the</td><td> </td><td class="right">      connection.  Finally, the client will send a ClientHello when the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      server has responded to its ClientHello with a ServerHello that</td><td> </td><td class="right">      server has responded to its ClientHello with a ServerHello that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      selects cryptographic parameters that don't match the client's</td><td> </td><td class="right">      selects cryptographic parameters that don't match the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l18" /><small>skipping to change at</small><em> page 39, line 21</em></th><th> </th><th><a name="part-r18" /><small>skipping to change at</small><em> page 39, line 21</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      method with the code point of 0.  If a TLS 1.3 ClientHello is</td><td> </td><td class="right">      method with the code point of 0.  If a TLS 1.3 ClientHello is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      received with any other value in this field, the server MUST</td><td> </td><td class="right">      received with any other value in this field, the server MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      generate a fatal "illegal_parameter" alert.  Note that TLS 1.3</td><td> </td><td class="right">      generate a fatal "illegal_parameter" alert.  Note that TLS 1.3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      servers may receive TLS 1.2 or prior ClientHellos which contain</td><td> </td><td class="right">      servers may receive TLS 1.2 or prior ClientHellos which contain</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      other compression methods and MUST follow the procedures for the</td><td> </td><td class="right">      other compression methods and MUST follow the procedures for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      appropriate prior version of TLS.</td><td> </td><td class="right">      appropriate prior version of TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extensions</td><td> </td><td class="right">   extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Clients MAY request extended functionality from servers by sending</td><td> </td><td class="right">      Clients MAY request extended functionality from servers by sending</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      data in the extensions field.  The actual "Extension" format is</td><td> </td><td class="right">      data in the extensions field.  The actual "Extension" format is</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      defined in Section 7.<span class="delete">4</span>.2.5.</td><td> </td><td class="rblock">      defined in Section 7.<span class="insert">3</span>.2.5.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In the event that a client requests additional functionality using</td><td> </td><td class="right">   In the event that a client requests additional functionality using</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extensions, and this functionality is not supplied by the server, the</td><td> </td><td class="right">   extensions, and this functionality is not supplied by the server, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client MAY abort the handshake.  A server MUST accept ClientHello</td><td> </td><td class="right">   client MAY abort the handshake.  A server MUST accept ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   messages both with and without the extensions field, and (as for all</td><td> </td><td class="right">   messages both with and without the extensions field, and (as for all</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   other messages) it MUST check that the amount of data in the message</td><td> </td><td class="right">   other messages) it MUST check that the amount of data in the message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   precisely matches one of these formats; if not, then it MUST send a</td><td> </td><td class="right">   precisely matches one of these formats; if not, then it MUST send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   fatal "decode_error" alert.</td><td> </td><td class="right">   fatal "decode_error" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   After sending the ClientHello message, the client waits for a</td><td> </td><td class="right">   After sending the ClientHello message, the client waits for a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerHello message.  Any handshake message returned by the server,</td><td> </td><td class="right">   ServerHello message.  Any handshake message returned by the server,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   except for a HelloRequest, is treated as a fatal error.</td><td> </td><td class="right">   except for a HelloRequest, is treated as a fatal error.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.2.  Client Key Share Message</td><td> </td><td class="rblock">7.<span class="insert">3</span>.2.  Client Key Share Message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message is always sent by the client.  It MUST immediately</td><td> </td><td class="right">      This message is always sent by the client.  It MUST immediately</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      follow the ClientHello message.  In backward compatibility mode</td><td> </td><td class="right">      follow the ClientHello message.  In backward compatibility mode</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (see Section XXX) it will be included in the EarlyData extension</td><td> </td><td class="right">      (see Section XXX) it will be included in the EarlyData extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      (Section 7.<span class="delete">4</span>.2.5.4) in the ClientHello.</td><td> </td><td class="rblock">      (Section 7.<span class="insert">3</span>.2.5.4) in the ClientHello.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Meaning of this message:</td><td> </td><td class="right">   Meaning of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message contains the client's cryptographic parameters for</td><td> </td><td class="right">      This message contains the client's cryptographic parameters for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      zero or more key establishment methods.</td><td> </td><td class="right">      zero or more key establishment methods.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          NamedGroup group;</td><td> </td><td class="right">          NamedGroup group;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque key_exchange&lt;1..2^16-1&gt;;</td><td> </td><td class="right">          opaque key_exchange&lt;1..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } ClientKeyShareOffer;</td><td> </td><td class="right">      } ClientKeyShareOffer;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   group  The named group for the key share offer.  This identifies the</td><td> </td><td class="right">   group  The named group for the key share offer.  This identifies the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      specific key exchange method that the ClientKeyShareOffer</td><td> </td><td class="right">      specific key exchange method that the ClientKeyShareOffer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      describes.  Finite Field Diffie-Hellman parameters are described</td><td> </td><td class="right">      describes.  Finite Field Diffie-Hellman parameters are described</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      in Section <span class="delete">7.4.2.1;</span> Elliptic Curve Diffie-Hellman parameters are</td><td> </td><td class="rblock">      in Section <span class="insert">7.3.2.1;</span> Elliptic Curve Diffie-Hellman parameters are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      described in Section <span class="delete">7.4.2.2.</span></td><td> </td><td class="rblock">      described in Section <span class="insert">7.3.2.2.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   key_exchange  Key exchange information.  The contents of this field</td><td> </td><td class="right">   key_exchange  Key exchange information.  The contents of this field</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      are determined by the value of NamedGroup entry and its</td><td> </td><td class="right">      are determined by the value of NamedGroup entry and its</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      corresponding definition.</td><td> </td><td class="right">      corresponding definition.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ClientKeyShareOffer offers&lt;0..2^16-1&gt;;</td><td> </td><td class="right">          ClientKeyShareOffer offers&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } ClientKeyShare;</td><td> </td><td class="right">      } ClientKeyShare;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   offers</td><td> </td><td class="right">   offers</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l19" /><small>skipping to change at</small><em> page 40, line 39</em></th><th> </th><th><a name="part-r19" /><small>skipping to change at</small><em> page 40, line 39</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   instance a client might offer shares for several elliptic curves or</td><td> </td><td class="right">   instance a client might offer shares for several elliptic curves or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   multiple integer DH groups.  The shares for each ClientKeyShareOffer</td><td> </td><td class="right">   multiple integer DH groups.  The shares for each ClientKeyShareOffer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST by generated independently.  Clients MUST NOT offer multiple</td><td> </td><td class="right">   MUST by generated independently.  Clients MUST NOT offer multiple</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientKeyShareOffers for the same parameters.  It is explicitly</td><td> </td><td class="right">   ClientKeyShareOffers for the same parameters.  It is explicitly</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   permitted to send an empty ClientKeyShare message, as this is used to</td><td> </td><td class="right">   permitted to send an empty ClientKeyShare message, as this is used to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   elicit the server's parameters if the client has no useful</td><td> </td><td class="right">   elicit the server's parameters if the client has no useful</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   information.  [TODO: Recommendation about what the client offers.</td><td> </td><td class="right">   information.  [TODO: Recommendation about what the client offers.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Presumably which integer DH groups and which curves.]  [TODO: Work</td><td> </td><td class="right">   Presumably which integer DH groups and which curves.]  [TODO: Work</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   out how this interacts with PSK and SRP.]</td><td> </td><td class="right">   out how this interacts with PSK and SRP.]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.2.1.  Diffie-Hellman Parameters</td><td> </td><td class="rblock">7.<span class="insert">3</span>.2.1.  Diffie-Hellman Parameters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Diffie-Hellman parameters for both clients and servers are encoded in</td><td> </td><td class="right">   Diffie-Hellman parameters for both clients and servers are encoded in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the opaque key_exchange field of the ClientKeyShareOffer or</td><td> </td><td class="right">   the opaque key_exchange field of the ClientKeyShareOffer or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerKeyShare structures.  The opaque value contains the Diffie-</td><td> </td><td class="right">   ServerKeyShare structures.  The opaque value contains the Diffie-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Hellman public value (dh_Y = g^X mod p), encoded as a big-endian</td><td> </td><td class="right">   Hellman public value (dh_Y = g^X mod p), encoded as a big-endian</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   integer.</td><td> </td><td class="right">   integer.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      opaque dh_Y&lt;1..2^16-1&gt;;</td><td> </td><td class="right">      opaque dh_Y&lt;1..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.2.2.  ECHDE Parameters</td><td> </td><td class="rblock">7.<span class="insert">3</span>.2.2.  ECHDE Parameters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ECDHE parameters for both clients and servers are encoded in the</td><td> </td><td class="right">   ECDHE parameters for both clients and servers are encoded in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   opaque key_exchange field of the ClientKeyShareOffer or</td><td> </td><td class="right">   opaque key_exchange field of the ClientKeyShareOffer or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerKeyShare structures.  The opaque value conveys the Elliptic</td><td> </td><td class="right">   ServerKeyShare structures.  The opaque value conveys the Elliptic</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Curve Diffie-Hellman public value (ecdh_Y) represented as a byte</td><td> </td><td class="right">   Curve Diffie-Hellman public value (ecdh_Y) represented as a byte</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   string ECPoint.point, which can represent an elliptic curve point in</td><td> </td><td class="right">   string ECPoint.point, which can represent an elliptic curve point in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   uncompressed or compressed format.</td><td> </td><td class="right">   uncompressed or compressed format.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      opaque point &lt;1..2^8-1&gt;;</td><td> </td><td class="right">      opaque point &lt;1..2^8-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l20" /><small>skipping to change at</small><em> page 41, line 27</em></th><th> </th><th><a name="part-r20" /><small>skipping to change at</small><em> page 41, line 27</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This is the byte string representation of an elliptic curve point</td><td> </td><td class="right">      This is the byte string representation of an elliptic curve point</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      following the conversion routine in Section 4.3.6 of ANSI X9.62</td><td> </td><td class="right">      following the conversion routine in Section 4.3.6 of ANSI X9.62</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      {{X962}.</td><td> </td><td class="right">      {{X962}.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [[OPEN ISSUE: We will need to adjust the compressed/uncompressed</td><td> </td><td class="right">   [[OPEN ISSUE: We will need to adjust the compressed/uncompressed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   point issue if we have new curves that don't need point compression.</td><td> </td><td class="right">   point issue if we have new curves that don't need point compression.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This depends on the CFRG's recommendations.  The expectation is that</td><td> </td><td class="right">   This depends on the CFRG's recommendations.  The expectation is that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   future curves will come with defined point formats and that existing</td><td> </td><td class="right">   future curves will come with defined point formats and that existing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   curves conform to X9.62.]]</td><td> </td><td class="right">   curves conform to X9.62.]]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0040" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.2.3.  Server Hello</td><td> </td><td class="rblock">7.<span class="insert">3</span>.2.3.  Server Hello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The server will send this message in response to a ClientHello</td><td> </td><td class="right">      The server will send this message in response to a ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message when it was able to find an acceptable set of algorithms</td><td> </td><td class="right">      message when it was able to find an acceptable set of algorithms</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      and the client's ClientKeyShare message was acceptable.  If the</td><td> </td><td class="right">      and the client's ClientKeyShare message was acceptable.  If the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client proposed groups are not acceptable by the server, it will</td><td> </td><td class="right">      client proposed groups are not acceptable by the server, it will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      respond with an insufficient_security fatal alert.</td><td> </td><td class="right">      respond with an insufficient_security fatal alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l21" /><small>skipping to change at</small><em> page 42, line 46</em></th><th> </th><th><a name="part-r21" /><small>skipping to change at</small><em> page 42, line 46</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cipher_suite</td><td> </td><td class="right">   cipher_suite</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The single cipher suite selected by the server from the list in</td><td> </td><td class="right">      The single cipher suite selected by the server from the list in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientHello.cipher_suites.  For resumed sessions, this field is</td><td> </td><td class="right">      ClientHello.cipher_suites.  For resumed sessions, this field is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the value from the state of the session being resumed.</td><td> </td><td class="right">      the value from the state of the session being resumed.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extensions</td><td> </td><td class="right">   extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      A list of extensions.  Note that only extensions offered by the</td><td> </td><td class="right">      A list of extensions.  Note that only extensions offered by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client can appear in the server's list.  In TLS 1.3 as opposed to</td><td> </td><td class="right">      client can appear in the server's list.  In TLS 1.3 as opposed to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      previous versions of TLS, the server's extensions are split</td><td> </td><td class="right">      previous versions of TLS, the server's extensions are split</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0041" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      between the ServerHello and the EncryptedExtensions Section 7.<span class="delete">4</span>.4</td><td> </td><td class="rblock">      between the ServerHello and the EncryptedExtensions Section 7.<span class="insert">3</span>.4</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message.  The ServerHello MUST only include extensions which are</td><td> </td><td class="right">      message.  The ServerHello MUST only include extensions which are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      required to establish the cryptographic context.</td><td> </td><td class="right">      required to establish the cryptographic context.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0042" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.2.4.  HelloRetryRequest</td><td> </td><td class="rblock">7.<span class="insert">3</span>.2.4.  HelloRetryRequest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The server will send this message in response to a ClientHello</td><td> </td><td class="right">      The server will send this message in response to a ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message when it was able to find an acceptable set of algorithms</td><td> </td><td class="right">      message when it was able to find an acceptable set of algorithms</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      but the client's ClientKeyShare message did not contain an</td><td> </td><td class="right">      but the client's ClientKeyShare message did not contain an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      acceptable offer.  If it cannot find such a match, it will respond</td><td> </td><td class="right">      acceptable offer.  If it cannot find such a match, it will respond</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      with a handshake failure alert.</td><td> </td><td class="right">      with a handshake failure alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l22" /><small>skipping to change at</small><em> page 43, line 45</em></th><th> </th><th><a name="part-r22" /><small>skipping to change at</small><em> page 43, line 45</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello/ClientKeyShare pair to the server.  The ClientKeyShare</td><td> </td><td class="right">   ClientHello/ClientKeyShare pair to the server.  The ClientKeyShare</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST contain both the groups in the original ClientKeyShare as well</td><td> </td><td class="right">   MUST contain both the groups in the original ClientKeyShare as well</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   as a ClientKeyShareOffer consistent with the "selected_group" field.</td><td> </td><td class="right">   as a ClientKeyShareOffer consistent with the "selected_group" field.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   I.e., it MUST be a superset of the previous ClientKeyShareOffer.</td><td> </td><td class="right">   I.e., it MUST be a superset of the previous ClientKeyShareOffer.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Upon re-sending the ClientHello/ClientKeyShare and receiving the</td><td> </td><td class="right">   Upon re-sending the ClientHello/ClientKeyShare and receiving the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server's ServerHello/ServerKeyShare, the client MUST verify that the</td><td> </td><td class="right">   server's ServerHello/ServerKeyShare, the client MUST verify that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   selected ciphersuite and NamedGroup match that supplied in the</td><td> </td><td class="right">   selected ciphersuite and NamedGroup match that supplied in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   HelloRetryRequest.</td><td> </td><td class="right">   HelloRetryRequest.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0043" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.2.5.  Hello Extensions</td><td> </td><td class="rblock">7.<span class="insert">3</span>.2.5.  Hello Extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The extension format is:</td><td> </td><td class="right">   The extension format is:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ExtensionType extension_type;</td><td> </td><td class="right">          ExtensionType extension_type;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque extension_data&lt;0..2^16-1&gt;;</td><td> </td><td class="right">          opaque extension_data&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } Extension;</td><td> </td><td class="right">      } Extension;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          signature_algorithms(13), early_data(TBD), (65535)</td><td> </td><td class="right">          signature_algorithms(13), early_data(TBD), (65535)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l23" /><small>skipping to change at</small><em> page 45, line 43</em></th><th> </th><th><a name="part-r23" /><small>skipping to change at</small><em> page 45, line 43</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  It would be technically possible to use extensions to change major</td><td> </td><td class="right">   -  It would be technically possible to use extensions to change major</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      aspects of the design of TLS; for example the design of cipher</td><td> </td><td class="right">      aspects of the design of TLS; for example the design of cipher</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      suite negotiation.  This is not recommended; it would be more</td><td> </td><td class="right">      suite negotiation.  This is not recommended; it would be more</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      appropriate to define a new version of TLS -- particularly since</td><td> </td><td class="right">      appropriate to define a new version of TLS -- particularly since</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the TLS handshake algorithms have specific protection against</td><td> </td><td class="right">      the TLS handshake algorithms have specific protection against</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      version rollback attacks based on the version number, and the</td><td> </td><td class="right">      version rollback attacks based on the version number, and the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      possibility of version rollback should be a significant</td><td> </td><td class="right">      possibility of version rollback should be a significant</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      consideration in any major design change.</td><td> </td><td class="right">      consideration in any major design change.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0044" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.2.5.1.  Signature Algorithms</td><td> </td><td class="rblock">7.<span class="insert">3</span>.2.5.1.  Signature Algorithms</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The client uses the "signature_algorithms" extension to indicate to</td><td> </td><td class="right">   The client uses the "signature_algorithms" extension to indicate to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the server which signature/hash algorithm pairs may be used in</td><td> </td><td class="right">   the server which signature/hash algorithm pairs may be used in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   digital signatures.  The "extension_data" field of this extension</td><td> </td><td class="right">   digital signatures.  The "extension_data" field of this extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   contains a "supported_signature_algorithms" value.</td><td> </td><td class="right">   contains a "supported_signature_algorithms" value.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          none(0), md5(1), sha1(2), sha224(3), sha256(4), sha384(5),</td><td> </td><td class="right">          none(0), md5(1), sha1(2), sha224(3), sha256(4), sha384(5),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          sha512(6), (255)</td><td> </td><td class="right">          sha512(6), (255)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } HashAlgorithm;</td><td> </td><td class="right">      } HashAlgorithm;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l24" /><small>skipping to change at</small><em> page 46, line 41</em></th><th> </th><th><a name="part-r24" /><small>skipping to change at</small><em> page 46, line 41</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      values indicate support for unhashed data, MD5 [RFC1321], SHA-1,</td><td> </td><td class="right">      values indicate support for unhashed data, MD5 [RFC1321], SHA-1,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      SHA-224, SHA-256, SHA-384, and SHA-512 [SHS], respectively.  The</td><td> </td><td class="right">      SHA-224, SHA-256, SHA-384, and SHA-512 [SHS], respectively.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "none" value is provided for future extensibility, in case of a</td><td> </td><td class="right">      "none" value is provided for future extensibility, in case of a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      signature algorithm which does not require hashing before signing.</td><td> </td><td class="right">      signature algorithm which does not require hashing before signing.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   signature</td><td> </td><td class="right">   signature</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This field indicates the signature algorithm that may be used.</td><td> </td><td class="right">      This field indicates the signature algorithm that may be used.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The values indicate anonymous signatures, RSASSA-PKCS1-v1_5</td><td> </td><td class="right">      The values indicate anonymous signatures, RSASSA-PKCS1-v1_5</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      [RFC3447] and DSA [DSS], and ECDSA [ECDSA], respectively.  The</td><td> </td><td class="right">      [RFC3447] and DSA [DSS], and ECDSA [ECDSA], respectively.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      "anonymous" value is meaningless in this context but used in</td><td> </td><td class="right">      "anonymous" value is meaningless in this context but used in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0045" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Section 7.<span class="delete">4</span>.3.  It MUST NOT appear in this extension.</td><td> </td><td class="rblock">      Section 7.<span class="insert">3</span>.3.  It MUST NOT appear in this extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The semantics of this extension are somewhat complicated because the</td><td> </td><td class="right">   The semantics of this extension are somewhat complicated because the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cipher suite indicates permissible signature algorithms but not hash</td><td> </td><td class="right">   cipher suite indicates permissible signature algorithms but not hash</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0046" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   algorithms.  Section 7.<span class="delete">4.5 and Section 7.4</span>.3 describe the appropriate</td><td> </td><td class="rblock">   algorithms.  Section 7.<span class="insert">3.5 and Section 7.3</span>.3 describe the appropriate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   rules.</td><td> </td><td class="right">   rules.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the client supports only the default hash and signature algorithms</td><td> </td><td class="right">   If the client supports only the default hash and signature algorithms</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (listed in this section), it MAY omit the signature_algorithms</td><td> </td><td class="right">   (listed in this section), it MAY omit the signature_algorithms</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension.  If the client does not support the default algorithms, or</td><td> </td><td class="right">   extension.  If the client does not support the default algorithms, or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   supports other hash and signature algorithms (and it is willing to</td><td> </td><td class="right">   supports other hash and signature algorithms (and it is willing to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   use them for verifying messages sent by the server, i.e., server</td><td> </td><td class="right">   use them for verifying messages sent by the server, i.e., server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificates and server key share), it MUST send the</td><td> </td><td class="right">   certificates and server key share), it MUST send the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   signature_algorithms extension, listing the algorithms it is willing</td><td> </td><td class="right">   signature_algorithms extension, listing the algorithms it is willing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to accept.</td><td> </td><td class="right">   to accept.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l25" /><small>skipping to change at</small><em> page 47, line 36</em></th><th> </th><th><a name="part-r25" /><small>skipping to change at</small><em> page 47, line 36</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   However, even if clients do offer it, the rules specified in [TLSEXT]</td><td> </td><td class="right">   However, even if clients do offer it, the rules specified in [TLSEXT]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   require servers to ignore extensions they do not understand.</td><td> </td><td class="right">   require servers to ignore extensions they do not understand.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Servers MUST NOT send this extension.  TLS servers MUST support</td><td> </td><td class="right">   Servers MUST NOT send this extension.  TLS servers MUST support</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   receiving this extension.</td><td> </td><td class="right">   receiving this extension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When performing session resumption, this extension is not included in</td><td> </td><td class="right">   When performing session resumption, this extension is not included in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Server Hello, and the server ignores the extension in Client Hello</td><td> </td><td class="right">   Server Hello, and the server ignores the extension in Client Hello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (if present).</td><td> </td><td class="right">   (if present).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0047" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.2.5.2.  Negotiated Groups</td><td> </td><td class="rblock">7.<span class="insert">3</span>.2.5.2.  Negotiated Groups</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When sent by the client, the "supported_groups" extension indicates</td><td> </td><td class="right">   When sent by the client, the "supported_groups" extension indicates</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the named groups which the client supports, ordered from most</td><td> </td><td class="right">   the named groups which the client supports, ordered from most</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   preferred to least preferred.</td><td> </td><td class="right">   preferred to least preferred.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: In versions of TLS prior to TLS 1.3, this extension was named</td><td> </td><td class="right">   Note: In versions of TLS prior to TLS 1.3, this extension was named</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "elliptic curves" and only contained elliptic curve groups.  See</td><td> </td><td class="right">   "elliptic curves" and only contained elliptic curve groups.  See</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC4492] and [I-D.ietf-tls-negotiated-ff-dhe].</td><td> </td><td class="right">   [RFC4492] and [I-D.ietf-tls-negotiated-ff-dhe].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The "extension_data" field of this extension SHALL contain a</td><td> </td><td class="right">   The "extension_data" field of this extension SHALL contain a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l26" /><small>skipping to change at</small><em> page 49, line 21</em></th><th> </th><th><a name="part-r26" /><small>skipping to change at</small><em> page 49, line 21</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   across all cipher suites, then the server MUST generate a fatal</td><td> </td><td class="right">   across all cipher suites, then the server MUST generate a fatal</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "handshake_failure" alert.</td><td> </td><td class="right">   "handshake_failure" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   NOTE: A server participating in an ECDHE-ECDSA key exchange may use</td><td> </td><td class="right">   NOTE: A server participating in an ECDHE-ECDSA key exchange may use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   different curves for (i) the ECDSA key in its certificate, and (ii)</td><td> </td><td class="right">   different curves for (i) the ECDSA key in its certificate, and (ii)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the ephemeral ECDH key in the ServerKeyExchange message.  The server</td><td> </td><td class="right">   the ephemeral ECDH key in the ServerKeyExchange message.  The server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   must consider the supported groups in both cases.</td><td> </td><td class="right">   must consider the supported groups in both cases.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [[TODO: IANA Considerations.]]</td><td> </td><td class="right">   [[TODO: IANA Considerations.]]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0048" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.2.5.3.  Supported Point Formats Extension</td><td> </td><td class="rblock">7.<span class="insert">3</span>.2.5.3.  Supported Point Formats Extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [[OPEN ISSUE: Can we simply mandate support for compressed points?</td><td> </td><td class="right">   [[OPEN ISSUE: Can we simply mandate support for compressed points?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If so, we can omit this extension entirely.</td><td> </td><td class="right">   If so, we can omit this extension entirely.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   https://github.com/tlswg/tls13-spec/issues/80.]]</td><td> </td><td class="right">   https://github.com/tlswg/tls13-spec/issues/80.]]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A client that proposes ECC cipher suites in its ClientHello message</td><td> </td><td class="right">   A client that proposes ECC cipher suites in its ClientHello message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   SHOULD send the Supported Point Formats Extension to indicate the</td><td> </td><td class="right">   SHOULD send the Supported Point Formats Extension to indicate the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   elliptic curve point formats it supports.  If the Supported Point</td><td> </td><td class="right">   elliptic curve point formats it supports.  If the Supported Point</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Formats Extension is indeed sent, it MUST contain the value 0</td><td> </td><td class="right">   Formats Extension is indeed sent, it MUST contain the value 0</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (uncompressed) as one of the items in the list of point formats.</td><td> </td><td class="right">   (uncompressed) as one of the items in the list of point formats.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l27" /><small>skipping to change at</small><em> page 51, line 5</em></th><th> </th><th><a name="part-r27" /><small>skipping to change at</small><em> page 51, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compressed format even when a client cannot parse this format: the</td><td> </td><td class="right">   compressed format even when a client cannot parse this format: the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   same client may nevertheless be capable of outputting points in</td><td> </td><td class="right">   same client may nevertheless be capable of outputting points in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compressed format).</td><td> </td><td class="right">   compressed format).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   An endpoint that receives a hello message containing a Supported</td><td> </td><td class="right">   An endpoint that receives a hello message containing a Supported</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Point Formats Extension MUST respect the sender's choice of point</td><td> </td><td class="right">   Point Formats Extension MUST respect the sender's choice of point</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   formats during the handshake.  If no Supported Point Formats</td><td> </td><td class="right">   formats during the handshake.  If no Supported Point Formats</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Extension is received this is equivalent to an extension allowing</td><td> </td><td class="right">   Extension is received this is equivalent to an extension allowing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   only the uncompressed point format.</td><td> </td><td class="right">   only the uncompressed point format.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0049" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.2.5.4.  Early Data Extension</td><td> </td><td class="rblock">7.<span class="insert">3</span>.2.5.4.  Early Data Extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS versions before 1.3 have a strict message ordering and do not</td><td> </td><td class="right">   TLS versions before 1.3 have a strict message ordering and do not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   permit additional messages to follow the ClientHello.  The EarlyData</td><td> </td><td class="right">   permit additional messages to follow the ClientHello.  The EarlyData</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension allows TLS messages which would otherwise be sent as</td><td> </td><td class="right">   extension allows TLS messages which would otherwise be sent as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   separate records to be instead inserted in the ClientHello.  The</td><td> </td><td class="right">   separate records to be instead inserted in the ClientHello.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extension simply contains the TLS records which would otherwise have</td><td> </td><td class="right">   extension simply contains the TLS records which would otherwise have</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   been included in the client's first flight.</td><td> </td><td class="right">   been included in the client's first flight.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         struct {</td><td> </td><td class="right">         struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           TLSCipherText messages&lt;5 .. 2^24-1&gt;;</td><td> </td><td class="right">           TLSCipherText messages&lt;5 .. 2^24-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l28" /><small>skipping to change at</small><em> page 52, line 5</em></th><th> </th><th><a name="part-r28" /><small>skipping to change at</small><em> page 52, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   serves as acknowledgement that it was processed as described above.</td><td> </td><td class="right">   serves as acknowledgement that it was processed as described above.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [[OPEN ISSUE: This is a fairly general mechanism which is possibly</td><td> </td><td class="right">   [[OPEN ISSUE: This is a fairly general mechanism which is possibly</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   overkill in the 1-RTT case, where it would potentially be more</td><td> </td><td class="right">   overkill in the 1-RTT case, where it would potentially be more</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   attractive to just have a "ClientKeyShare" extension.  However, for</td><td> </td><td class="right">   attractive to just have a "ClientKeyShare" extension.  However, for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the 0-RTT case we will want to send the Certificate,</td><td> </td><td class="right">   the 0-RTT case we will want to send the Certificate,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateVerify, and application data, so a more general extension</td><td> </td><td class="right">   CertificateVerify, and application data, so a more general extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   seems appropriate at least until we have determined we don't need it</td><td> </td><td class="right">   seems appropriate at least until we have determined we don't need it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for 0-RTT.]]</td><td> </td><td class="right">   for 0-RTT.]]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0050" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.3.  Server Key Share Message</td><td> </td><td class="rblock">7.<span class="insert">3</span>.3.  Server Key Share Message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message will be sent immediately after the ServerHello</td><td> </td><td class="right">      This message will be sent immediately after the ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message if the client has provided a ClientKeyShare message which</td><td> </td><td class="right">      message if the client has provided a ClientKeyShare message which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      is compatible with the selected cipher suite and group parameters.</td><td> </td><td class="right">      is compatible with the selected cipher suite and group parameters.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Meaning of this message:</td><td> </td><td class="right">   Meaning of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message conveys cryptographic information to allow the client</td><td> </td><td class="right">      This message conveys cryptographic information to allow the client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l29" /><small>skipping to change at</small><em> page 52, line 30</em></th><th> </th><th><a name="part-r29" /><small>skipping to change at</small><em> page 52, line 30</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        NamedGroup group;</td><td> </td><td class="right">        NamedGroup group;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        opaque key_exchange&lt;1..2^16-1&gt;;</td><td> </td><td class="right">        opaque key_exchange&lt;1..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } ServerKeyShare;</td><td> </td><td class="right">      } ServerKeyShare;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   group  The named group for the key share offer.  This identifies the</td><td> </td><td class="right">   group  The named group for the key share offer.  This identifies the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      selected key exchange method from the ClientKeyShare message</td><td> </td><td class="right">      selected key exchange method from the ClientKeyShare message</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0051" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      (Section 7.<span class="delete">4</span>.2), identifying which value from the</td><td> </td><td class="rblock">      (Section 7.<span class="insert">3</span>.2), identifying which value from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientKeyShareOffer the server has accepted as is responding to.</td><td> </td><td class="right">      ClientKeyShareOffer the server has accepted as is responding to.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   key_exchange  Key exchange information.  The contents of this field</td><td> </td><td class="right">   key_exchange  Key exchange information.  The contents of this field</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      are determined by the value of NamedGroup entry and its</td><td> </td><td class="right">      are determined by the value of NamedGroup entry and its</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      corresponding definition.</td><td> </td><td class="right">      corresponding definition.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0052" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.4.  Encrypted Extensions</td><td> </td><td class="rblock">7.<span class="insert">3</span>.4.  Encrypted Extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      If this message is sent, it MUST be sent immediately after the</td><td> </td><td class="right">      If this message is sent, it MUST be sent immediately after the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0053" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      server's <span class="delete">ChangeCipherSpec (and hence as the first handshake</span></td><td> </td><td class="rblock">      server's <span class="insert">ServerKeyShare.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      message after the ServerKeyShare).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Meaning of this message:</td><td> </td><td class="right">   Meaning of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The EncryptedExtensions message simply contains any extensions</td><td> </td><td class="right">      The EncryptedExtensions message simply contains any extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      which should be protected, i.e., any which are not needed to</td><td> </td><td class="right">      which should be protected, i.e., any which are not needed to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      establish the cryptographic context.  The same extension types</td><td> </td><td class="right">      establish the cryptographic context.  The same extension types</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      MUST NOT appear in both the ServerHello and EncryptedExtensions.</td><td> </td><td class="right">      MUST NOT appear in both the ServerHello and EncryptedExtensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      If the same extension appears in both locations, the client MUST</td><td> </td><td class="right">      If the same extension appears in both locations, the client MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      rely only on the value in the EncryptedExtensions block.  [[OPEN</td><td> </td><td class="right">      rely only on the value in the EncryptedExtensions block.  [[OPEN</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ISSUE: Should we just produce a canonical list of what goes where</td><td> </td><td class="right">      ISSUE: Should we just produce a canonical list of what goes where</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l30" /><small>skipping to change at</small><em> page 53, line 18</em></th><th> </th><th><a name="part-r30" /><small>skipping to change at</small><em> page 53, line 17</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Extension extensions&lt;0..2^16-1&gt;;</td><td> </td><td class="right">          Extension extensions&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } EncryptedExtensions;</td><td> </td><td class="right">      } EncryptedExtensions;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extensions</td><td> </td><td class="right">   extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      A list of extensions.</td><td> </td><td class="right">      A list of extensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0054" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.5.  Server Certificate</td><td> </td><td class="rblock">7.<span class="insert">3</span>.5.  Server Certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The server MUST send a Certificate message whenever the agreed-</td><td> </td><td class="right">      The server MUST send a Certificate message whenever the agreed-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      upon key exchange method uses certificates for authentication</td><td> </td><td class="right">      upon key exchange method uses certificates for authentication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (this includes all key exchange methods defined in this document</td><td> </td><td class="right">      (this includes all key exchange methods defined in this document</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0055" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      except DH_anon).  This message will always immediately follow the</td><td> </td><td class="rblock">      except DH_anon).  This message will always immediately follow</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">ChangeCipherSpec which follows</span> the <span class="delete">server's</span> ServerKeyShare</td><td> </td><td class="rblock">      <span class="insert">either</span> the <span class="insert">EncryptedExtensions message if one is sent or</span> the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      message.</td><td> </td><td class="rblock">      ServerKeyShare message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Meaning of this message:</td><td> </td><td class="right">   Meaning of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message conveys the server's certificate chain to the client.</td><td> </td><td class="right">      This message conveys the server's certificate chain to the client.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The certificate MUST be appropriate for the negotiated cipher</td><td> </td><td class="right">      The certificate MUST be appropriate for the negotiated cipher</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      suite's key exchange algorithm and any negotiated extensions.</td><td> </td><td class="right">      suite's key exchange algorithm and any negotiated extensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l31" /><small>skipping to change at</small><em> page 55, line 29</em></th><th> </th><th><a name="part-r31" /><small>skipping to change at</small><em> page 55, line 24</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note that there are certificates that use algorithms and/or algorithm</td><td> </td><td class="right">   Note that there are certificates that use algorithms and/or algorithm</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   combinations that cannot be currently used with TLS.  For example, a</td><td> </td><td class="right">   combinations that cannot be currently used with TLS.  For example, a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificate with RSASSA-PSS signature key (id-RSASSA-PSS OID in</td><td> </td><td class="right">   certificate with RSASSA-PSS signature key (id-RSASSA-PSS OID in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   SubjectPublicKeyInfo) cannot be used because TLS defines no</td><td> </td><td class="right">   SubjectPublicKeyInfo) cannot be used because TLS defines no</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   corresponding signature algorithm.</td><td> </td><td class="right">   corresponding signature algorithm.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   As cipher suites that specify new key exchange methods are specified</td><td> </td><td class="right">   As cipher suites that specify new key exchange methods are specified</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for the TLS protocol, they will imply the certificate format and the</td><td> </td><td class="right">   for the TLS protocol, they will imply the certificate format and the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   required encoded keying information.</td><td> </td><td class="right">   required encoded keying information.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0056" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.6.  Certificate Request</td><td> </td><td class="rblock">7.<span class="insert">3</span>.6.  Certificate Request</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      A non-anonymous server can optionally request a certificate from</td><td> </td><td class="right">      A non-anonymous server can optionally request a certificate from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the client, if appropriate for the selected cipher suite.  This</td><td> </td><td class="right">      the client, if appropriate for the selected cipher suite.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message, if sent, will immediately follow the server's Certificate</td><td> </td><td class="right">      message, if sent, will immediately follow the server's Certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message).</td><td> </td><td class="right">      message).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l32" /><small>skipping to change at</small><em> page 57, line 31</em></th><th> </th><th><a name="part-r32" /><small>skipping to change at</small><em> page 57, line 14</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   New ClientCertificateType values are assigned by IANA as described in</td><td> </td><td class="right">   New ClientCertificateType values are assigned by IANA as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 12.</td><td> </td><td class="right">   Section 12.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: Values listed as RESERVED may not be used.  They were used in</td><td> </td><td class="right">   Note: Values listed as RESERVED may not be used.  They were used in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   SSLv3.</td><td> </td><td class="right">   SSLv3.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: It is a fatal handshake_failure alert for an anonymous server</td><td> </td><td class="right">   Note: It is a fatal handshake_failure alert for an anonymous server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to request client authentication.</td><td> </td><td class="right">   to request client authentication.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0057" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.7.  Server Certificate Verify</td><td> </td><td class="rblock">7.<span class="insert">3</span>.7.  Server Certificate Verify</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message is used to provide explicit proof that the server</td><td> </td><td class="right">      This message is used to provide explicit proof that the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      possesses the private key corresponding to its certificate.</td><td> </td><td class="right">      possesses the private key corresponding to its certificate.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      certificate and also provides integrity for the handshake up to</td><td> </td><td class="right">      certificate and also provides integrity for the handshake up to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      this point.  This message is only sent when the server is</td><td> </td><td class="right">      this point.  This message is only sent when the server is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      authenticated via a certificate.  When sent, it MUST be the last</td><td> </td><td class="right">      authenticated via a certificate.  When sent, it MUST be the last</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      server handshake message prior to the Finished.</td><td> </td><td class="right">      server handshake message prior to the Finished.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l33" /><small>skipping to change at</small><em> page 58, line 5</em></th><th> </th><th><a name="part-r33" /><small>skipping to change at</small><em> page 57, line 37</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           digitally-signed struct {</td><td> </td><td class="right">           digitally-signed struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               opaque handshake_messages[handshake_messages_length];</td><td> </td><td class="right">               opaque handshake_messages[handshake_messages_length];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           }</td><td> </td><td class="right">           }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } CertificateVerify;</td><td> </td><td class="right">      } CertificateVerify;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Here handshake_messages refers to all handshake messages sent or</td><td> </td><td class="right">      Here handshake_messages refers to all handshake messages sent or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      received, starting at client hello and up to, but not including,</td><td> </td><td class="right">      received, starting at client hello and up to, but not including,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      this message, including the type and length fields of the</td><td> </td><td class="right">      this message, including the type and length fields of the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      handshake messages.  This is the concatenation of all the</td><td> </td><td class="right">      handshake messages.  This is the concatenation of all the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0058" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Handshake structures (as defined in Section 7.<span class="delete">4</span>) exchanged thus</td><td> </td><td class="rblock">      Handshake structures (as defined in Section 7.<span class="insert">3</span>) exchanged thus</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      far.  Note that this requires both sides to either buffer the</td><td> </td><td class="right">      far.  Note that this requires both sides to either buffer the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      messages or compute running hashes for all potential hash</td><td> </td><td class="right">      messages or compute running hashes for all potential hash</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      algorithms up to the time of the CertificateVerify computation.</td><td> </td><td class="right">      algorithms up to the time of the CertificateVerify computation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Servers can minimize this computation cost by offering a</td><td> </td><td class="right">      Servers can minimize this computation cost by offering a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      restricted set of digest algorithms in the CertificateRequest</td><td> </td><td class="right">      restricted set of digest algorithms in the CertificateRequest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message.</td><td> </td><td class="right">      message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      If the client has offered the "signature_algorithms" extension,</td><td> </td><td class="right">      If the client has offered the "signature_algorithms" extension,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the signature algorithm and hash algorithm MUST be a pair listed</td><td> </td><td class="right">      the signature algorithm and hash algorithm MUST be a pair listed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      in that extension.  Note that there is a possibility for</td><td> </td><td class="right">      in that extension.  Note that there is a possibility for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l34" /><small>skipping to change at</small><em> page 58, line 40</em></th><th> </th><th><a name="part-r34" /><small>skipping to change at</small><em> page 58, line 23</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      hash algorithm, there is a risk of hash substitution if multiple</td><td> </td><td class="right">      hash algorithm, there is a risk of hash substitution if multiple</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      hashes may be used with any key.  Currently, DSA [DSS] may only be</td><td> </td><td class="right">      hashes may be used with any key.  Currently, DSA [DSS] may only be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      used with SHA-1.  Future revisions of DSS [DSS-3] are expected to</td><td> </td><td class="right">      used with SHA-1.  Future revisions of DSS [DSS-3] are expected to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      allow the use of other digest algorithms with DSA, as well as</td><td> </td><td class="right">      allow the use of other digest algorithms with DSA, as well as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      guidance as to which digest algorithms should be used with each</td><td> </td><td class="right">      guidance as to which digest algorithms should be used with each</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      key size.  In addition, future revisions of [RFC3280] may specify</td><td> </td><td class="right">      key size.  In addition, future revisions of [RFC3280] may specify</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      mechanisms for certificates to indicate which digest algorithms</td><td> </td><td class="right">      mechanisms for certificates to indicate which digest algorithms</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      are to be used with DSA.  [[TODO: Update this to deal with DSS-3</td><td> </td><td class="right">      are to be used with DSA.  [[TODO: Update this to deal with DSS-3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      and DSS-4.  https://github.com/tlswg/tls13-spec/issues/59]]</td><td> </td><td class="right">      and DSS-4.  https://github.com/tlswg/tls13-spec/issues/59]]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0059" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.8.  Server Finished</td><td> </td><td class="rblock">7.<span class="insert">3</span>.8.  Server Finished</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The Server's Finished message is the final message sent by the</td><td> </td><td class="right">      The Server's Finished message is the final message sent by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      server and indicates that the key exchange and authentication</td><td> </td><td class="right">      server and indicates that the key exchange and authentication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      processes were successful.</td><td> </td><td class="right">      processes were successful.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Meaning of this message:</td><td> </td><td class="right">   Meaning of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Recipients of Finished messages MUST verify that the contents are</td><td> </td><td class="right">      Recipients of Finished messages MUST verify that the contents are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      correct.  Once a side has sent its Finished message and received</td><td> </td><td class="right">      correct.  Once a side has sent its Finished message and received</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      and validated the Finished message from its peer, it may begin to</td><td> </td><td class="right">      and validated the Finished message from its peer, it may begin to</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0060" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      send and receive application data over the connection.</td><td> </td><td class="rblock">      send and receive application data over the connection.  <span class="insert">This data</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      will be protected under keys derived from the hs_master_secret</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (see Section 8.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          opaque verify_data[verify_data_length];</td><td> </td><td class="right">          opaque verify_data[verify_data_length];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } Finished;</td><td> </td><td class="right">      } Finished;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      verify_data</td><td> </td><td class="right">      verify_data</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0061" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">         PRF(master_secret, finished_label, Hash(handshake_messages))</td><td> </td><td class="rblock">         PRF(<span class="insert">hs_</span>master_secret, finished_label, Hash(handshake_messages))</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            [0..verify_data_length-1];</td><td> </td><td class="right">            [0..verify_data_length-1];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      finished_label</td><td> </td><td class="right">      finished_label</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         For Finished messages sent by the client, the string</td><td> </td><td class="right">         For Finished messages sent by the client, the string</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         "client finished".  For Finished messages sent by the server,</td><td> </td><td class="right">         "client finished".  For Finished messages sent by the server,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         the string "server finished".</td><td> </td><td class="right">         the string "server finished".</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Hash denotes a Hash of the handshake messages.  For the PRF</td><td> </td><td class="right">      Hash denotes a Hash of the handshake messages.  For the PRF</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      defined in Section 5, the Hash MUST be the Hash used as the basis</td><td> </td><td class="right">      defined in Section 5, the Hash MUST be the Hash used as the basis</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      for the PRF.  Any cipher suite which defines a different PRF MUST</td><td> </td><td class="right">      for the PRF.  Any cipher suite which defines a different PRF MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l35" /><small>skipping to change at</small><em> page 59, line 41</em></th><th> </th><th><a name="part-r35" /><small>skipping to change at</small><em> page 59, line 37</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      includes all existing cipher suites.  Note that this</td><td> </td><td class="right">      includes all existing cipher suites.  Note that this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      representation has the same encoding as with previous versions.</td><td> </td><td class="right">      representation has the same encoding as with previous versions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Future cipher suites MAY specify other lengths but such length</td><td> </td><td class="right">      Future cipher suites MAY specify other lengths but such length</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      MUST be at least 12 bytes.</td><td> </td><td class="right">      MUST be at least 12 bytes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake_messages</td><td> </td><td class="right">   handshake_messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      All of the data from all messages in this handshake (not including</td><td> </td><td class="right">      All of the data from all messages in this handshake (not including</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      any HelloRequest messages) up to, but not including, this message.</td><td> </td><td class="right">      any HelloRequest messages) up to, but not including, this message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This is only data visible at the handshake layer and does not</td><td> </td><td class="right">      This is only data visible at the handshake layer and does not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      include record layer headers.  This is the concatenation of all</td><td> </td><td class="right">      include record layer headers.  This is the concatenation of all</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0062" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the Handshake structures as defined in Section 7.<span class="delete">4</span>, exchanged thus</td><td> </td><td class="rblock">      the Handshake structures as defined in Section 7.<span class="insert">3</span>, exchanged thus</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      far.</td><td> </td><td class="right">      far.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0063" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">It is a fatal error if a Finished message is not preceded by a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   ChangeCipherSpec message at the appropriate point in the handshake.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The value handshake_messages includes all handshake messages starting</td><td> </td><td class="right">   The value handshake_messages includes all handshake messages starting</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   at ClientHello up to, but not including, this Finished message.  This</td><td> </td><td class="right">   at ClientHello up to, but not including, this Finished message.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0064" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   may be different from handshake_messages in Section <span class="delete">7.4.7</span> or</td><td> </td><td class="rblock">   may be different from handshake_messages in Section <span class="insert">7.3.7</span> or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Section <span class="delete">7.4.10.</span>  Also, the handshake_messages for the Finished</td><td> </td><td class="rblock">   Section <span class="insert">7.3.10.</span>  Also, the handshake_messages for the Finished</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message sent by the client will be different from that for the</td><td> </td><td class="right">   message sent by the client will be different from that for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Finished message sent by the server, because the one that is sent</td><td> </td><td class="right">   Finished message sent by the server, because the one that is sent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   second will include the prior one.</td><td> </td><td class="right">   second will include the prior one.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0065" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Note: <span class="delete">ChangeCipherSpec messages, alerts,</span> and any other record types</td><td> </td><td class="rblock">   Note: <span class="insert">Alerts</span> and any other record types are not handshake messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   are not handshake messages and are not included in the hash</td><td> </td><td class="rblock">   and are not included in the hash computations.  Also, HelloRequest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   computations.  Also, HelloRequest messages are omitted from handshake</td><td> </td><td class="rblock">   messages are omitted from handshake hashes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   hashes.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0066" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.9.  Client Certificate</td><td> </td><td class="rblock">7.<span class="insert">3</span>.9.  Client Certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message is the first handshake message the client can send</td><td> </td><td class="right">      This message is the first handshake message the client can send</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0067" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      after receiving the server's Finished <span class="delete">and having sent its own</span></td><td> </td><td class="rblock">      after receiving the server's Finished This message is only sent if</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      ChangeCipherSpecs.</span>  This message is only sent if the server</td><td> </td><td class="rblock">      the server requests a certificate.  If no suitable certificate is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      requests a certificate.  If no suitable certificate is available,</td><td> </td><td class="rblock">      available, the client MUST send a certificate message containing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the client MUST send a certificate message containing no</td><td> </td><td class="rblock">      no certificates.  That is, the certificate_list structure has a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      certificates.  That is, the certificate_list structure has a</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      length of zero.  If the client does not send any certificates, the</td><td> </td><td class="right">      length of zero.  If the client does not send any certificates, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      server MAY at its discretion either continue the handshake without</td><td> </td><td class="right">      server MAY at its discretion either continue the handshake without</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client authentication, or respond with a fatal handshake_failure</td><td> </td><td class="right">      client authentication, or respond with a fatal handshake_failure</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      alert.  Also, if some aspect of the certificate chain was</td><td> </td><td class="right">      alert.  Also, if some aspect of the certificate chain was</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      unacceptable (e.g., it was not signed by a known, trusted CA), the</td><td> </td><td class="right">      unacceptable (e.g., it was not signed by a known, trusted CA), the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      server MAY at its discretion either continue the handshake</td><td> </td><td class="right">      server MAY at its discretion either continue the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (considering the client unauthenticated) or send a fatal alert.</td><td> </td><td class="right">      (considering the client unauthenticated) or send a fatal alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Client certificates are sent using the Certificate structure</td><td> </td><td class="right">      Client certificates are sent using the Certificate structure</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0068" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      defined in Section 7.<span class="delete">4</span>.5.</td><td> </td><td class="rblock">      defined in Section 7.<span class="insert">3</span>.5.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Meaning of this message:</td><td> </td><td class="right">   Meaning of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message conveys the client's certificate chain to the server;</td><td> </td><td class="right">      This message conveys the client's certificate chain to the server;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the server will use it when verifying the CertificateVerify</td><td> </td><td class="right">      the server will use it when verifying the CertificateVerify</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message (when the client authentication is based on signing) or</td><td> </td><td class="right">      message (when the client authentication is based on signing) or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      calculating the premaster secret (for non-ephemeral Diffie-</td><td> </td><td class="right">      calculating the premaster secret (for non-ephemeral Diffie-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Hellman).  The certificate MUST be appropriate for the negotiated</td><td> </td><td class="right">      Hellman).  The certificate MUST be appropriate for the negotiated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      cipher suite's key exchange algorithm, and any negotiated</td><td> </td><td class="right">      cipher suite's key exchange algorithm, and any negotiated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extensions.</td><td> </td><td class="right">      extensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l36" /><small>skipping to change at</small><em> page 61, line 36</em></th><th> </th><th><a name="part-r36" /><small>skipping to change at</small><em> page 61, line 36</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    rsa_fixed_ecdh      ECDH-capable public key; MUST use the</td><td> </td><td class="right">    rsa_fixed_ecdh      ECDH-capable public key; MUST use the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">    ecdsa_fixed_ecdh    same curve as the server's key, and MUST use a</td><td> </td><td class="right">    ecdsa_fixed_ecdh    same curve as the server's key, and MUST use a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                        point format supported by the server.</td><td> </td><td class="right">                        point format supported by the server.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  If the certificate_authorities list in the certificate request</td><td> </td><td class="right">   -  If the certificate_authorities list in the certificate request</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      message was non-empty, one of the certificates in the certificate</td><td> </td><td class="right">      message was non-empty, one of the certificates in the certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      chain SHOULD be issued by one of the listed CAs.</td><td> </td><td class="right">      chain SHOULD be issued by one of the listed CAs.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  The certificates MUST be signed using an acceptable hash/</td><td> </td><td class="right">   -  The certificates MUST be signed using an acceptable hash/</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0069" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      signature algorithm pair, as described in Section 7.<span class="delete">4</span>.6.  Note</td><td> </td><td class="rblock">      signature algorithm pair, as described in Section 7.<span class="insert">3</span>.6.  Note</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      that this relaxes the constraints on certificate-signing</td><td> </td><td class="right">      that this relaxes the constraints on certificate-signing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      algorithms found in prior versions of TLS.</td><td> </td><td class="right">      algorithms found in prior versions of TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note that, as with the server certificate, there are certificates</td><td> </td><td class="right">   Note that, as with the server certificate, there are certificates</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that use algorithms/algorithm combinations that cannot be currently</td><td> </td><td class="right">   that use algorithms/algorithm combinations that cannot be currently</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   used with TLS.</td><td> </td><td class="right">   used with TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0070" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.<span class="delete">4</span>.10.  Client Certificate Verify</td><td> </td><td class="rblock">7.<span class="insert">3</span>.10.  Client Certificate Verify</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message is used to provide explicit verification of a client</td><td> </td><td class="right">      This message is used to provide explicit verification of a client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      certificate.  This message is only sent following a client</td><td> </td><td class="right">      certificate.  This message is only sent following a client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      certificate that has signing capability (i.e., all certificates</td><td> </td><td class="right">      certificate that has signing capability (i.e., all certificates</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      except those containing fixed Diffie-Hellman parameters).  When</td><td> </td><td class="right">      except those containing fixed Diffie-Hellman parameters).  When</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      sent, it MUST immediately follow the client's Certificate message.</td><td> </td><td class="right">      sent, it MUST immediately follow the client's Certificate message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The contents of the message are computed as described in</td><td> </td><td class="right">      The contents of the message are computed as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0071" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Section 7.<span class="delete">4</span>.7.</td><td> </td><td class="rblock">      Section 7.<span class="insert">3</span>.7.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The hash and signature algorithms used in the signature MUST be</td><td> </td><td class="right">      The hash and signature algorithms used in the signature MUST be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      one of those present in the supported_signature_algorithms field</td><td> </td><td class="right">      one of those present in the supported_signature_algorithms field</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      of the CertificateRequest message.  In addition, the hash and</td><td> </td><td class="right">      of the CertificateRequest message.  In addition, the hash and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      signature algorithms MUST be compatible with the key in the</td><td> </td><td class="right">      signature algorithms MUST be compatible with the key in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client's end-entity certificate.  RSA keys MAY be used with any</td><td> </td><td class="right">      client's end-entity certificate.  RSA keys MAY be used with any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      permitted hash algorithm, subject to restrictions in the</td><td> </td><td class="right">      permitted hash algorithm, subject to restrictions in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      certificate, if any.</td><td> </td><td class="right">      certificate, if any.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Because DSA signatures do not contain any secure indication of</td><td> </td><td class="right">      Because DSA signatures do not contain any secure indication of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l37" /><small>skipping to change at</small><em> page 62, line 38</em></th><th> </th><th><a name="part-r37" /><small>skipping to change at</small><em> page 62, line 38</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In order to begin connection protection, the TLS Record Protocol</td><td> </td><td class="right">   In order to begin connection protection, the TLS Record Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   requires specification of a suite of algorithms, a master secret, and</td><td> </td><td class="right">   requires specification of a suite of algorithms, a master secret, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the client and server random values.  The authentication, key</td><td> </td><td class="right">   the client and server random values.  The authentication, key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   agreement, and record protection algorithms are determined by the</td><td> </td><td class="right">   agreement, and record protection algorithms are determined by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cipher_suite selected by the server and revealed in the ServerHello</td><td> </td><td class="right">   cipher_suite selected by the server and revealed in the ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message.  The random values are exchanged in the hello messages.  All</td><td> </td><td class="right">   message.  The random values are exchanged in the hello messages.  All</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that remains is to calculate the master secret.</td><td> </td><td class="right">   that remains is to calculate the master secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">8.1.  Computing the Master Secret</td><td> </td><td class="right">8.1.  Computing the Master Secret</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0072" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">For all key exchange methods, the same algorithm</span> is used to <span class="delete">convert</span></td><td> </td><td class="rblock">   <span class="insert">The pre_master_secret</span> is used to <span class="insert">generate a series of master secret</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   the pre_master_secret into the master_secret.  The pre_master_secret</span></td><td> </td><td class="rblock"><span class="insert">   values, as shown in</span> the <span class="insert">following diagram and described below.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   should be deleted from memory once</span> the <span class="delete">master_secret has been</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   computed.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0073" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">master_secret</span> = PRF(pre_master_secret, <span class="delete">"master</span> secret",</td><td> </td><td class="rblock">                                <span class="insert">Premaster Secret &lt;---------+</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                          <span class="delete">ClientHello.random + ServerHello.random)</span></td><td> </td><td class="rblock"><span class="insert">                                       |                   |</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                      PRF                  |</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       |                   |</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       v                   |</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     Handshake   &lt;-PRF-           Handshake                |</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    Traffic Keys                 Master Secret             |</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       |                   | Via</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                       |                   | Session</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                            +----------+----------+        | Cache</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                            |                     |        |</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                           PRF                   PRF       |</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                            |                     |        |</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                            v                     v        |</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    Application  &lt;-PRF-  Master               Resumption   |</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Traffic Keys          Secret               Premaster  --+</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                Secret</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   First, as soon as the ClientKeyShare and ServerKeyShare messages have</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   been exchanged, the client and server each use the unauthenticated</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   key shares to generate a master secret which is used for the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   protection of the remaining handshake records.  Specifically, they</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   generate:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    hs_master_secret</span> = PRF(pre_master_secret, <span class="insert">"handshake master</span> secret",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                           <span class="insert">session_hash)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                          [0..47];</td><td> </td><td class="right">                          [0..47];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0074" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">The</span> master secret is always exactly 48 bytes in length.  The length</td><td> </td><td class="rblock">   <span class="insert">During resumption, the premaster secret is initialized with the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   "resumption premaster secret", rather than using the values from the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ClientKeyShare/ServerKeyShare exchange.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This master secret value is used to generate the record protection</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   keys used for the handshake, as described in Section 6.3.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Once the hs_master_secret has been computed, the premaster secret</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   should be deleted from memory.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Once the last non-Finished message has been sent, the client and</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server then compute the master secret which will be used for the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   remainder of the session:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      master_secret = PRF(hs_master_secret, "extended master secret",</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                          session_hash)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                          [0..47];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   If the server does not request client authentication, the</span> master</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   secret <span class="insert">can be computed at the time that the server sends its</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Finished, thus allowing the server to send traffic on its first</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   flight (see [TODO] for security considerations on this practice.)  If</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the server requests client authentication, this secret can be</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   computed after the client's Certificate and CertificateVerify have</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   been sent, or, if the client refuses client authentication, after the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   client's empty Certificate message has been sent.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   For full handshakes, each side also derives a new secret which will</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   be used as the premaster_secret for future resumptions of the newly</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   established session.  This</span> is <span class="insert">computed as:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      resumption_premaster_secret = PRF(hs_master_secret,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                        "resumption premaster secret",</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                        session_hash)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                        [0..47];</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The session_hash value is a running hash of the handshake as defined</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   in Section 8.1.1.  Thus, the hs_master_secret is generated using a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   different session_hash from the other two secrets.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   All master secrets are</span> always exactly 48 bytes in length.  The length</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of the premaster secret will vary depending on key exchange method.</td><td> </td><td class="right">   of the premaster secret will vary depending on key exchange method.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0075" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">8.1.1.  Diffie-Hellman</td><td> </td><td class="rblock">8.1.1.  <span class="insert">The Session Hash</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   When a handshake takes place, we define</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">        session_hash = Hash(handshake_messages)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   where "handshake_messages" refers to all handshake messages sent or</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   received, starting at client hello up to the present time, with the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   exception of the Finished message, including the type and length</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   fields of the handshake messages.  This is the concatenation of all</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the exchanged Handshake structures.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">8.1.2.</span>  Diffie-Hellman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   A conventional Diffie-Hellman computation is performed.  The</td><td> </td><td class="right">   A conventional Diffie-Hellman computation is performed.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   negotiated key (Z) is used as the pre_master_secret, and is converted</td><td> </td><td class="right">   negotiated key (Z) is used as the pre_master_secret, and is converted</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   into the master_secret, as specified above.  Leading bytes of Z that</td><td> </td><td class="right">   into the master_secret, as specified above.  Leading bytes of Z that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   contain all zero bits are stripped before it is used as the</td><td> </td><td class="right">   contain all zero bits are stripped before it is used as the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   pre_master_secret.</td><td> </td><td class="right">   pre_master_secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: Diffie-Hellman parameters are specified by the server and may</td><td> </td><td class="right">   Note: Diffie-Hellman parameters are specified by the server and may</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   be either ephemeral or contained within the server's certificate.</td><td> </td><td class="right">   be either ephemeral or contained within the server's certificate.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0076" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">8.1.<span class="delete">2</span>.  Elliptic Curve Diffie-Hellman</td><td> </td><td class="rblock">8.1.<span class="insert">3</span>.  Elliptic Curve Diffie-Hellman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   All ECDH calculations (including parameter and key generation as well</td><td> </td><td class="right">   All ECDH calculations (including parameter and key generation as well</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   as the shared secret calculation) are performed according to [6]</td><td> </td><td class="right">   as the shared secret calculation) are performed according to [6]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   using the ECKAS-DH1 scheme with the identity map as key derivation</td><td> </td><td class="right">   using the ECKAS-DH1 scheme with the identity map as key derivation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   function (KDF), so that the premaster secret is the x-coordinate of</td><td> </td><td class="right">   function (KDF), so that the premaster secret is the x-coordinate of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the ECDH shared secret elliptic curve point represented as an octet</td><td> </td><td class="right">   the ECDH shared secret elliptic curve point represented as an octet</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   string.  Note that this octet string (Z in IEEE 1363 terminology) as</td><td> </td><td class="right">   string.  Note that this octet string (Z in IEEE 1363 terminology) as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   output by FE2OSP, the Field Element to Octet String Conversion</td><td> </td><td class="right">   output by FE2OSP, the Field Element to Octet String Conversion</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Primitive, has constant length for any given field; leading zeros</td><td> </td><td class="right">   Primitive, has constant length for any given field; leading zeros</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   found in this octet string MUST NOT be truncated.</td><td> </td><td class="right">   found in this octet string MUST NOT be truncated.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l38" /><small>skipping to change at</small><em> page 64, line 44</em></th><th> </th><th><a name="part-r38" /><small>skipping to change at</small><em> page 66, line 30</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  TLS HandshakeType Registry: Future values are allocated via</td><td> </td><td class="right">   -  TLS HandshakeType Registry: Future values are allocated via</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Standards Action [RFC2434].</td><td> </td><td class="right">      Standards Action [RFC2434].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document also uses a registry originally created in [RFC4366].</td><td> </td><td class="right">   This document also uses a registry originally created in [RFC4366].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   IANA has updated it to reference this document.  The registry and its</td><td> </td><td class="right">   IANA has updated it to reference this document.  The registry and its</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   allocation policy (unchanged from [RFC4366]) is listed below:</td><td> </td><td class="right">   allocation policy (unchanged from [RFC4366]) is listed below:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  TLS ExtensionType Registry: Future values are allocated via IETF</td><td> </td><td class="right">   -  TLS ExtensionType Registry: Future values are allocated via IETF</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Consensus [RFC2434].  IANA has updated this registry to include</td><td> </td><td class="right">      Consensus [RFC2434].  IANA has updated this registry to include</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the signature_algorithms extension and its corresponding value</td><td> </td><td class="right">      the signature_algorithms extension and its corresponding value</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0077" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      (see Section 7.<span class="delete">4</span>.2.5).</td><td> </td><td class="rblock">      (see Section 7.<span class="insert">3</span>.2.5).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document also uses two registries originally created in</td><td> </td><td class="right">   This document also uses two registries originally created in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC4492].  IANA [should update/has updated] it to reference this</td><td> </td><td class="right">   [RFC4492].  IANA [should update/has updated] it to reference this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   document.  The registries and their allocation policies are listed</td><td> </td><td class="right">   document.  The registries and their allocation policies are listed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   below.</td><td> </td><td class="right">   below.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  TLS NamedCurve registry: Future values are allocated via IETF</td><td> </td><td class="right">   -  TLS NamedCurve registry: Future values are allocated via IETF</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Consensus [RFC2434].</td><td> </td><td class="right">      Consensus [RFC2434].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  TLS ECPointFormat Registry: Future values are allocated via IETF</td><td> </td><td class="right">   -  TLS ECPointFormat Registry: Future values are allocated via IETF</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Consensus [RFC2434].</td><td> </td><td class="right">      Consensus [RFC2434].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In addition, this document defines two new registries to be</td><td> </td><td class="right">   In addition, this document defines two new registries to be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   maintained by IANA:</td><td> </td><td class="right">   maintained by IANA:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  TLS SignatureAlgorithm Registry: The registry has been initially</td><td> </td><td class="right">   -  TLS SignatureAlgorithm Registry: The registry has been initially</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0078" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      populated with the values described in Section 7.<span class="delete">4</span>.2.5.1.  Future</td><td> </td><td class="rblock">      populated with the values described in Section 7.<span class="insert">3</span>.2.5.1.  Future</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      values in the range 0-63 (decimal) inclusive are assigned via</td><td> </td><td class="right">      values in the range 0-63 (decimal) inclusive are assigned via</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Standards Action [RFC2434].  Values in the range 64-223 (decimal)</td><td> </td><td class="right">      Standards Action [RFC2434].  Values in the range 64-223 (decimal)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      inclusive are assigned via Specification Required [RFC2434].</td><td> </td><td class="right">      inclusive are assigned via Specification Required [RFC2434].</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0079" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                         </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Values from 224-255 (decimal) inclusive are reserved for Private</td><td> </td><td class="right">      Values from 224-255 (decimal) inclusive are reserved for Private</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Use [RFC2434].</td><td> </td><td class="right">      Use [RFC2434].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  TLS HashAlgorithm Registry: The registry has been initially</td><td> </td><td class="right">   -  TLS HashAlgorithm Registry: The registry has been initially</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0080" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      populated with the values described in Section 7.<span class="delete">4</span>.2.5.1.  Future</td><td> </td><td class="rblock">      populated with the values described in Section 7.<span class="insert">3</span>.2.5.1.  Future</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      values in the range 0-63 (decimal) inclusive are assigned via</td><td> </td><td class="right">      values in the range 0-63 (decimal) inclusive are assigned via</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Standards Action [RFC2434].  Values in the range 64-223 (decimal)</td><td> </td><td class="right">      Standards Action [RFC2434].  Values in the range 64-223 (decimal)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      inclusive are assigned via Specification Required [RFC2434].</td><td> </td><td class="right">      inclusive are assigned via Specification Required [RFC2434].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Values from 224-255 (decimal) inclusive are reserved for Private</td><td> </td><td class="right">      Values from 224-255 (decimal) inclusive are reserved for Private</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Use [RFC2434].</td><td> </td><td class="right">      Use [RFC2434].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">13.  References</td><td> </td><td class="right">13.  References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">13.1.  Normative References</td><td> </td><td class="right">13.1.  Normative References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l39" /><small>skipping to change at</small><em> page 67, line 43</em></th><th> </th><th><a name="part-r39" /><small>skipping to change at</small><em> page 69, line 31</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [GCM]      Dworkin, M., "Recommendation for Block Cipher Modes of</td><td> </td><td class="right">   [GCM]      Dworkin, M., "Recommendation for Block Cipher Modes of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Operation: Galois/Counter Mode (GCM) and GMAC", NIST</td><td> </td><td class="right">              Operation: Galois/Counter Mode (GCM) and GMAC", NIST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Special Publication 800-38D, November 2007.</td><td> </td><td class="right">              Special Publication 800-38D, November 2007.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [I-D.ietf-tls-negotiated-ff-dhe]</td><td> </td><td class="right">   [I-D.ietf-tls-negotiated-ff-dhe]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Gillmor, D., "Negotiated Finite Field Diffie-Hellman</td><td> </td><td class="right">              Gillmor, D., "Negotiated Finite Field Diffie-Hellman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Ephemeral Parameters for TLS", draft-ietf-tls-negotiated-</td><td> </td><td class="right">              Ephemeral Parameters for TLS", draft-ietf-tls-negotiated-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              ff-dhe-03 (work in progress), November 2014.</td><td> </td><td class="right">              ff-dhe-03 (work in progress), November 2014.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0081" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[I-D.ietf-tls-session-hash]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Bhargavan, K., Delignat-Lavaud, A., Pironti, A., Langley,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              A., and M. Ray, "Transport Layer Security (TLS) Session</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Hash and Extended Master Secret Extension", draft-ietf-</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              tls-session-hash-03 (work in progress), November 2014.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [PKCS6]    RSA Laboratories, "PKCS #6: RSA Extended Certificate</td><td> </td><td class="right">   [PKCS6]    RSA Laboratories, "PKCS #6: RSA Extended Certificate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Syntax Standard, version 1.5", November 1993.</td><td> </td><td class="right">              Syntax Standard, version 1.5", November 1993.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [PKCS7]    RSA Laboratories, "PKCS #7: RSA Cryptographic Message</td><td> </td><td class="right">   [PKCS7]    RSA Laboratories, "PKCS #7: RSA Cryptographic Message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Syntax Standard, version 1.5", November 1993.</td><td> </td><td class="right">              Syntax Standard, version 1.5", November 1993.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC0793]  Postel, J., "Transmission Control Protocol", STD 7, RFC</td><td> </td><td class="right">   [RFC0793]  Postel, J., "Transmission Control Protocol", STD 7, RFC</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              793, September 1981.</td><td> </td><td class="right">              793, September 1981.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC1948]  Bellovin, S., "Defending Against Sequence Number Attacks",</td><td> </td><td class="right">   [RFC1948]  Bellovin, S., "Defending Against Sequence Number Attacks",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l40" /><small>skipping to change at</small><em> page 77, line 51</em></th><th> </th><th><a name="part-r40" /><small>skipping to change at</small><em> page 79, line 51</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   RFC 4492 do not need to read this section.</td><td> </td><td class="right">   RFC 4492 do not need to read this section.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document adds a "signature_algorithm" field to the digitally-</td><td> </td><td class="right">   This document adds a "signature_algorithm" field to the digitally-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   signed element in order to identify the signature and digest</td><td> </td><td class="right">   signed element in order to identify the signature and digest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   algorithms used to create a signature.  This change applies to</td><td> </td><td class="right">   algorithms used to create a signature.  This change applies to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   digital signatures formed using ECDSA as well, thus allowing ECDSA</td><td> </td><td class="right">   digital signatures formed using ECDSA as well, thus allowing ECDSA</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   signatures to be used with digest algorithms other than SHA-1,</td><td> </td><td class="right">   signatures to be used with digest algorithms other than SHA-1,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provided such use is compatible with the certificate and any</td><td> </td><td class="right">   provided such use is compatible with the certificate and any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   restrictions imposed by future revisions of [RFC3280].</td><td> </td><td class="right">   restrictions imposed by future revisions of [RFC3280].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0082" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   As described in Section 7.<span class="delete">4.5 and Section 7.4</span>.9, the restrictions on</td><td> </td><td class="rblock">   As described in Section 7.<span class="insert">3.5 and Section 7.3</span>.9, the restrictions on</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the signature algorithms used to sign certificates are no longer tied</td><td> </td><td class="right">   the signature algorithms used to sign certificates are no longer tied</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to the cipher suite (when used by the server) or the</td><td> </td><td class="right">   to the cipher suite (when used by the server) or the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientCertificateType (when used by the client).  Thus, the</td><td> </td><td class="right">   ClientCertificateType (when used by the client).  Thus, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   restrictions on the algorithm used to sign certificates specified in</td><td> </td><td class="right">   restrictions on the algorithm used to sign certificates specified in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Sections 2 and 3 of RFC 4492 are also relaxed.  As in this document,</td><td> </td><td class="right">   Sections 2 and 3 of RFC 4492 are also relaxed.  As in this document,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the restrictions on the keys in the end-entity certificate remain.</td><td> </td><td class="right">   the restrictions on the keys in the end-entity certificate remain.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix B.  Glossary</td><td> </td><td class="right">Appendix B.  Glossary</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Advanced Encryption Standard (AES)</td><td> </td><td class="right">   Advanced Encryption Standard (AES)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l41" /><small>skipping to change at</small><em> page 83, line 18</em></th><th> </th><th><a name="part-r41" /><small>skipping to change at</small><em> page 85, line 18</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Do you handle TLS extensions in ClientHello correctly, including</td><td> </td><td class="right">   -  Do you handle TLS extensions in ClientHello correctly, including</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      omitting the extensions field completely?</td><td> </td><td class="right">      omitting the extensions field completely?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Do you support renegotiation, both client and server initiated?</td><td> </td><td class="right">   -  Do you support renegotiation, both client and server initiated?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      While renegotiation is an optional feature, supporting it is</td><td> </td><td class="right">      While renegotiation is an optional feature, supporting it is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      highly recommended.</td><td> </td><td class="right">      highly recommended.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  When the server has requested a client certificate, but no</td><td> </td><td class="right">   -  When the server has requested a client certificate, but no</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      suitable certificate is available, do you correctly send an empty</td><td> </td><td class="right">      suitable certificate is available, do you correctly send an empty</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Certificate message, instead of omitting the whole message (see</td><td> </td><td class="right">      Certificate message, instead of omitting the whole message (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0083" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Section 7.<span class="delete">4</span>.9)?</td><td> </td><td class="rblock">      Section 7.<span class="insert">3</span>.9)?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Cryptographic details:</td><td> </td><td class="right">   Cryptographic details:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  What countermeasures do you use to prevent timing attacks against</td><td> </td><td class="right">   -  What countermeasures do you use to prevent timing attacks against</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      RSA signing operations [TIMING].</td><td> </td><td class="right">      RSA signing operations [TIMING].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  When verifying RSA signatures, do you accept both NULL and missing</td><td> </td><td class="right">   -  When verifying RSA signatures, do you accept both NULL and missing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      parameters (see Section 4.7)?  Do you verify that the RSA padding</td><td> </td><td class="right">      parameters (see Section 4.7)?  Do you verify that the RSA padding</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      doesn't have additional data after the hash value?  [FI06]</td><td> </td><td class="right">      doesn't have additional data after the hash value?  [FI06]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  When using Diffie-Hellman key exchange, do you correctly strip</td><td> </td><td class="right">   -  When using Diffie-Hellman key exchange, do you correctly strip</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0084" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      leading zero bytes from the negotiated key (see Section 8.1.<span class="delete">1</span>)?</td><td> </td><td class="rblock">      leading zero bytes from the negotiated key (see Section 8.1.<span class="insert">2</span>)?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Does your TLS client check that the Diffie-Hellman parameters sent</td><td> </td><td class="right">   -  Does your TLS client check that the Diffie-Hellman parameters sent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      by the server are acceptable (see Appendix F.1.1.2)?</td><td> </td><td class="right">      by the server are acceptable (see Appendix F.1.1.2)?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Do you use a strong and, most importantly, properly seeded random</td><td> </td><td class="right">   -  Do you use a strong and, most importantly, properly seeded random</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      number generator (see Appendix D.1) Diffie-Hellman private values,</td><td> </td><td class="right">      number generator (see Appendix D.1) Diffie-Hellman private values,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the DSA "k" parameter, and other security-critical values?</td><td> </td><td class="right">      the DSA "k" parameter, and other security-critical values?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix E.  Backward Compatibility</td><td> </td><td class="right">Appendix E.  Backward Compatibility</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l42" /><small>skipping to change at</small><em> page 88, line 15</em></th><th> </th><th><a name="part-r42" /><small>skipping to change at</small><em> page 90, line 15</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   leading to an acceptable certificate authority.  Similarly,</td><td> </td><td class="right">   leading to an acceptable certificate authority.  Similarly,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   authenticated clients must supply an acceptable certificate to the</td><td> </td><td class="right">   authenticated clients must supply an acceptable certificate to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server.  Each party is responsible for verifying that the other's</td><td> </td><td class="right">   server.  Each party is responsible for verifying that the other's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   certificate is valid and has not expired or been revoked.</td><td> </td><td class="right">   certificate is valid and has not expired or been revoked.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The general goal of the key exchange process is to create a</td><td> </td><td class="right">   The general goal of the key exchange process is to create a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   pre_master_secret known to the communicating parties and not to</td><td> </td><td class="right">   pre_master_secret known to the communicating parties and not to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   attackers.  The pre_master_secret will be used to generate the</td><td> </td><td class="right">   attackers.  The pre_master_secret will be used to generate the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   master_secret (see Section 8.1).  The master_secret is required to</td><td> </td><td class="right">   master_secret (see Section 8.1).  The master_secret is required to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   generate the Finished messages and record protection keys (see</td><td> </td><td class="right">   generate the Finished messages and record protection keys (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0085" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Section 7.<span class="delete">4</span>.8 and Section 6.3).  By sending a correct Finished</td><td> </td><td class="rblock">   Section 7.<span class="insert">3</span>.8 and Section 6.3).  By sending a correct Finished</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message, parties thus prove that they know the correct</td><td> </td><td class="right">   message, parties thus prove that they know the correct</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   pre_master_secret.</td><td> </td><td class="right">   pre_master_secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">F.1.1.1.  Anonymous Key Exchange</td><td> </td><td class="right">F.1.1.1.  Anonymous Key Exchange</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Completely anonymous sessions can be established using Diffie-Hellman</td><td> </td><td class="right">   Completely anonymous sessions can be established using Diffie-Hellman</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   for key exchange.  The server's public parameters are contained in</td><td> </td><td class="right">   for key exchange.  The server's public parameters are contained in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the server key share message, and the client's are sent in the client</td><td> </td><td class="right">   the server key share message, and the client's are sent in the client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   key share message.  Eavesdroppers who do not know the private values</td><td> </td><td class="right">   key share message.  Eavesdroppers who do not know the private values</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   should not be able to find the Diffie-Hellman result (i.e., the</td><td> </td><td class="right">   should not be able to find the Diffie-Hellman result (i.e., the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l43" /><small>skipping to change at</small><em> page 91, line 28</em></th><th> </th><th><a name="part-r43" /><small>skipping to change at</small><em> page 93, line 28</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix H.  Contributors</td><td> </td><td class="right">Appendix H.  Contributors</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Christopher Allen (co-editor of TLS 1.0)</td><td> </td><td class="right">   Christopher Allen (co-editor of TLS 1.0)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Alacrity Ventures</td><td> </td><td class="right">   Alacrity Ventures</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ChristopherA@AlacrityManagement.com</td><td> </td><td class="right">   ChristopherA@AlacrityManagement.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Martin Abadi</td><td> </td><td class="right">   Martin Abadi</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   University of California, Santa Cruz</td><td> </td><td class="right">   University of California, Santa Cruz</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   abadi@cs.ucsc.edu</td><td> </td><td class="right">   abadi@cs.ucsc.edu</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0086" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Karthikeyan Bhargavan (co-author of {{I-D.ietf-tls-session-hash}})</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   INRIA</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   karthikeyan.bhargavan@inria.fr</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Steven M. Bellovin</td><td> </td><td class="right">   Steven M. Bellovin</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Columbia University</td><td> </td><td class="right">   Columbia University</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   smb@cs.columbia.edu</td><td> </td><td class="right">   smb@cs.columbia.edu</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Simon Blake-Wilson (co-author of RFC4492)</td><td> </td><td class="right">   Simon Blake-Wilson (co-author of RFC4492)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   BCI</td><td> </td><td class="right">   BCI</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sblakewilson@bcisse.com</td><td> </td><td class="right">   sblakewilson@bcisse.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Nelson Bolyard</td><td> </td><td class="right">   Nelson Bolyard</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Sun Microsystems, Inc.</td><td> </td><td class="right">   Sun Microsystems, Inc.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   nelson@bolyard.com (co-author of RFC4492)</td><td> </td><td class="right">   nelson@bolyard.com (co-author of RFC4492)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Ran Canetti</td><td> </td><td class="right">   Ran Canetti</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   IBM</td><td> </td><td class="right">   IBM</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   canetti@watson.ibm.com</td><td> </td><td class="right">   canetti@watson.ibm.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Pete Chown</td><td> </td><td class="right">   Pete Chown</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Skygate Technology Ltd</td><td> </td><td class="right">   Skygate Technology Ltd</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   pc@skygate.co.uk</td><td> </td><td class="right">   pc@skygate.co.uk</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0087" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Antoine Delignat-Lavaud (co-author of {{I-D.ietf-tls-session-hash}})</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   INRIA</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   antoine.delignat-lavaud@inria.fr</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Taher Elgamal</td><td> </td><td class="right">   Taher Elgamal</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   taher@securify.com</td><td> </td><td class="right">   taher@securify.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Securify</td><td> </td><td class="right">   Securify</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0088" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                         </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Pasi Eronen</td><td> </td><td class="right">   Pasi Eronen</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   pasi.eronen@nokia.com</td><td> </td><td class="right">   pasi.eronen@nokia.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Nokia</td><td> </td><td class="right">   Nokia</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Anil Gangolli</td><td> </td><td class="right">   Anil Gangolli</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   anil@busybuddha.org</td><td> </td><td class="right">   anil@busybuddha.org</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Vipul Gupta (co-author of RFC4492)</td><td> </td><td class="right">   Vipul Gupta (co-author of RFC4492)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Sun Microsystems Laboratories</td><td> </td><td class="right">   Sun Microsystems Laboratories</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   vipul.gupta@sun.com</td><td> </td><td class="right">   vipul.gupta@sun.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l44" /><small>skipping to change at</small><em> page 92, line 41</em></th><th> </th><th><a name="part-r44" /><small>skipping to change at</small><em> page 94, line 49</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Phil Karlton (co-author of SSLv3)</td><td> </td><td class="right">   Phil Karlton (co-author of SSLv3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Paul Kocher (co-author of SSLv3)</td><td> </td><td class="right">   Paul Kocher (co-author of SSLv3)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Cryptography Research</td><td> </td><td class="right">   Cryptography Research</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   paul@cryptography.com</td><td> </td><td class="right">   paul@cryptography.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Hugo Krawczyk</td><td> </td><td class="right">   Hugo Krawczyk</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   IBM</td><td> </td><td class="right">   IBM</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   hugo@ee.technion.ac.il</td><td> </td><td class="right">   hugo@ee.technion.ac.il</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0089" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Adam Langley (co-author of {{I-D.ietf-tls-session-hash}})</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Google</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   agl@google.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Jan Mikkelsen</td><td> </td><td class="right">   Jan Mikkelsen</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Transactionware</td><td> </td><td class="right">   Transactionware</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   janm@transactionware.com</td><td> </td><td class="right">   janm@transactionware.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Bodo Moeller (co-author of RFC4492)</td><td> </td><td class="right">   Bodo Moeller (co-author of RFC4492)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Google</td><td> </td><td class="right">   Google</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   bodo@openssl.org</td><td> </td><td class="right">   bodo@openssl.org</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Magnus Nystrom</td><td> </td><td class="right">   Magnus Nystrom</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   RSA Security</td><td> </td><td class="right">   RSA Security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   magnus@rsasecurity.com</td><td> </td><td class="right">   magnus@rsasecurity.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0090" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Alfredo Pironti</td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   Alfredo Pironti <span class="insert">(co-author of {{I-D.ietf-tls-session-hash}})</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   INRIA</td><td> </td><td class="right">   INRIA</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   alfredo.pironti@inria.fr</td><td> </td><td class="right">   alfredo.pironti@inria.fr</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0091" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">Marsh Ray (co-author of {{I-D.ietf-tls-session-hash}})</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Microsoft</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   maray@microsoft.com</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Robert Relyea</td><td> </td><td class="right">   Robert Relyea</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Netscape Communications</td><td> </td><td class="right">   Netscape Communications</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   relyea@netscape.com</td><td> </td><td class="right">   relyea@netscape.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Jim Roskind</td><td> </td><td class="right">   Jim Roskind</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Netscape Communications</td><td> </td><td class="right">   Netscape Communications</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   jar@netscape.com</td><td> </td><td class="right">   jar@netscape.com</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Michael Sabin</td><td> </td><td class="right">   Michael Sabin</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 91 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>250 lines changed or deleted</i></th><th><i> </i></th><th><i>323 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.34. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
