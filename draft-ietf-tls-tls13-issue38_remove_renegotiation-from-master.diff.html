<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.34: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Darwin dhcp-8e78.meeting.ietf.org 13.4.0 Darwin Kernel Version 13.4.0: Sun Aug 17 19:50:11 PDT 2014; root:xnu-2422.115.4~1/RELEASE_X86_64 x86_64 --> 
<!-- Using awk: /opt/local/bin/gawk: GNU Awk 4.1.1, API: 1.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 2.8.1 --> 
<!-- Using wdiff: /opt/local/bin/wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: draft-ietf-tls-tls13-master.txt - draft-ietf-tls-tls13-issue38_remove_renegotiation.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;draft-ietf-tls-tls13-master.txt&nbsp;</th><th> </th><th>&nbsp;draft-ietf-tls-tls13-issue38_remove_renegotiation.txt&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> page 2, line 35</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> page 2, line 35</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     1.3.  Major Differences from TLS 1.1  . . . . . . . . . . . . .   6</td><td> </td><td class="right">     1.3.  Major Differences from TLS 1.1  . . . . . . . . . . . . .   6</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   2.  Goals . . . . . . . . . . . . . . . . . . . . . . . . . . . .   7</td><td> </td><td class="right">   2.  Goals . . . . . . . . . . . . . . . . . . . . . . . . . . . .   7</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   3.  Goals of This Document  . . . . . . . . . . . . . . . . . . .   8</td><td> </td><td class="right">   3.  Goals of This Document  . . . . . . . . . . . . . . . . . . .   8</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   4.  Presentation Language . . . . . . . . . . . . . . . . . . . .   8</td><td> </td><td class="right">   4.  Presentation Language . . . . . . . . . . . . . . . . . . . .   8</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.1.  Basic Block Size  . . . . . . . . . . . . . . . . . . . .   8</td><td> </td><td class="right">     4.1.  Basic Block Size  . . . . . . . . . . . . . . . . . . . .   8</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.2.  Miscellaneous . . . . . . . . . . . . . . . . . . . . . .   9</td><td> </td><td class="right">     4.2.  Miscellaneous . . . . . . . . . . . . . . . . . . . . . .   9</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.3.  Vectors . . . . . . . . . . . . . . . . . . . . . . . . .   9</td><td> </td><td class="right">     4.3.  Vectors . . . . . . . . . . . . . . . . . . . . . . . . .   9</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.4.  Numbers . . . . . . . . . . . . . . . . . . . . . . . . .  10</td><td> </td><td class="right">     4.4.  Numbers . . . . . . . . . . . . . . . . . . . . . . . . .  10</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.5.  Enumerateds . . . . . . . . . . . . . . . . . . . . . . .  10</td><td> </td><td class="right">     4.5.  Enumerateds . . . . . . . . . . . . . . . . . . . . . . .  10</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.6.  Constructed Types . . . . . . . . . . . . . . . . . . . .  11</td><td> </td><td class="right">     4.6.  Constructed Types . . . . . . . . . . . . . . . . . . . .  11</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       4.6.1.  Variants  . . . . . . . . . . . . . . . . . . . . . .  1<span class="delete">1</span></td><td> </td><td class="rblock">       4.6.1.  Variants  . . . . . . . . . . . . . . . . . . . . . .  1<span class="insert">2</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     4.7.  Cryptographic Attributes  . . . . . . . . . . . . . . . .  13</td><td> </td><td class="right">     4.7.  Cryptographic Attributes  . . . . . . . . . . . . . . . .  13</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     4.8.  Constants . . . . . . . . . . . . . . . . . . . . . . . .  1<span class="delete">4</span></td><td> </td><td class="rblock">     4.8.  Constants . . . . . . . . . . . . . . . . . . . . . . . .  1<span class="insert">5</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   5.  The Pseudorandom Function . . . . . . . . . . . . . . . . . .  15</td><td> </td><td class="right">   5.  The Pseudorandom Function . . . . . . . . . . . . . . . . . .  15</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   6.  The TLS Record Protocol . . . . . . . . . . . . . . . . . . .  16</td><td> </td><td class="right">   6.  The TLS Record Protocol . . . . . . . . . . . . . . . . . . .  16</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     6.1.  Connection States . . . . . . . . . . . . . . . . . . . .  17</td><td> </td><td class="right">     6.1.  Connection States . . . . . . . . . . . . . . . . . . . .  17</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     6.2.  Record Layer  . . . . . . . . . . . . . . . . . . . . . .  19</td><td> </td><td class="right">     6.2.  Record Layer  . . . . . . . . . . . . . . . . . . . . . .  19</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       6.2.1.  Fragmentation . . . . . . . . . . . . . . . . . . . .  19</td><td> </td><td class="right">       6.2.1.  Fragmentation . . . . . . . . . . . . . . . . . . . .  19</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       6.2.2.  Record Payload Protection . . . . . . . . . . . . . .  <span class="delete">20</span></td><td> </td><td class="rblock">       6.2.2.  Record Payload Protection . . . . . . . . . . . . . .  <span class="insert">21</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     6.3.  Key Calculation . . . . . . . . . . . . . . . . . . . . .  <span class="delete">22</span></td><td> </td><td class="rblock">     6.3.  Key Calculation . . . . . . . . . . . . . . . . . . . . .  <span class="insert">23</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   7.  The TLS Handshaking Protocols . . . . . . . . . . . . . . . .  23</td><td> </td><td class="right">   7.  The TLS Handshaking Protocols . . . . . . . . . . . . . . . .  23</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     7.1.  Change Cipher Spec Protocol . . . . . . . . . . . . . . .  24</td><td> </td><td class="right">     7.1.  Change Cipher Spec Protocol . . . . . . . . . . . . . . .  24</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     7.2.  Alert Protocol  . . . . . . . . . . . . . . . . . . . . .  <span class="delete">24</span></td><td> </td><td class="rblock">     7.2.  Alert Protocol  . . . . . . . . . . . . . . . . . . . . .  <span class="insert">25</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       7.2.1.  Closure Alerts  . . . . . . . . . . . . . . . . . . .  <span class="delete">25</span></td><td> </td><td class="rblock">       7.2.1.  Closure Alerts  . . . . . . . . . . . . . . . . . . .  <span class="insert">26</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       7.2.2.  Error Alerts  . . . . . . . . . . . . . . . . . . . .  <span class="delete">26</span></td><td> </td><td class="rblock">       7.2.2.  Error Alerts  . . . . . . . . . . . . . . . . . . . .  <span class="insert">27</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     7.3.  Handshake Protocol Overview . . . . . . . . . . . . . . .  30</td><td> </td><td class="right">     7.3.  Handshake Protocol Overview . . . . . . . . . . . . . . .  30</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     7.4.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="delete">34</span></td><td> </td><td class="rblock">     7.4.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="insert">35</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       7.4.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  <span class="delete">35</span></td><td> </td><td class="rblock">       7.4.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  <span class="insert">36</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.4.2.  Client Key Share Message  . . . . . . . . . . . . . .  39</td><td> </td><td class="right">       7.4.2.  Client Key Share Message  . . . . . . . . . . . . . .  39</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.4.3.  Server Key Share Message  . . . . . . . . . . . . . .  52</td><td> </td><td class="right">       7.4.3.  Server Key Share Message  . . . . . . . . . . . . . .  52</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.4.4.  Encrypted Extensions  . . . . . . . . . . . . . . . .  52</td><td> </td><td class="right">       7.4.4.  Encrypted Extensions  . . . . . . . . . . . . . . . .  52</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.4.5.  Server Certificate  . . . . . . . . . . . . . . . . .  53</td><td> </td><td class="right">       7.4.5.  Server Certificate  . . . . . . . . . . . . . . . . .  53</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.4.6.  Certificate Request . . . . . . . . . . . . . . . . .  55</td><td> </td><td class="right">       7.4.6.  Certificate Request . . . . . . . . . . . . . . . . .  55</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.4.7.  Server Certificate Verify . . . . . . . . . . . . . .  57</td><td> </td><td class="right">       7.4.7.  Server Certificate Verify . . . . . . . . . . . . . .  57</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.4.8.  Server Finished . . . . . . . . . . . . . . . . . . .  58</td><td> </td><td class="right">       7.4.8.  Server Finished . . . . . . . . . . . . . . . . . . .  58</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.4.9.  Client Certificate  . . . . . . . . . . . . . . . . .  60</td><td> </td><td class="right">       7.4.9.  Client Certificate  . . . . . . . . . . . . . . . . .  60</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.4.10. Client Certificate Verify . . . . . . . . . . . . . .  61</td><td> </td><td class="right">       7.4.10. Client Certificate Verify . . . . . . . . . . . . . .  61</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   8.  Cryptographic Computations  . . . . . . . . . . . . . . . . .  62</td><td> </td><td class="right">   8.  Cryptographic Computations  . . . . . . . . . . . . . . . . .  62</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> page 3, line 48</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> page 3, line 48</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Appendix B.  Glossary . . . . . . . . . . . . . . . . . . . . . .  78</td><td> </td><td class="right">   Appendix B.  Glossary . . . . . . . . . . . . . . . . . . . . . .  78</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Appendix C.  Cipher Suite Definitions . . . . . . . . . . . . . .  81</td><td> </td><td class="right">   Appendix C.  Cipher Suite Definitions . . . . . . . . . . . . . .  81</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Appendix D.  Implementation Notes . . . . . . . . . . . . . . . .  81</td><td> </td><td class="right">   Appendix D.  Implementation Notes . . . . . . . . . . . . . . . .  81</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     D.1.  Random Number Generation and Seeding  . . . . . . . . . .  81</td><td> </td><td class="right">     D.1.  Random Number Generation and Seeding  . . . . . . . . . .  81</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     D.2.  Certificates and Authentication . . . . . . . . . . . . .  82</td><td> </td><td class="right">     D.2.  Certificates and Authentication . . . . . . . . . . . . .  82</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     D.3.  Cipher Suites . . . . . . . . . . . . . . . . . . . . . .  82</td><td> </td><td class="right">     D.3.  Cipher Suites . . . . . . . . . . . . . . . . . . . . . .  82</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     D.4.  Implementation Pitfalls . . . . . . . . . . . . . . . . .  82</td><td> </td><td class="right">     D.4.  Implementation Pitfalls . . . . . . . . . . . . . . . . .  82</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Appendix E.  Backward Compatibility . . . . . . . . . . . . . . .  83</td><td> </td><td class="right">   Appendix E.  Backward Compatibility . . . . . . . . . . . . . . .  83</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     E.1.  Compatibility with TLS 1.0/1.1 and SSL 3.0  . . . . . . .  83</td><td> </td><td class="right">     E.1.  Compatibility with TLS 1.0/1.1 and SSL 3.0  . . . . . . .  83</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     E.2.  Compatibility with SSL 2.0  . . . . . . . . . . . . . . .  85</td><td> </td><td class="right">     E.2.  Compatibility with SSL 2.0  . . . . . . . . . . . . . . .  85</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.3.  Avoiding Man-in-the-Middle Version Rollback . . . . . . .  8<span class="delete">7</span></td><td> </td><td class="rblock">     E.3.  Avoiding Man-in-the-Middle Version Rollback . . . . . . .  8<span class="insert">6</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Appendix F.  Security Analysis  . . . . . . . . . . . . . . . . .  87</td><td> </td><td class="right">   Appendix F.  Security Analysis  . . . . . . . . . . . . . . . . .  87</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     F.1.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  87</td><td> </td><td class="right">     F.1.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  87</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       F.1.1.  Authentication and Key Exchange . . . . . . . . . . .  87</td><td> </td><td class="right">       F.1.1.  Authentication and Key Exchange . . . . . . . . . . .  87</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.2.  Version Rollback Attacks  . . . . . . . . . . . . . .  8<span class="delete">9</span></td><td> </td><td class="rblock">       F.1.2.  Version Rollback Attacks  . . . . . . . . . . . . . .  8<span class="insert">8</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       F.1.3.  Detecting Attacks Against the Handshake Protocol  . .  89</td><td> </td><td class="right">       F.1.3.  Detecting Attacks Against the Handshake Protocol  . .  89</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       F.1.4.  Resuming Sessions . . . . . . . . . . . . . . . . . .  89</td><td> </td><td class="right">       F.1.4.  Resuming Sessions . . . . . . . . . . . . . . . . . .  89</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.2.  Protecting Application Data . . . . . . . . . . . . . . .  <span class="delete">90</span></td><td> </td><td class="rblock">     F.2.  Protecting Application Data . . . . . . . . . . . . . . .  <span class="insert">89</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     F.3.  Denial of Service . . . . . . . . . . . . . . . . . . . .  90</td><td> </td><td class="right">     F.3.  Denial of Service . . . . . . . . . . . . . . . . . . . .  90</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     F.4.  Final Notes . . . . . . . . . . . . . . . . . . . . . . .  90</td><td> </td><td class="right">     F.4.  Final Notes . . . . . . . . . . . . . . . . . . . . . . .  90</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix G.  Working Group Information  . . . . . . . . . . . . .  9<span class="delete">1</span></td><td> </td><td class="rblock">   Appendix G.  Working Group Information  . . . . . . . . . . . . .  9<span class="insert">0</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Appendix H.  Contributors . . . . . . . . . . . . . . . . . . . .  91</td><td> </td><td class="right">   Appendix H.  Contributors . . . . . . . . . . . . . . . . . . . .  91</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   DISCLAIMER: This is a WIP draft of TLS 1.3 and has not yet seen</td><td> </td><td class="right">   DISCLAIMER: This is a WIP draft of TLS 1.3 and has not yet seen</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   significant security analysis.</td><td> </td><td class="right">   significant security analysis.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</td><td> </td><td class="right">   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   draft is maintained in GitHub.  Suggested changes should be submitted</td><td> </td><td class="right">   draft is maintained in GitHub.  Suggested changes should be submitted</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   as pull requests at https://github.com/tlswg/tls13-spec.</td><td> </td><td class="right">   as pull requests at https://github.com/tlswg/tls13-spec.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> page 5, line 38</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> page 5, line 38</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of protocols that run on top of TLS.</td><td> </td><td class="right">   of protocols that run on top of TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.1.  Requirements Terminology</td><td> </td><td class="right">1.1.  Requirements Terminology</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td> </td><td class="right">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this</td><td> </td><td class="right">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   document are to be interpreted as described in RFC 2119 [RFC2119].</td><td> </td><td class="right">   document are to be interpreted as described in RFC 2119 [RFC2119].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.2.  Major Differences from TLS 1.2</td><td> </td><td class="right">1.2.  Major Differences from TLS 1.2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">draft-04</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   -  Remove renegotiation.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   draft-03</td><td> </td><td class="right">   draft-03</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Remove GMT time.</td><td> </td><td class="right">   -  Remove GMT time.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Merge in support for ECC from RFC 4492 but without explicit</td><td> </td><td class="right">   -  Merge in support for ECC from RFC 4492 but without explicit</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      curves.</td><td> </td><td class="right">      curves.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Remove the unnecessary length field from the AD input to AEAD</td><td> </td><td class="right">   -  Remove the unnecessary length field from the AD input to AEAD</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ciphers.</td><td> </td><td class="right">      ciphers.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Rename {Client,Server}KeyExchange to {Client,Server}KeyShare</td><td> </td><td class="right">   -  Rename {Client,Server}KeyExchange to {Client,Server}KeyShare</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Add an explicit HelloRetryRequest to reject the client's</td><td> </td><td class="right">   -  Add an explicit HelloRetryRequest to reject the client's</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">draft-02</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Increment version number.</td><td> </td><td class="right">   -  Increment version number.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Reworked handshake to provide 1-RTT mode.</td><td> </td><td class="right">   -  Reworked handshake to provide 1-RTT mode.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Remove custom DHE groups.</td><td> </td><td class="right">   -  Remove custom DHE groups.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Removed support for compression.</td><td> </td><td class="right">   -  Removed support for compression.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Removed support for static RSA and DH key exchange.</td><td> </td><td class="right">   -  Removed support for static RSA and DH key exchange.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> page 19, line 10</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> page 19, line 34</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The current state of the encryption algorithm.  This will consist</td><td> </td><td class="right">      The current state of the encryption algorithm.  This will consist</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      of the scheduled key for that connection.</td><td> </td><td class="right">      of the scheduled key for that connection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sequence number</td><td> </td><td class="right">   sequence number</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Each connection state contains a sequence number, which is</td><td> </td><td class="right">      Each connection state contains a sequence number, which is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      maintained separately for read and write states.  The sequence</td><td> </td><td class="right">      maintained separately for read and write states.  The sequence</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      number MUST be set to zero whenever a connection state is made the</td><td> </td><td class="right">      number MUST be set to zero whenever a connection state is made the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      active state.  Sequence numbers are of type uint64 and may not</td><td> </td><td class="right">      active state.  Sequence numbers are of type uint64 and may not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      exceed 2^64-1.  Sequence numbers do not wrap.  If a TLS</td><td> </td><td class="right">      exceed 2^64-1.  Sequence numbers do not wrap.  If a TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      implementation would need to wrap a sequence number, it must</td><td> </td><td class="right">      implementation would need to wrap a sequence number, it must</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">renegotiate instead.</span>  A sequence number is incremented after each</td><td> </td><td class="rblock">      <span class="insert">terminate the connection.</span>  A sequence number is incremented after</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      record: specifically, the first record transmitted under a</td><td> </td><td class="rblock">      each record: specifically, the first record transmitted under a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      particular connection state MUST use sequence number 0.</td><td> </td><td class="right">      particular connection state MUST use sequence number 0.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">6.2.  Record Layer</td><td> </td><td class="right">6.2.  Record Layer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TLS record layer receives uninterpreted data from higher layers</td><td> </td><td class="right">   The TLS record layer receives uninterpreted data from higher layers</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in non-empty blocks of arbitrary size.</td><td> </td><td class="right">   in non-empty blocks of arbitrary size.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">6.2.1.  Fragmentation</td><td> </td><td class="right">6.2.1.  Fragmentation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The record layer fragments information blocks into TLSPlaintext</td><td> </td><td class="right">   The record layer fragments information blocks into TLSPlaintext</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> page 20, line 24</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> page 21, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   fragment</td><td> </td><td class="right">   fragment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The application data.  This data is transparent and treated as an</td><td> </td><td class="right">      The application data.  This data is transparent and treated as an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      independent block to be dealt with by the higher-level protocol</td><td> </td><td class="right">      independent block to be dealt with by the higher-level protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      specified by the type field.</td><td> </td><td class="right">      specified by the type field.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations MUST NOT send zero-length fragments of Handshake,</td><td> </td><td class="right">   Implementations MUST NOT send zero-length fragments of Handshake,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Alert, or ChangeCipherSpec content types.  Zero-length fragments of</td><td> </td><td class="right">   Alert, or ChangeCipherSpec content types.  Zero-length fragments of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Application data MAY be sent as they are potentially useful as a</td><td> </td><td class="right">   Application data MAY be sent as they are potentially useful as a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   traffic analysis countermeasure.</td><td> </td><td class="right">   traffic analysis countermeasure.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">Note: Data of different TLS record layer content types MAY be</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   interleaved.  Application data is generally of lower precedence for</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   transmission than other content types.  However, records MUST be</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   delivered to the network in the same order as they are protected by</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   the record layer.  Recipients MUST receive and process interleaved</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   application layer traffic during handshakes subsequent to the first</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   one on a connection.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">6.2.2.  Record Payload Protection</td><td> </td><td class="right">6.2.2.  Record Payload Protection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The record protection functions translate a TLSPlaintext structure</td><td> </td><td class="right">   The record protection functions translate a TLSPlaintext structure</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   into a TLSCiphertext.  The deprotection functions reverse the</td><td> </td><td class="right">   into a TLSCiphertext.  The deprotection functions reverse the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   process.  In TLS 1.3 as opposed to previous versions of TLS, all</td><td> </td><td class="right">   process.  In TLS 1.3 as opposed to previous versions of TLS, all</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ciphers are modelled as "Authenticated Encryption with Additional</td><td> </td><td class="right">   ciphers are modelled as "Authenticated Encryption with Additional</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Data" (AEAD) [RFC5116].  AEAD functions provide a unified encryption</td><td> </td><td class="right">   Data" (AEAD) [RFC5116].  AEAD functions provide a unified encryption</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and authentication operation which turns plaintext into authenticated</td><td> </td><td class="right">   and authentication operation which turns plaintext into authenticated</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ciphertext and back again.</td><td> </td><td class="right">   ciphertext and back again.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> page 29, line 40</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> page 30, line 35</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   user_canceled</td><td> </td><td class="right">   user_canceled</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This handshake is being canceled for some reason unrelated to a</td><td> </td><td class="right">      This handshake is being canceled for some reason unrelated to a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      protocol failure.  If the user cancels an operation after the</td><td> </td><td class="right">      protocol failure.  If the user cancels an operation after the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      handshake is complete, just closing the connection by sending a</td><td> </td><td class="right">      handshake is complete, just closing the connection by sending a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      close_notify is more appropriate.  This alert should be followed</td><td> </td><td class="right">      close_notify is more appropriate.  This alert should be followed</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      by a close_notify.  This message is generally a warning.</td><td> </td><td class="right">      by a close_notify.  This message is generally a warning.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   no_renegotiation</td><td> </td><td class="right">   no_renegotiation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Sent by the client in response to a hello request or by the server</td><td> </td><td class="right">      Sent by the client in response to a hello request or by the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      in response to a client hello after initial handshaking.  <span class="delete">Either</span></td><td> </td><td class="rblock">      in response to a client hello after initial handshaking.  <span class="insert">Versions</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      of <span class="delete">these would normally lead</span> to <span class="delete">renegotiation; when that is not</span></td><td> </td><td class="rblock">      of <span class="insert">TLS prior</span> to <span class="insert">TLS 1.3 supported renegotiation of</span> a <span class="insert">previously</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      appropriate, the recipient should respond with this alert.  At</span></td><td> </td><td class="rblock"><span class="insert">      established connection; TLS 1.3 removes this feature.</span>  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      that point, the original requester can decide whether to proceed</span></td><td> </td><td class="rblock">      message is always <span class="insert">fatal.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      with the connection.  One case where this would be appropriate is</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      where a server has spawned a process to satisfy</span> a <span class="delete">request; the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      process might receive security parameters (key length,</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      authentication, etc.) at startup, and it might be difficult to</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      communicate changes to these parameters after that point.</span>  This</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      message is always <span class="delete">a warning.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   unsupported_extension</td><td> </td><td class="right">   unsupported_extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      sent by clients that receive an extended server hello containing</td><td> </td><td class="right">      sent by clients that receive an extended server hello containing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      an extension that they did not put in the corresponding client</td><td> </td><td class="right">      an extension that they did not put in the corresponding client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      hello.  This message is always fatal.</td><td> </td><td class="right">      hello.  This message is always fatal.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   New Alert values are assigned by IANA as described in Section 12.</td><td> </td><td class="right">   New Alert values are assigned by IANA as described in Section 12.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.3.  Handshake Protocol Overview</td><td> </td><td class="right">7.3.  Handshake Protocol Overview</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> page 35, line 6</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> page 36, line 6</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.4.  Handshake Protocol</td><td> </td><td class="right">7.4.  Handshake Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TLS Handshake Protocol is one of the defined higher-level clients</td><td> </td><td class="right">   The TLS Handshake Protocol is one of the defined higher-level clients</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of the TLS Record Protocol.  This protocol is used to negotiate the</td><td> </td><td class="right">   of the TLS Record Protocol.  This protocol is used to negotiate the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   secure attributes of a session.  Handshake messages are supplied to</td><td> </td><td class="right">   secure attributes of a session.  Handshake messages are supplied to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the TLS record layer, where they are encapsulated within one or more</td><td> </td><td class="right">   the TLS record layer, where they are encapsulated within one or more</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLSPlaintext structures, which are processed and transmitted as</td><td> </td><td class="right">   TLSPlaintext structures, which are processed and transmitted as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   specified by the current active session state.</td><td> </td><td class="right">   specified by the current active session state.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      enum {</td><td> </td><td class="right">      enum {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          <span class="delete">hello_request</span>(0), client_hello(1), server_hello(2),</td><td> </td><td class="rblock">          <span class="insert">reserved</span>(0), client_hello(1), server_hello(2),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          certificate(11), reserved(12), server_key_share (17),</td><td> </td><td class="right">          certificate(11), reserved(12), server_key_share (17),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          certificate_request(13), certificate_verify(15),</td><td> </td><td class="right">          certificate_request(13), certificate_verify(15),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          reserved(16), client_key_share(18), finished(20), (255)</td><td> </td><td class="right">          reserved(16), client_key_share(18), finished(20), (255)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } HandshakeType;</td><td> </td><td class="right">      } HandshakeType;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      struct {</td><td> </td><td class="right">      struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          HandshakeType msg_type;    /* handshake type */</td><td> </td><td class="right">          HandshakeType msg_type;    /* handshake type */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint24 length;             /* bytes in message */</td><td> </td><td class="right">          uint24 length;             /* bytes in message */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          select (HandshakeType) {</td><td> </td><td class="right">          select (HandshakeType) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">              case hello_request:       HelloRequest;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case client_hello:        ClientHello;</td><td> </td><td class="right">              case client_hello:        ClientHello;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case client_key_share:    ClientKeyShare;</td><td> </td><td class="right">              case client_key_share:    ClientKeyShare;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case server_hello:        ServerHello;</td><td> </td><td class="right">              case server_hello:        ServerHello;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case hello_retry_requst:  HelloRetryRequest;</td><td> </td><td class="right">              case hello_retry_requst:  HelloRetryRequest;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case server_key_share:    ServerKeyShare;</td><td> </td><td class="right">              case server_key_share:    ServerKeyShare;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case certificate:         Certificate;</td><td> </td><td class="right">              case certificate:         Certificate;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case certificate_request: CertificateRequest;</td><td> </td><td class="right">              case certificate_request: CertificateRequest;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case certificate_verify:  CertificateVerify;</td><td> </td><td class="right">              case certificate_verify:  CertificateVerify;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              case finished:            Finished;</td><td> </td><td class="right">              case finished:            Finished;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          } body;</td><td> </td><td class="right">          } body;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      } Handshake;</td><td> </td><td class="right">      } Handshake;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The handshake protocol messages are presented below in the order they</td><td> </td><td class="right">   The handshake protocol messages are presented below in the order they</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   MUST be sent; sending handshake messages in an unexpected order</td><td> </td><td class="right">   MUST be sent; sending handshake messages in an unexpected order</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   results in a fatal error.  Unneeded handshake messages can be</td><td> </td><td class="right">   results in a fatal error.  Unneeded handshake messages can be</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   omitted, however.  <span class="delete">The one message that is not bound by these</span></td><td> </td><td class="rblock">   omitted, however.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   ordering rules is the HelloRequest message, which can be sent at any</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   time, but which SHOULD be ignored by the client if it arrives in the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   middle of a handshake.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   New handshake message types are assigned by IANA as described in</td><td> </td><td class="right">   New handshake message types are assigned by IANA as described in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Section 12.</td><td> </td><td class="right">   Section 12.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.4.1.  Hello Messages</td><td> </td><td class="right">7.4.1.  Hello Messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The hello phase messages are used to exchange security enhancement</td><td> </td><td class="right">   The hello phase messages are used to exchange security enhancement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   capabilities between the client and server.  When a new session</td><td> </td><td class="right">   capabilities between the client and server.  When a new session</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   begins, the record layer's connection state AEAD algorithm is</td><td> </td><td class="right">   begins, the record layer's connection state AEAD algorithm is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   initialized to NULL_NULL.  The current connection state is used for</td><td> </td><td class="right">   initialized to NULL_NULL.  The current connection state is used for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   renegotiation messages.</td><td> </td><td class="right">   renegotiation messages.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">7.4.1.1.  <span class="delete">Hello Request</span></td><td> </td><td class="rblock">7.4.1.1.  Client Hello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   When this message will be sent:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      The HelloRequest message MAY be sent by the server at any time.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Meaning of this message:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      HelloRequest is a simple notification that the client should begin</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      the negotiation process anew.  In response, the client should send</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      a ClientHello message when convenient.  This message is not</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      intended to establish which side is the client or server but</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      merely to initiate a new negotiation.  Servers SHOULD NOT send a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      HelloRequest immediately upon the client's initial connection.  It</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      is the client's job to send a ClientHello at that time.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      This message will be ignored by the client if the client is</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      currently negotiating a session.  This message MAY be ignored by</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      the client if it does not wish to renegotiate a session, or the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      client may, if it wishes, respond with a no_renegotiation alert.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Since handshake messages are intended to have transmission</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      precedence over application data, it is expected that the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      negotiation will begin before no more than a few records are</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      received from the client.  If the server sends a HelloRequest but</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      does not receive a ClientHello in response, it may close the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      connection with a fatal alert.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      After sending a HelloRequest, servers SHOULD NOT repeat the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      request until the subsequent handshake negotiation is complete.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Structure of this message:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      struct { } HelloRequest;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   This message MUST NOT be included in the message hashes that are</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   maintained throughout the handshake and used in the Finished messages</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   and the certificate verify message.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">7.4.1.2.</span>  Client Hello</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      When a client first connects to a server, it is required to send</td><td> </td><td class="right">      When a client first connects to a server, it is required to send</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      the ClientHello as its first message.  The client <span class="delete">can also send a</span></td><td> </td><td class="rblock">      the ClientHello as its first message.  The client will <span class="insert">also</span> send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      ClientHello in response to a HelloRequest or on its own initiative</span></td><td> </td><td class="rblock">      ClientHello when the server has responded to its ClientHello with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      in order to renegotiate the security parameters in an existing</span></td><td> </td><td class="rblock">      a ServerHello that selects cryptographic parameters that don't</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      connection.  Finally, the client</span> will send a ClientHello when the</td><td> </td><td class="rblock">      match the client's ClientKeyShare.  In that case, the client MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      server has responded to its ClientHello with a ServerHello that</td><td> </td><td class="rblock">      send the same ClientHello (without modification) along with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      selects cryptographic parameters that don't match the client's</td><td> </td><td class="rblock">      new ClientKeyShare.  <span class="insert">If a server receives a ClientHello at any</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      ClientKeyShare.  In that case, the client MUST send the same</td><td> </td><td class="rblock"><span class="insert">      other time, it MUST send a fatal no_renegotiation alert.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      ClientHello (without modification) along with the new</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      ClientKeyShare.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Structure of this message:</td><td> </td><td class="right">   Structure of this message:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The ClientHello message includes a random structure, which is used</td><td> </td><td class="right">      The ClientHello message includes a random structure, which is used</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      later in the protocol.</td><td> </td><td class="right">      later in the protocol.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         struct {</td><td> </td><td class="right">         struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">             opaque random_bytes[32];</td><td> </td><td class="right">             opaque random_bytes[32];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         } Random;</td><td> </td><td class="right">         } Random;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> page 39, line 32</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> page 39, line 37</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In the event that a client requests additional functionality using</td><td> </td><td class="right">   In the event that a client requests additional functionality using</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   extensions, and this functionality is not supplied by the server, the</td><td> </td><td class="right">   extensions, and this functionality is not supplied by the server, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client MAY abort the handshake.  A server MUST accept ClientHello</td><td> </td><td class="right">   client MAY abort the handshake.  A server MUST accept ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   messages both with and without the extensions field, and (as for all</td><td> </td><td class="right">   messages both with and without the extensions field, and (as for all</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   other messages) it MUST check that the amount of data in the message</td><td> </td><td class="right">   other messages) it MUST check that the amount of data in the message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   precisely matches one of these formats; if not, then it MUST send a</td><td> </td><td class="right">   precisely matches one of these formats; if not, then it MUST send a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   fatal "decode_error" alert.</td><td> </td><td class="right">   fatal "decode_error" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   After sending the ClientHello message, the client waits for a</td><td> </td><td class="right">   After sending the ClientHello message, the client waits for a</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   ServerHello message.  <span class="delete">Any handshake message returned by the server,</span></td><td> </td><td class="rblock">   ServerHello <span class="insert">or HelloVerifyRequest</span> message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   except for a HelloRequest, is treated as a fatal error.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">7.4.2.  Client Key Share Message</td><td> </td><td class="right">7.4.2.  Client Key Share Message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When this message will be sent:</td><td> </td><td class="right">   When this message will be sent:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This message is always sent by the client.  It MUST immediately</td><td> </td><td class="right">      This message is always sent by the client.  It MUST immediately</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      follow the ClientHello message.  In backward compatibility mode</td><td> </td><td class="right">      follow the ClientHello message.  In backward compatibility mode</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (see Section XXX) it will be included in the EarlyData extension</td><td> </td><td class="right">      (see Section XXX) it will be included in the EarlyData extension</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      (Section 7.4.2.5.4) in the ClientHello.</td><td> </td><td class="right">      (Section 7.4.2.5.4) in the ClientHello.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> page 83, line 11</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> page 83, line 11</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      you fragment handshake messages that exceed the maximum fragment</td><td> </td><td class="right">      you fragment handshake messages that exceed the maximum fragment</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      size?  In particular, the certificate and certificate request</td><td> </td><td class="right">      size?  In particular, the certificate and certificate request</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      handshake messages can be large enough to require fragmentation.</td><td> </td><td class="right">      handshake messages can be large enough to require fragmentation.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Do you ignore the TLS record layer version number in all TLS</td><td> </td><td class="right">   -  Do you ignore the TLS record layer version number in all TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      records before ServerHello (see Appendix E.1)?</td><td> </td><td class="right">      records before ServerHello (see Appendix E.1)?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Do you handle TLS extensions in ClientHello correctly, including</td><td> </td><td class="right">   -  Do you handle TLS extensions in ClientHello correctly, including</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      omitting the extensions field completely?</td><td> </td><td class="right">      omitting the extensions field completely?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">-  Do you support renegotiation, both client and server initiated?</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      While renegotiation is an optional feature, supporting it is</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      highly recommended.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  When the server has requested a client certificate, but no</td><td> </td><td class="right">   -  When the server has requested a client certificate, but no</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      suitable certificate is available, do you correctly send an empty</td><td> </td><td class="right">      suitable certificate is available, do you correctly send an empty</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Certificate message, instead of omitting the whole message (see</td><td> </td><td class="right">      Certificate message, instead of omitting the whole message (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Section 7.4.9)?</td><td> </td><td class="right">      Section 7.4.9)?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Cryptographic details:</td><td> </td><td class="right">   Cryptographic details:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  What countermeasures do you use to prevent timing attacks against</td><td> </td><td class="right">   -  What countermeasures do you use to prevent timing attacks against</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      RSA signing operations [TIMING].</td><td> </td><td class="right">      RSA signing operations [TIMING].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 21 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>93 lines changed or deleted</i></th><th><i> </i></th><th><i>37 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.34. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
