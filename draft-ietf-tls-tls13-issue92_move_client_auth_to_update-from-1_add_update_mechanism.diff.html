<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.34: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Darwin dhcp-8e78.meeting.ietf.org 13.4.0 Darwin Kernel Version 13.4.0: Sun Aug 17 19:50:11 PDT 2014; root:xnu-2422.115.4~1/RELEASE_X86_64 x86_64 --> 
<!-- Using awk: /opt/local/bin/gawk: GNU Awk 4.1.1, API: 1.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 2.8.1 --> 
<!-- Using wdiff: /opt/local/bin/wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: draft-ietf-tls-tls13-issue91_add_update_mechanism.txt - draft-ietf-tls-tls13-issue92_move_client_auth_to_update.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;draft-ietf-tls-tls13-issue91_add_update_mechanism.txt&nbsp;</th><th> </th><th>&nbsp;draft-ietf-tls-tls13-issue92_move_client_auth_to_update.txt&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l1" /><small>skipping to change at</small><em> page 3, line 11</em></th><th> </th><th><a name="part-r1" /><small>skipping to change at</small><em> page 3, line 11</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     7.2.  Handshake Protocol Overview . . . . . . . . . . . . . . .  30</td><td> </td><td class="right">     7.2.  Handshake Protocol Overview . . . . . . . . . . . . . . .  30</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">     7.3.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  34</td><td> </td><td class="right">     7.3.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  34</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  35</td><td> </td><td class="right">       7.3.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  35</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.2.  Client Key Share Message  . . . . . . . . . . . . . .  39</td><td> </td><td class="right">       7.3.2.  Client Key Share Message  . . . . . . . . . . . . . .  39</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.3.  Server Key Share Message  . . . . . . . . . . . . . .  52</td><td> </td><td class="right">       7.3.3.  Server Key Share Message  . . . . . . . . . . . . . .  52</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.4.  Encrypted Extensions  . . . . . . . . . . . . . . . .  52</td><td> </td><td class="right">       7.3.4.  Encrypted Extensions  . . . . . . . . . . . . . . . .  52</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.5.  Server Certificate  . . . . . . . . . . . . . . . . .  53</td><td> </td><td class="right">       7.3.5.  Server Certificate  . . . . . . . . . . . . . . . . .  53</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.6.  Certificate Request . . . . . . . . . . . . . . . . .  55</td><td> </td><td class="right">       7.3.6.  Certificate Request . . . . . . . . . . . . . . . . .  55</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.7.  Server Certificate Verify . . . . . . . . . . . . . .  57</td><td> </td><td class="right">       7.3.7.  Server Certificate Verify . . . . . . . . . . . . . .  57</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       7.3.8.  Server Finished . . . . . . . . . . . . . . . . . . .  58</td><td> </td><td class="right">       7.3.8.  Server Finished . . . . . . . . . . . . . . . . . . .  58</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">7.3.9.  Client Certificate  . . . . . . . . . . . . . . . . .  60</span></td><td> </td><td class="rblock">   8.  Cryptographic Computations  . . . . . . . . . . . . . . . . .  <span class="insert">60</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       7.3.10. Client Certificate Verify . . . . . . . . . . . . . .  61</span></td><td> </td><td class="rblock">     8.1.  Computing the Master Secret . . . . . . . . . . . . . . .  <span class="insert">60</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   8.  Cryptographic Computations  . . . . . . . . . . . . . . . . .  <span class="delete">62</span></td><td> </td><td class="rblock">       8.1.1.  The Session Hash  . . . . . . . . . . . . . . . . . .  <span class="insert">61</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     8.1.  Computing the Master Secret . . . . . . . . . . . . . . .  <span class="delete">62</span></td><td> </td><td class="rblock">       8.1.2.  Diffie-Hellman  . . . . . . . . . . . . . . . . . . .  <span class="insert">62</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       8.1.1.  The Session Hash  . . . . . . . . . . . . . . . . . .  <span class="delete">64</span></td><td> </td><td class="rblock">       8.1.3.  Elliptic Curve Diffie-Hellman . . . . . . . . . . . .  <span class="insert">62</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       8.1.2.  Diffie-Hellman  . . . . . . . . . . . . . . . . . . .  <span class="delete">65</span></td><td> </td><td class="rblock">     8.2.  Update Protocol . . . . . . . . . . . . . . . . . . . . .  <span class="insert">62</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       8.1.3.  Elliptic Curve Diffie-Hellman . . . . . . . . . . . .  <span class="delete">65</span></td><td> </td><td class="rblock">       8.2.1.  General Update Protocol Behavior  . . . . . . . . . .  <span class="insert">63</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     8.2.  Update Protocol . . . . . . . . . . . . . . . . . . . . .  <span class="delete">65</span></td><td> </td><td class="rblock">       8.2.2.  ACK . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">63</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       8.2.1.  General Update Protocol Behavior  . . . . . . . . . .  <span class="delete">66</span></td><td> </td><td class="rblock">       8.2.3.  Rekey . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">64</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       8.2.2.  ACK . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">66</span></td><td> </td><td class="rblock"><span class="insert">       8.2.4.  Authenticate  . . . . . . . . . . . . . . . . . . . .  65</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       8.2.3.  Rekey . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">67</span></td><td> </td><td class="rblock">   9.  Mandatory Cipher Suites . . . . . . . . . . . . . . . . . . .  <span class="insert">67</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   9.  Mandatory Cipher Suites . . . . . . . . . . . . . . . . . . .  <span class="delete">68</span></td><td> </td><td class="rblock">   10. Application Data Protocol . . . . . . . . . . . . . . . . . .  <span class="insert">67</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   10. Application Data Protocol . . . . . . . . . . . . . . . . . .  <span class="delete">68</span></td><td> </td><td class="rblock">   11. Security Considerations . . . . . . . . . . . . . . . . . . .  <span class="insert">67</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   11. Security Considerations . . . . . . . . . . . . . . . . . . .  <span class="delete">68</span></td><td> </td><td class="rblock">   12. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <span class="insert">67</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   12. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <span class="delete">68</span></td><td> </td><td class="rblock">   13. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">68</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   13. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">69</span></td><td> </td><td class="rblock">     13.1.  Normative References . . . . . . . . . . . . . . . . . .  <span class="insert">69</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     13.1.  Normative References . . . . . . . . . . . . . . . . . .  <span class="delete">70</span></td><td> </td><td class="rblock">     13.2.  Informative References . . . . . . . . . . . . . . . . .  <span class="insert">70</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     13.2.  Informative References . . . . . . . . . . . . . . . . .  <span class="delete">71</span></td><td> </td><td class="rblock">     13.3.  URIs . . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">73</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     13.3.  URIs . . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">74</span></td><td> </td><td class="rblock">   Appendix A.  Protocol Data Structures and Constant Values . . . .  <span class="insert">74</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix A.  Protocol Data Structures and Constant Values . . . .  <span class="delete">75</span></td><td> </td><td class="rblock">     A.1.  Record Layer  . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">74</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.1.  Record Layer  . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">75</span></td><td> </td><td class="rblock">     A.2.  Change Cipher Specs Message . . . . . . . . . . . . . . .  <span class="insert">74</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.2.  Change Cipher Specs Message . . . . . . . . . . . . . . .  <span class="delete">75</span></td><td> </td><td class="rblock">     A.3.  Alert Messages  . . . . . . . . . . . . . . . . . . . . .  <span class="insert">74</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.3.  Alert Messages  . . . . . . . . . . . . . . . . . . . . .  <span class="delete">75</span></td><td> </td><td class="rblock">     A.4.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="insert">75</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.4.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="delete">76</span></td><td> </td><td class="rblock">       A.4.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  <span class="insert">76</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.1.  Hello Messages  . . . . . . . . . . . . . . . . . . .  <span class="delete">77</span></td><td> </td><td class="rblock">       A.4.2.  Server Authentication and Key Exchange Messages . . .  <span class="insert">78</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.2.  Server Authentication and Key Exchange Messages . . .  <span class="delete">79</span></td><td> </td><td class="rblock">       A.4.3.  Client Authentication and Key Exchange Messages . . .  <span class="insert">78</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.3.  Client Authentication and Key Exchange Messages . . .  <span class="delete">79</span></td><td> </td><td class="rblock">       A.4.4.  Handshake Finalization Message  . . . . . . . . . . .  <span class="insert">79</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       A.4.4.  Handshake Finalization Message  . . . . . . . . . . .  <span class="delete">80</span></td><td> </td><td class="rblock">     A.5.  The Cipher Suite  . . . . . . . . . . . . . . . . . . . .  <span class="insert">79</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.5.  The Cipher Suite  . . . . . . . . . . . . . . . . . . . .  <span class="delete">80</span></td><td> </td><td class="rblock">     A.6.  The Security Parameters . . . . . . . . . . . . . . . . .  <span class="insert">81</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.6.  The Security Parameters . . . . . . . . . . . . . . . . .  <span class="delete">82</span></td><td> </td><td class="rblock">     A.7.  Changes to RFC 4492 . . . . . . . . . . . . . . . . . . .  <span class="insert">81</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     A.7.  Changes to RFC 4492 . . . . . . . . . . . . . . . . . . .  <span class="delete">82</span></td><td> </td><td class="rblock">   Appendix B.  Glossary . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">82</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix B.  Glossary . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">83</span></td><td> </td><td class="rblock">   Appendix C.  Cipher Suite Definitions . . . . . . . . . . . . . .  <span class="insert">85</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix C.  Cipher Suite Definitions . . . . . . . . . . . . . .  <span class="delete">86</span></td><td> </td><td class="rblock">   Appendix D.  Implementation Notes . . . . . . . . . . . . . . . .  <span class="insert">85</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix D.  Implementation Notes . . . . . . . . . . . . . . . .  <span class="delete">86</span></td><td> </td><td class="rblock">     D.1.  Random Number Generation and Seeding  . . . . . . . . . .  <span class="insert">85</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.1.  Random Number Generation and Seeding  . . . . . . . . . .  <span class="delete">86</span></td><td> </td><td class="rblock">     D.2.  Certificates and Authentication . . . . . . . . . . . . .  <span class="insert">86</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.2.  Certificates and Authentication . . . . . . . . . . . . .  <span class="delete">87</span></td><td> </td><td class="rblock">     D.3.  Cipher Suites . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">86</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.3.  Cipher Suites . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">87</span></td><td> </td><td class="rblock">     D.4.  Implementation Pitfalls . . . . . . . . . . . . . . . . .  <span class="insert">86</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     D.4.  Implementation Pitfalls . . . . . . . . . . . . . . . . .  <span class="delete">87</span></td><td> </td><td class="rblock">   Appendix E.  Backward Compatibility . . . . . . . . . . . . . . .  <span class="insert">87</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix E.  Backward Compatibility . . . . . . . . . . . . . . .  <span class="delete">88</span></td><td> </td><td class="rblock">     E.1.  Compatibility with TLS 1.0/1.1 and SSL 3.0  . . . . . . .  <span class="insert">87</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.1.  Compatibility with TLS 1.0/1.1 and SSL 3.0  . . . . . . .  <span class="delete">88</span></td><td> </td><td class="rblock">     E.2.  Compatibility with SSL 2.0  . . . . . . . . . . . . . . .  <span class="insert">89</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.2.  Compatibility with SSL 2.0  . . . . . . . . . . . . . . .  <span class="delete">90</span></td><td> </td><td class="rblock">     E.3.  Avoiding Man-in-the-Middle Version Rollback . . . . . . .  <span class="insert">91</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     E.3.  Avoiding Man-in-the-Middle Version Rollback . . . . . . .  <span class="delete">92</span></td><td> </td><td class="rblock">   Appendix F.  Security Analysis  . . . . . . . . . . . . . . . . .  <span class="insert">91</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix F.  Security Analysis  . . . . . . . . . . . . . . . . .  <span class="delete">92</span></td><td> </td><td class="rblock">     F.1.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="insert">91</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.1.  Handshake Protocol  . . . . . . . . . . . . . . . . . . .  <span class="delete">92</span></td><td> </td><td class="rblock">       F.1.1.  Authentication and Key Exchange . . . . . . . . . . .  <span class="insert">91</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.1.  Authentication and Key Exchange . . . . . . . . . . .  <span class="delete">92</span></td><td> </td><td class="rblock">       F.1.2.  Version Rollback Attacks  . . . . . . . . . . . . . .  <span class="insert">93</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.2.  Version Rollback Attacks  . . . . . . . . . . . . . .  <span class="delete">94</span></td><td> </td><td class="rblock">       F.1.3.  Detecting Attacks Against the Handshake Protocol  . .  <span class="insert">93</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.3.  Detecting Attacks Against the Handshake Protocol  . .  <span class="delete">94</span></td><td> </td><td class="rblock">       F.1.4.  Resuming Sessions . . . . . . . . . . . . . . . . . .  <span class="insert">93</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       F.1.4.  Resuming Sessions . . . . . . . . . . . . . . . . . .  <span class="delete">94</span></td><td> </td><td class="rblock">     F.2.  Protecting Application Data . . . . . . . . . . . . . . .  <span class="insert">94</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.2.  Protecting Application Data . . . . . . . . . . . . . . .  <span class="delete">95</span></td><td> </td><td class="rblock">     F.3.  Denial of Service . . . . . . . . . . . . . . . . . . . .  <span class="insert">94</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.3.  Denial of Service . . . . . . . . . . . . . . . . . . . .  <span class="delete">95</span></td><td> </td><td class="rblock">     F.4.  Final Notes . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">94</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     F.4.  Final Notes . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">95</span></td><td> </td><td class="rblock">   Appendix G.  Working Group Information  . . . . . . . . . . . . .  <span class="insert">95</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix G.  Working Group Information  . . . . . . . . . . . . .  <span class="delete">96</span></td><td> </td><td class="rblock">   Appendix H.  Contributors . . . . . . . . . . . . . . . . . . . .  <span class="insert">95</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Appendix H.  Contributors . . . . . . . . . . . . . . . . . . . .  <span class="delete">96</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   DISCLAIMER: This is a WIP draft of TLS 1.3 and has not yet seen</td><td> </td><td class="right">   DISCLAIMER: This is a WIP draft of TLS 1.3 and has not yet seen</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   significant security analysis.</td><td> </td><td class="right">   significant security analysis.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</td><td> </td><td class="right">   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   draft is maintained in GitHub.  Suggested changes should be submitted</td><td> </td><td class="right">   draft is maintained in GitHub.  Suggested changes should be submitted</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   as pull requests at https://github.com/tlswg/tls13-spec.</td><td> </td><td class="right">   as pull requests at https://github.com/tlswg/tls13-spec.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Instructions are on that page as well.  Editorial changes can be</td><td> </td><td class="right">   Instructions are on that page as well.  Editorial changes can be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> page 31, line 47</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> page 31, line 47</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   over the handshake keyed by the shared secret and demonstrates that</td><td> </td><td class="right">   over the handshake keyed by the shared secret and demonstrates that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the server and client have agreed upon the same keys.  [[TODO: If the</td><td> </td><td class="right">   the server and client have agreed upon the same keys.  [[TODO: If the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   server is not requesting client authentication, it MAY start sending</td><td> </td><td class="right">   server is not requesting client authentication, it MAY start sending</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   application data following the Finished, though the server has no way</td><td> </td><td class="right">   application data following the Finished, though the server has no way</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of knowing who will be receiving the data.  Add this.]]</td><td> </td><td class="right">   of knowing who will be receiving the data.  Add this.]]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Once the client receives the ServerKeyShare, it can also compute the</td><td> </td><td class="right">   Once the client receives the ServerKeyShare, it can also compute the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   premaster secret and decrypt the server's remaining handshake</td><td> </td><td class="right">   premaster secret and decrypt the server's remaining handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   messages.  The client generates its own sending keys based on the</td><td> </td><td class="right">   messages.  The client generates its own sending keys based on the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   premaster secret and will encrypt the remainder of its handshake</td><td> </td><td class="right">   premaster secret and will encrypt the remainder of its handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   messages using those keys and the newly established cipher suite.  <span class="delete">If</span></td><td> </td><td class="rblock">   messages using those keys and the newly established cipher suite.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   the server has sent a CertificateRequest message, the client MUST</span></td><td> </td><td class="rblock">   <span class="insert">The</span> client <span class="insert">then</span> sends the Finished message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   send the Certificate message, though it may contain zero</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   certificates.  If the client has sent a certificate, a digitally-</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   signed CertificateVerify message is sent to explicitly verify</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   possession of the private key in the certificate.  Finally, the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   client sends the Finished message.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   At this point, the handshake is complete, and the client and server</td><td> </td><td class="right">   At this point, the handshake is complete, and the client and server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   may exchange application layer data, which is protected using a new</td><td> </td><td class="right">   may exchange application layer data, which is protected using a new</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   set of keys derived from both the premaster secret and the handshake</td><td> </td><td class="right">   set of keys derived from both the premaster secret and the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   transcript (see [I-D.ietf-tls-session-hash] for the security</td><td> </td><td class="right">   transcript (see [I-D.ietf-tls-session-hash] for the security</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   rationale for this.)</td><td> </td><td class="right">   rationale for this.)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Application data MUST NOT be sent prior to the Finished message.</td><td> </td><td class="right">   Application data MUST NOT be sent prior to the Finished message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [[TODO: can we make this clearer and more clearly match the text</td><td> </td><td class="right">   [[TODO: can we make this clearer and more clearly match the text</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   above about server-side False Start.]] Client Server</td><td> </td><td class="right">   above about server-side False Start.]] Client Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientHello</td><td> </td><td class="right">      ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientKeyShare            --------&gt;</td><td> </td><td class="right">      ClientKeyShare            --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                      ServerHello</td><td> </td><td class="right">                                                      ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   ServerKeyShare</td><td> </td><td class="right">                                                   ServerKeyShare</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                           {EncryptedExtensions*}</td><td> </td><td class="right">                                           {EncryptedExtensions*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   {Certificate*}</td><td> </td><td class="right">                                                   {Certificate*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                            {CertificateRequest*}</td><td> </td><td class="right">                                            {CertificateRequest*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                             {CertificateVerify*}</td><td> </td><td class="right">                                             {CertificateVerify*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                &lt;--------              {Finished}</td><td> </td><td class="right">                                &lt;--------              {Finished}</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">{Certificate*}</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      {CertificateVerify*}</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      {Finished}                --------&gt;</td><td> </td><td class="right">      {Finished}                --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      [Application Data]        &lt;-------&gt;      [Application Data]</td><td> </td><td class="right">      [Application Data]        &lt;-------&gt;      [Application Data]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               Figure 1.  Message flow for a full handshake</td><td> </td><td class="right">               Figure 1.  Message flow for a full handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   * Indicates optional or situation-dependent messages that are not</td><td> </td><td class="right">   * Indicates optional or situation-dependent messages that are not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   always sent.</td><td> </td><td class="right">   always sent.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   {} Indicates messages protected using keys derived from the handshake</td><td> </td><td class="right">   {} Indicates messages protected using keys derived from the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   master secret.</td><td> </td><td class="right">   master secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> page 33, line 20</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> page 33, line 20</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientHello</td><td> </td><td class="right">      ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientKeyShare            --------&gt;</td><td> </td><td class="right">      ClientKeyShare            --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                      ServerHello</td><td> </td><td class="right">                                                      ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   ServerKeyShare</td><td> </td><td class="right">                                                   ServerKeyShare</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                           {EncryptedExtensions*}</td><td> </td><td class="right">                                           {EncryptedExtensions*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                   {Certificate*}</td><td> </td><td class="right">                                                   {Certificate*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                            {CertificateRequest*}</td><td> </td><td class="right">                                            {CertificateRequest*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                             {CertificateVerify*}</td><td> </td><td class="right">                                             {CertificateVerify*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                &lt;--------              {Finished}</td><td> </td><td class="right">                                &lt;--------              {Finished}</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      <span class="delete">{Certificate*}</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      {CertificateVerify*}</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      {Finished}                --------&gt;</td><td> </td><td class="right">      {Finished}                --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      [Application Data]        &lt;-------&gt;     [Application Data]</td><td> </td><td class="right">      [Application Data]        &lt;-------&gt;     [Application Data]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Figure 2.  Message flow for a full handshake with mismatched</td><td> </td><td class="right">   Figure 2.  Message flow for a full handshake with mismatched</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   parameters</td><td> </td><td class="right">   parameters</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [[OPEN ISSUE: Do we restart the handshake hash?]] [[OPEN ISSUE: We</td><td> </td><td class="right">   [[OPEN ISSUE: Do we restart the handshake hash?]] [[OPEN ISSUE: We</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   need to make sure that this flow doesn't introduce downgrade issues.</td><td> </td><td class="right">   need to make sure that this flow doesn't introduce downgrade issues.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Potential options include continuing the handshake hashes (as long as</td><td> </td><td class="right">   Potential options include continuing the handshake hashes (as long as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   clients don't change their opinion of the server's capabilities with</td><td> </td><td class="right">   clients don't change their opinion of the server's capabilities with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> page 59, line 42</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> page 59, line 42</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake_messages</td><td> </td><td class="right">   handshake_messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      All of the data from all messages in this handshake (not including</td><td> </td><td class="right">      All of the data from all messages in this handshake (not including</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      any HelloRequest messages) up to, but not including, this message.</td><td> </td><td class="right">      any HelloRequest messages) up to, but not including, this message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This is only data visible at the handshake layer and does not</td><td> </td><td class="right">      This is only data visible at the handshake layer and does not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      include record layer headers.  This is the concatenation of all</td><td> </td><td class="right">      include record layer headers.  This is the concatenation of all</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the Handshake structures as defined in Section 7.3, exchanged thus</td><td> </td><td class="right">      the Handshake structures as defined in Section 7.3, exchanged thus</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      far.</td><td> </td><td class="right">      far.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The value handshake_messages includes all handshake messages starting</td><td> </td><td class="right">   The value handshake_messages includes all handshake messages starting</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   at ClientHello up to, but not including, this Finished message.  This</td><td> </td><td class="right">   at ClientHello up to, but not including, this Finished message.  This</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   may be different from handshake_messages in Section <span class="delete">7.3.7 or</span></td><td> </td><td class="rblock">   may be different from handshake_messages in Section <span class="insert">7.3.7.</span>  Also, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Section 7.3.10.</span>  Also, the handshake_messages for the Finished</td><td> </td><td class="rblock">   handshake_messages for the Finished message sent by the client will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   message sent by the client will be different from that for the</td><td> </td><td class="rblock">   be different from that for the Finished message sent by the server,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Finished message sent by the server, because the one that is sent</td><td> </td><td class="rblock">   because the one that is sent second will include the prior one.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   second will include the prior one.</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: Alerts and any other record types are not handshake messages</td><td> </td><td class="right">   Note: Alerts and any other record types are not handshake messages</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and are not included in the hash computations.  Also, HelloRequest</td><td> </td><td class="right">   and are not included in the hash computations.  Also, HelloRequest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   messages are omitted from handshake hashes.</td><td> </td><td class="right">   messages are omitted from handshake hashes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">7.3.9.  Client Certificate</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   When this message will be sent:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      This message is the first handshake message the client can send</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      after receiving the server's Finished This message is only sent if</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      the server requests a certificate.  If no suitable certificate is</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      available, the client MUST send a certificate message containing</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      no certificates.  That is, the certificate_list structure has a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      length of zero.  If the client does not send any certificates, the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      server MAY at its discretion either continue the handshake without</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      client authentication, or respond with a fatal handshake_failure</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      alert.  Also, if some aspect of the certificate chain was</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      unacceptable (e.g., it was not signed by a known, trusted CA), the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      server MAY at its discretion either continue the handshake</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      (considering the client unauthenticated) or send a fatal alert.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Client certificates are sent using the Certificate structure</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      defined in Section 7.3.5.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Meaning of this message:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      This message conveys the client's certificate chain to the server;</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      the server will use it when verifying the CertificateVerify</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      message (when the client authentication is based on signing) or</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      calculating the premaster secret (for non-ephemeral Diffie-</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Hellman).  The certificate MUST be appropriate for the negotiated</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      cipher suite's key exchange algorithm, and any negotiated</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      extensions.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   In particular:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  The certificate type MUST be X.509v3, unless explicitly negotiated</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      otherwise (e.g., [RFC5081]).</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  The end-entity certificate's public key (and associated</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      restrictions) has to be compatible with the certificate types</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      listed in CertificateRequest:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    Client Cert. Type   Certificate Key Type</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    rsa_sign            RSA public key; the certificate MUST allow the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        key to be used for signing with the signature</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        scheme and hash algorithm that will be</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        employed in the certificate verify message.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    dss_sign            DSA public key; the certificate MUST allow the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        key to be used for signing with the hash</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        algorithm that will be employed in the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        certificate verify message.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    ecdsa_sign          ECDSA-capable public key; the certificate MUST</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        allow the key to be used for signing with the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        hash algorithm that will be employed in the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        certificate verify message; the public key</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        MUST use a curve and point format supported by</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        the server.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    rsa_fixed_dh        Diffie-Hellman public key; MUST use the same</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    dss_fixed_dh        parameters as server's key.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    rsa_fixed_ecdh      ECDH-capable public key; MUST use the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">    ecdsa_fixed_ecdh    same curve as the server's key, and MUST use a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">                        point format supported by the server.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  If the certificate_authorities list in the certificate request</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      message was non-empty, one of the certificates in the certificate</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      chain SHOULD be issued by one of the listed CAs.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   -  The certificates MUST be signed using an acceptable hash/</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      signature algorithm pair, as described in Section 7.3.6.  Note</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      that this relaxes the constraints on certificate-signing</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      algorithms found in prior versions of TLS.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   Note that, as with the server certificate, there are certificates</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   that use algorithms/algorithm combinations that cannot be currently</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   used with TLS.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">7.3.10.  Client Certificate Verify</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   When this message will be sent:</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      This message is used to provide explicit verification of a client</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      certificate.  This message is only sent following a client</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      certificate that has signing capability (i.e., all certificates</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      except those containing fixed Diffie-Hellman parameters).  When</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      sent, it MUST immediately follow the client's Certificate message.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      The contents of the message are computed as described in</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Section 7.3.7.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      The hash and signature algorithms used in the signature MUST be</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      one of those present in the supported_signature_algorithms field</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      of the CertificateRequest message.  In addition, the hash and</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      signature algorithms MUST be compatible with the key in the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      client's end-entity certificate.  RSA keys MAY be used with any</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      permitted hash algorithm, subject to restrictions in the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      certificate, if any.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      Because DSA signatures do not contain any secure indication of</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      hash algorithm, there is a risk of hash substitution if multiple</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      hashes may be used with any key.  Currently, DSA [DSS] may only be</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      used with SHA-1.  Future revisions of DSS [DSS-3] are expected to</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      allow the use of other digest algorithms with DSA, as well as</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      guidance as to which digest algorithms should be used with each</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      key size.  In addition, future revisions of [RFC3280] may specify</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      mechanisms for certificates to indicate which digest algorithms</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">      are to be used with DSA.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">8.  Cryptographic Computations</td><td> </td><td class="right">8.  Cryptographic Computations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In order to begin connection protection, the TLS Record Protocol</td><td> </td><td class="right">   In order to begin connection protection, the TLS Record Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   requires specification of a suite of algorithms, a master secret, and</td><td> </td><td class="right">   requires specification of a suite of algorithms, a master secret, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the client and server random values.  The authentication, key</td><td> </td><td class="right">   the client and server random values.  The authentication, key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   agreement, and record protection algorithms are determined by the</td><td> </td><td class="right">   agreement, and record protection algorithms are determined by the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cipher_suite selected by the server and revealed in the ServerHello</td><td> </td><td class="right">   cipher_suite selected by the server and revealed in the ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message.  The random values are exchanged in the hello messages.  All</td><td> </td><td class="right">   message.  The random values are exchanged in the hello messages.  All</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that remains is to calculate the master secret.</td><td> </td><td class="right">   that remains is to calculate the master secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> page 66, line 22</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> page 63, line 24</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          UpdateType msg_type;       /* update type */</td><td> </td><td class="right">          UpdateType msg_type;       /* update type */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          uint24 length;             /* bytes in message */</td><td> </td><td class="right">          uint24 length;             /* bytes in message */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          switch (msg_type) {</td><td> </td><td class="right">          switch (msg_type) {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            case ack:</td><td> </td><td class="right">            case ack:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              UpdateAck ack;</td><td> </td><td class="right">              UpdateAck ack;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            case rekey:</td><td> </td><td class="right">            case rekey:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              UpdateRekey rekey;</td><td> </td><td class="right">              UpdateRekey rekey;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">            <span class="insert">case authentication:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              UpdateAuthentication authentication;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            /* This structure may be extended */</td><td> </td><td class="right">            /* This structure may be extended */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          }</td><td> </td><td class="right">          }</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       } Update;</td><td> </td><td class="right">       } Update;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Whenever a site sends an Update message, it updates its own master</td><td> </td><td class="right">   Whenever a site sends an Update message, it updates its own master</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   secret as follows:</td><td> </td><td class="right">   secret as follows:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">  X_master_secret_{i+1} = PRF(X_master_secret_i, "master_secret_update",</td><td> </td><td class="right">  X_master_secret_{i+1} = PRF(X_master_secret_i, "master_secret_update",</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                              Update_message)</td><td> </td><td class="right">                              Update_message)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> page 68, line 5</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> page 65, line 8</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Providing protection for already sent traffic against system</td><td> </td><td class="right">   -  Providing protection for already sent traffic against system</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      compromise.  Because master_secret_X_{i+1} is generated from</td><td> </td><td class="right">      compromise.  Because master_secret_X_{i+1} is generated from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      master_secret_X_i by a one-way function, once an Update has</td><td> </td><td class="right">      master_secret_X_i by a one-way function, once an Update has</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      occurred and the old master secret has been destroyed, compromise</td><td> </td><td class="right">      occurred and the old master secret has been destroyed, compromise</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      of the endpoint does not threaten old traffic.</td><td> </td><td class="right">      of the endpoint does not threaten old traffic.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   An implementation MAY send an UpdateRekey at any time after the</td><td> </td><td class="right">   An implementation MAY send an UpdateRekey at any time after the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake completes.</td><td> </td><td class="right">   handshake completes.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">8.2.4.  Authenticate</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   An Update message of type "authenticate" is used to bind a new</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   identity based on a certificate to the connection.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Structure of this message:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      struct {</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          Certificate certificate;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">          CertificateVerify certificate_verify;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      } UpdateAuthenticate;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   certificate</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      A Certificate structure as defined in Section 7.3.5.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   certificate_verify</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      A CertificateVerify structure as defined in Section 7.3.7.  In</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      this case the handshake_messages field consists of all the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      handshake messages sent (including the Finished messages) plus all</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      Update messages sent by the endpoint sending the Update message</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (including ACKs) but not Update messages sent by the other side.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Because the acknowlegement of the UpdateAuthenticate message includes</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   a digest of that message, the endpoint authentication becomes</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   integrated into both side's traffic keys.  This is important for</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   reasons documented in [I-D.ietf-tls-session-hash].</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   UpdateCertificate MUST only be sent by clients and only under the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   conditions described in Section 8.2.4.1 and clients MUST not send</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   UpdateCertificate more than once.  It is a fatal unexpected_message</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   error for an agent to send this message at an inappropriate time.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Future specifications may relax this requirement, which was added for</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   simplicity of analysis rather than for technical reasons around the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   handshake.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">8.2.4.1.  Client Certificate</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This message is only sent if the server requests a certificate.  If</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   no suitable certificate is available, the client MUST send a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   certificate message containing no certificates.  That is, the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   certificate_list structure has a length of zero.  If the client does</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   not send any certificates, the server MAY at its discretion either</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   continue the handshake without client authentication, or respond with</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   a fatal handshake_failure alert.  Also, if some aspect of the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   certificate chain was unacceptable (e.g., it was not signed by a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   known, trusted CA), the server MAY at its discretion either continue</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the handshake (considering the client unauthenticated) or send a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   fatal alert.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The client's certificate MUST be selected as described below:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   -  The certificate type MUST be X.509v3, unless explicitly negotiated</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      otherwise (e.g., [RFC5081]).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   -  The end-entity certificate's public key (and associated</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      restrictions) has to be compatible with the certificate types</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      listed in CertificateRequest:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    Client Cert. Type   Certificate Key Type</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    rsa_sign            RSA public key; the certificate MUST allow the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                        key to be used for signing with the signature</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                        scheme and hash algorithm that will be</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                        employed in the certificate verify message.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    dss_sign            DSA public key; the certificate MUST allow the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                        key to be used for signing with the hash</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                        algorithm that will be employed in the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                        certificate verify message.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">    ecdsa_sign          ECDSA-capable public key; the certificate MUST</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                        allow the key to be used for signing with the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                        hash algorithm that will be employed in the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                        certificate verify message; the public key</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                        MUST use a curve and point format supported by</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                        the server.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   -  If the certificate_authorities list in the certificate request</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      message was non-empty, one of the certificates in the certificate</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      chain SHOULD be issued by one of the listed CAs.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   -  The certificates MUST be signed using an acceptable hash/</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      signature algorithm pair, as described in Section 7.3.6.  Note</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      that this relaxes the constraints on certificate-signing</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      algorithms found in prior versions of TLS.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Note that, as with the server certificate, there are certificates</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that use algorithms/algorithm combinations that cannot be currently</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   used with TLS.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">9.  Mandatory Cipher Suites</td><td> </td><td class="right">9.  Mandatory Cipher Suites</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In the absence of an application profile standard specifying</td><td> </td><td class="right">   In the absence of an application profile standard specifying</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   otherwise, a TLS-compliant application MUST implement the cipher</td><td> </td><td class="right">   otherwise, a TLS-compliant application MUST implement the cipher</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   suite TODO:Needs to be selected [1].  (See Appendix A.5 for the</td><td> </td><td class="right">   suite TODO:Needs to be selected [1].  (See Appendix A.5 for the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   definition).</td><td> </td><td class="right">   definition).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">10.  Application Data Protocol</td><td> </td><td class="right">10.  Application Data Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Application data messages are carried by the record layer and are</td><td> </td><td class="right">   Application data messages are carried by the record layer and are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> page 82, line 51</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> page 81, line 51</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   RFC 4492 do not need to read this section.</td><td> </td><td class="right">   RFC 4492 do not need to read this section.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document adds a "signature_algorithm" field to the digitally-</td><td> </td><td class="right">   This document adds a "signature_algorithm" field to the digitally-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   signed element in order to identify the signature and digest</td><td> </td><td class="right">   signed element in order to identify the signature and digest</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   algorithms used to create a signature.  This change applies to</td><td> </td><td class="right">   algorithms used to create a signature.  This change applies to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   digital signatures formed using ECDSA as well, thus allowing ECDSA</td><td> </td><td class="right">   digital signatures formed using ECDSA as well, thus allowing ECDSA</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   signatures to be used with digest algorithms other than SHA-1,</td><td> </td><td class="right">   signatures to be used with digest algorithms other than SHA-1,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provided such use is compatible with the certificate and any</td><td> </td><td class="right">   provided such use is compatible with the certificate and any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   restrictions imposed by future revisions of [RFC3280].</td><td> </td><td class="right">   restrictions imposed by future revisions of [RFC3280].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   As described in Section 7.3.5 and Section <span class="delete">7.3.9,</span> the restrictions on</td><td> </td><td class="rblock">   As described in Section 7.3.5 and Section <span class="insert">8.2.4.1,</span> the restrictions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the signature algorithms used to sign certificates are no longer tied</td><td> </td><td class="rblock">   on the signature algorithms used to sign certificates are no longer</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   to the cipher suite (when used by the server) or the</td><td> </td><td class="rblock">   tied to the cipher suite (when used by the server) or the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientCertificateType (when used by the client).  Thus, the</td><td> </td><td class="right">   ClientCertificateType (when used by the client).  Thus, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   restrictions on the algorithm used to sign certificates specified in</td><td> </td><td class="right">   restrictions on the algorithm used to sign certificates specified in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Sections 2 and 3 of RFC 4492 are also relaxed.  As in this document,</td><td> </td><td class="right">   Sections 2 and 3 of RFC 4492 are also relaxed.  As in this document,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the restrictions on the keys in the end-entity certificate remain.</td><td> </td><td class="right">   the restrictions on the keys in the end-entity certificate remain.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Appendix B.  Glossary</td><td> </td><td class="right">Appendix B.  Glossary</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Advanced Encryption Standard (AES)</td><td> </td><td class="right">   Advanced Encryption Standard (AES)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      AES [AES] is a widely used symmetric encryption algorithm.  AES is</td><td> </td><td class="right">      AES [AES] is a widely used symmetric encryption algorithm.  AES is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      a block cipher with a 128-, 192-, or 256-bit keys and a 16-byte</td><td> </td><td class="right">      a block cipher with a 128-, 192-, or 256-bit keys and a 16-byte</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> page 88, line 18</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> page 87, line 18</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Do you handle TLS extensions in ClientHello correctly, including</td><td> </td><td class="right">   -  Do you handle TLS extensions in ClientHello correctly, including</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      omitting the extensions field completely?</td><td> </td><td class="right">      omitting the extensions field completely?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  Do you support renegotiation, both client and server initiated?</td><td> </td><td class="right">   -  Do you support renegotiation, both client and server initiated?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      While renegotiation is an optional feature, supporting it is</td><td> </td><td class="right">      While renegotiation is an optional feature, supporting it is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      highly recommended.</td><td> </td><td class="right">      highly recommended.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  When the server has requested a client certificate, but no</td><td> </td><td class="right">   -  When the server has requested a client certificate, but no</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      suitable certificate is available, do you correctly send an empty</td><td> </td><td class="right">      suitable certificate is available, do you correctly send an empty</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Certificate message, instead of omitting the whole message (see</td><td> </td><td class="right">      Certificate message, instead of omitting the whole message (see</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      Section <span class="delete">7.3.9</span>)?</td><td> </td><td class="rblock">      Section <span class="insert">8.2.4.1</span>)?</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Cryptographic details:</td><td> </td><td class="right">   Cryptographic details:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  What countermeasures do you use to prevent timing attacks against</td><td> </td><td class="right">   -  What countermeasures do you use to prevent timing attacks against</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      RSA signing operations [TIMING].</td><td> </td><td class="right">      RSA signing operations [TIMING].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   -  When verifying RSA signatures, do you accept both NULL and missing</td><td> </td><td class="right">   -  When verifying RSA signatures, do you accept both NULL and missing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      parameters (see Section 4.7)?  Do you verify that the RSA padding</td><td> </td><td class="right">      parameters (see Section 4.7)?  Do you verify that the RSA padding</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      doesn't have additional data after the hash value?  [FI06]</td><td> </td><td class="right">      doesn't have additional data after the hash value?  [FI06]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 10 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>182 lines changed or deleted</i></th><th><i> </i></th><th><i>155 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.34. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
